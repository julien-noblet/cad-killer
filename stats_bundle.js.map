{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/events/events.js","webpack:///./node_modules/inherits/inherits_browser.js","webpack:///./node_modules/immediate/lib/index.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/argsarray/index.js","webpack:///./node_modules/spark-md5/spark-md5.js","webpack:///./node_modules/vuvuzela/index.js","webpack:///./node_modules/pouchdb/node_modules/uuid/dist/esm-browser/rng.js","webpack:///./node_modules/pouchdb/node_modules/uuid/dist/esm-browser/bytesToUuid.js","webpack:///./node_modules/pouchdb/node_modules/uuid/dist/esm-browser/v4.js","webpack:///./node_modules/process/browser.js","webpack:///./node_modules/pouchdb/lib/index-browser.es.js","webpack:///./node_modules/immediate/lib/queueMicrotask.js","webpack:///./node_modules/immediate/lib/mutation.js","webpack:///./node_modules/immediate/lib/messageChannel.js","webpack:///./node_modules/immediate/lib/stateChange.js","webpack:///./node_modules/immediate/lib/timeout.js","webpack:///./node_modules/ua-parser-js/src/ua-parser.js","webpack:///./node_modules/leaflet-dialog/Leaflet.Dialog.js","webpack:///./node_modules/leaflet-draw/dist/leaflet.draw.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","ReflectOwnKeys","R","Reflect","ReflectApply","apply","target","receiver","args","Function","ownKeys","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","Number","isNaN","EventEmitter","init","this","once","emitter","Promise","resolve","reject","eventListener","undefined","errorListener","removeListener","slice","arguments","err","_events","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","TypeError","_getMaxListeners","that","_addListener","type","prepend","events","existing","warning","newListener","emit","unshift","push","length","warned","w","Error","String","count","console","warn","onceWrapper","fired","wrapFn","_onceWrap","state","wrapped","_listeners","unwrap","evlistener","arr","ret","Array","unwrapListeners","arrayClone","listenerCount","copy","set","arg","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","error","er","message","context","handler","len","listeners","addListener","on","prependListener","prependOnceListener","list","position","originalListener","shift","index","pop","spliceOne","off","removeAllListeners","keys","rawListeners","eventNames","ctor","superCtor","super_","constructor","writable","configurable","TempCtor","draining","currentQueue","scheduleDrain","types","queueIndex","queue","scheduled","cleanUpNextTick","nextTick","timeout","setTimeout","run","clearTimeout","test","install","Item","fun","array","task","g","e","window","hex_chr","md5cycle","x","k","a","b","md5blk","md5blks","charCodeAt","md5blk_array","md51","tail","tmp","lo","hi","substring","toString","match","parseInt","rhex","j","hex","join","toUtf8","str","unescape","encodeURIComponent","hexToBinaryString","bytes","substr","fromCharCode","SparkMD5","reset","ArrayBuffer","clamp","val","Math","max","min","from","to","num","targetArray","sourceArray","byteLength","begin","end","Uint8Array","append","appendBinary","contents","_buff","_length","_hash","raw","buff","_finish","getState","hash","setState","destroy","hashBinary","content","first","second","returnUInt8Array","result","buffer","subarray","utf8Str2ArrayBuffer","md51_array","factory","obj","stack","metaStack","lastMetaElement","element","lastElementIndex","isArray","stringify","input","next","arrayPrefix","objPrefix","res","prefix","JSON","parse","collationIndex","parsedNum","numChar","parsedString","lastCh","numConsecutiveSlashes","ch","arrayElement","objElement","parseFloat","getRandomValues","crypto","msCrypto","rnds8","rng","byteToHex","buf","offset","bth","toLowerCase","options","rnds","random","start","cachedSetTimeout","cachedClearTimeout","process","defaultSetTimout","defaultClearTimeout","runTimeout","drainQueue","marker","runClearTimeout","noop","title","browser","env","argv","version","versions","binding","cwd","chdir","dir","umask","ExportedSet","ExportedMap","mangle","unmangle","Map$1","_store","Set$1","add","cloneBinaryObject","cloneArrayBuffer","size","webkitSlice","mangled","has","delete","forEach","cb","Map","Set","prop","getOwnPropertyDescriptor","species","supportsMapAndSet","funcToString","objectCtorString","clone","newObject","Date","toISOString","Blob","isBinaryObject","proto","Ctor","isPlainObject","called","toPromise","func","self","usedCB","promise","fulfill","resp","callback","mesg","then","adapterFun","_closed","_destroyed","logArgs","origCallback","responseArgs","logApiCall","taskqueue","isReady","addTask","failed","pick","hasLocal","identityFunction","formatResultForOpenRevsGet","ok","bulkGet","db","opts","requests","docs","requestsById","request","id","numDocs","numDone","perDocResults","checkDone","results","info","allRequests","nextBatch","upTo","batch","docId","docIdx","docRequests","docOpts","open_revs","map","rev","filter","formatResult","param","processBatch","localStorage","setItem","getItem","hasLocalStorage","Changes","addEventListener","attachBrowserEvents","guardedConsole","method","defaultBackOff","maxTimeout","randomNumber","explainError","status","dbName","inprogress","eventFunction","changesOpts","changes","seq","since","cancelled","onChange","notifyLocalWindows","notify","$inject_Object_assign","assign","nextSource","nextKey","PouchError","reason","MISSING_BULK_DOCS","MISSING_DOC","REV_CONFLICT","INVALID_ID","MISSING_ID","RESERVED_ID","UNKNOWN_ERROR","BAD_ARG","QUERY_PARSE_ERROR","DOC_VALIDATION","BAD_REQUEST","NOT_AN_OBJECT","IDB_ERROR","INVALID_REV","MISSING_STUB","createError","CustomPouchError","names","generateErrorFromResponse","data","filterChange","req","hasFilter","query","query_params","change","doc","filterReturn","msg","tryFilter","include_docs","attachments","att","_attachments","stub","flatten","arrs","invalidIdError","isRemote","_remote","parseDesignDocFunctionName","parts","split","normalizeDesignDocFunctionName","normalized","qParser","parser","parseUri","exec","uri","encoded","indexOf","decodeURIComponent","replace","$0","$1","$2","scopeEval","source","scope","values","upsert","diffFun","docRev","_rev","newDoc","updated","_id","put","tryAndPut","thisAtob","atob","thisBtoa","btoa","createBlob","properties","builder","BlobBuilder","MSBlobBuilder","MozBlobBuilder","WebKitBlobBuilder","getBlob","binaryStringToArrayBuffer","bin","binStringToBluffer","binString","b64ToBluffer","b64","readAsBinaryString","blob","reader","FileReader","hasBinaryString","onloadend","binary","arrayBufferToBinaryString","readAsArrayBuffer","blobToBinaryString","blobOrBuffer","blobToBase64","base64","setImmediateShim","setImmediate","appendBlob","sliceBlob","arrayBuffer","appendString","string","binaryMd5","inputIsString","chunkSize","chunks","ceil","currentChunk","loadNextChunk","done","rawToBase64","stringMd5","deterministic_revs","clonedDoc","_rev_tree","uuid","winningRev","metadata","winningId","winningPos","winningDeleted","node","toVisit","rev_tree","tree","ids","branches","pos","deleted","traverseRevTree","revs","newCtx","ctx","sortByPos","collectLeaves","leaves","isLeaf","acc","sort","reverse","collectConflicts","win","conflicts","leaf","rootToLeaf","paths","history","sortByPos$1","insertSorted","item","comparator","idx","mid","low","high","binarySearch","splice","pathToTree","path","numStemmed","root","currentLeaf","compareTree","mergeTree","in_tree1","in_tree2","tree1","tree2","merged","doMerge","dontExpand","restree","branch","t1","t2","diff","candidateParents","trees","parent","parentIdx","elements","elementsLen","el","merge","depth","newTree","stemmed","stemmedRevs","revHash","stem","getTrees","isDeleted","isLocalId","Changes$1","complete","ee","onDestroy","cancel","pending","lastSeq","isCancelled","tryCatchInChangeListener","validateChanges","processChange","changeList","style","_conflicts","compare","left","right","yankError","compareByIdThenRev","idCompare","_revisions","AbstractPouchDB","TaskQueue","PouchDB","__opts","auto_compaction","backend","adapter","adapters","preferredAdapters","adapterName","use_prefix","parseAdapter","_adapter","valid","fail","onDestroyed","from_constructor","onClosed","prepareForDestruction","ready","_changesFilterPlugin","validate","doChanges","continuous","live","normalize","shouldFilter","descending","limit","newPromise","_changes","update_seq","post","bulkDocs","_putLocal","_deleted","_removeLocal","oldRevId","newRevNum","newRevId","putDoc","_put","new_edits","force","putAttachment","attachmentId","rev$$1","api","createAttachment","prevrevpos","content_type","revpos","removeAttachment","remove","docOrId","optsOrRev","was_delete","revsDiff","missing","addToMissing","revId","_getRevisionTree","missingForId","processDoc","missingObj","compactDocument","maxHeight","revTree","height","edges","prnt","edge","computeHeight","candidates","_doCompaction","compact","_compactionQueue","doNextCompaction","catch","last_seq","_compact","return_docs","promises","row","all","_getLocal","finishOpenRevs","latest","_get","revs_info","splittedRev","revNo","currentPath","hashIndex","indexOfRev","howMany","_revs_info","_getAttachment","getAttachment","allDocs","skip","start_key","startkey","end_key","endkey","incompatibleOpt","allDocsKeysParse","_allDocs","close","_close","_info","db_name","_type","attachmentError","charAt","attachmentNameError","atts","cleanDocs","_bulkDocs","registerDependentDatabase","dependentDb","depDB","dependentDbs","usePrefix","destroyDb","_destroy","localDoc","deletedMap","trueName","RegExp","execute","AbortController","abort","f$1","fetch","h","Headers","eventEmitter","Pouch","destructListeners","_destructionListeners","dbList","setUpEventEmitter","addToPreferredAdapters","plugin","__defaults","defaults","defaultOpts","PouchAlt","url","getFieldFromDoc","parsedField","parseField","fieldName","fields","current","combinationFields","isCombinationalField","field","getKey","mergeAndedSelectors","selectors","selector","matcher","$eq","fieldMatchers","operator","$gte","$gt","mergeGtGte","$lte","$lt","mergeLtLte","$ne","mergeNe","mergeEq","massageSelector","wasAnded","isAndInSelector","isAnd","mergeAndedSelectorsNested","orOrNor","subSelector","collate","normalizeKey","ai","bi","stringCollate","arrayCollate","ak","bk","objectCollate","Infinity","origKey","toJSON","indexify","expFormat","toExponential","magnitude","neg","magString","padWith","upToLength","padding","targetLength","pad","factor","abs","factorStr","toFixed","numToIndexableString","toIndexableString","objKey","parseNumber","originalIdx","numAsString","magAsString","filterInMemoryFields","rows","requestDef","inMemoryFields","rowFilter","fieldSorter","getFieldValuesAsArray","sorting","aRow","bRow","collation","createFieldSorter","every","docFieldValue","some","orMatchers","find","matchCominationalSelector","matchSelector","userOperator","userValue","matchers","fieldExists","fieldIsNotUndefined","arrayContainsValue","divisor","mod","modField","neValue","arraySize","arrayContainsAllValues","regexMatch","typeMatch","filterName","view","changesHandler","doc_ids","viewName","ddoc","mapFun","views","rowsMatched","matchesSelector","filterFun","filters","toObject","reduce","reservedWords","dataWords","parseRevisionInfo","parseDoc","newEdits","dbOpts","nRevNum","revInfo","revisions","revisionIds","makeRevTreeFromRevisions","specialKey","preprocessString","blobType","asBinary","parseBase64","digest","preprocessAttachment","md5","preprocessBlob","updateDoc","revLimit","prev","docInfo","writeDoc","splitRev","targetPos","targetId","revExists","previousWinningRev","previouslyDeleted","isRoot","newRev","rev_map","winningRev$$1","winningRevIsDeleted","delta","processDocs","docInfos","fetchedDocs","tx","overallCallback","idsToDocs","docsDone","docsToDo","checkAllDocsDone","currentDoc","resultsIdx","docWritten","nextDoc","rootIsMissing","insertDoc","DOC_STORE","META_STORE","safeJsonStringify","json","idbError","evt","encodeMetadata","deletedOrLocal","decodeMetadata","storedObject","safeJsonParse","decodeDoc","_doc_id_rev","lastIndexOf","readBlobData","body","asBlob","fetchAttachmentsIfNecessary","txn","attObj","objectStore","onsuccess","fetchAttachment","postProcessAttachments","attNames","compactRevs","possiblyOrphanedDigests","seqStore","attStore","attAndSeqStore","IDBKeyRange","bound","deleteOrphanedAttachments","openCursor","only","event","cursor","digestSeq","primaryKey","continue","openTransactionSafely","idb","stores","transaction","idbBulkDocs","docStore","bySeqStore","attachStore","attachAndSeqStore","metaStore","docInfoError","metaDoc","allDocsProcessed","docCountDelta","preconditionErrored","_meta","blobSupport","onAllDocsProcessed","updateDocCountIfReady","docCount","newRevIsDeleted","isUpdate","collectResults","finishDoc","attachmentSaved","newAtt","saveAttachment","writeAttachments","afterPutDoc","revsToDelete","compactTree","metadataToStore","afterPutMetadata","attsAdded","attsToAdd","onerror","preventDefault","stopPropagation","insertAttachmentMappings","putReq","overallErr","docv","recv","processedAttachment","preprocessAttachments","txnResult","onabort","ontimeout","oncomplete","finish","digests","filename","verifyAttachment","attErr","verifyAttachments","numFetched","revs_limit","readMetadata","fetchExistingDocs","startTransaction","runBatchedCursor","keyRange","batchSize","onBatch","keysBatch","valuesBatch","pseudoCursor","onGetAll","onGetAllKeys","onCursor","getAll","getAllKeys","newKeyRange","lastKey","upper","upperOpen","code","lowerBound","idbAllDocs","keyRangeError","inclusiveEnd","inclusive_end","upperBound","createKeyRange","onResultsReady","updateSeq","onSuccess","docIdRevIndex","allDocsInner","fetchDocAsynchronously","batchValues","batchValue","batchKeys","returnVal","total_rows","maxKey","allDocsKeys","running","applyNext","docIds","numResults","docIdsToMetadata","onGetMetadata","docIdRev","objectStores","winningDocs","metadatas","fetchWinningDocAndMetadata","winningDoc","processMetadataAndWinningDoc","onBatchDone","filtered","blobSupportPromise","cachedDBs","openReqList","IdbPouch","action","tryCode","enqueueTask","thisCallback","addDeletedOrLocalIndex","createIndex","unique","migrateLocalStore","localStore","local","range","seqCursor","migrateAttsAndSeqs","digestMap","migrateMetadata","onGetMetadataSeq","metadataSeq","fetchMetadataSeq","instanceId","reqOpts","historyNode","attachId","attachment","blobData","doc_count","idb_attachment_format","oldRev","oStore","oldDoc","openReq","indexedDB","deleteDatabase","cached","global","open","onupgradeneeded","oldVersion","createObjectStore","keyPath","autoIncrement","createSchema","currentTarget","createLocalStoreSchema","addAttachAndSeqStore","migrations","migration","onversionchange","storedMetaDoc","completeSetup","storeMetaDocIfReady","instanceKey","countDocs","blob$$1","matchedChrome","navigator","userAgent","matchedEdge","checkBlobSupport","supportsBulkGetMap","readAttachmentsAsBlobOrBuffer","encodeDocId","preprocessAttachments$1","getHost","protocol","hasUrlPrefix","user","password","auth","username","genDBUrl","genUrl","pathDel","host","port","paramsToStr","params","HttpPouch","dbUrl","setupPromise","ourFetch","headers","credentials","nAuth","token","ua","isIE","isTrident","isEdge","isGET","shouldCacheBust","now","adapterFun$$1","setup","fetchJSON","response","v","skip_setup","encodeAttachmentId","uuid$$1","ping","compact_running","interval","doBulkGet","doBulkGetShim","numBatches","onResult","batchNum","subOpts","supportsBulkGet","fetchAttachments","filenames","promiseFactories","doNext","runNextBatch","onError","thisErr","pool","typeFieldDescriptor","__proto__","fetchData","docOrDocs","contentType","paramStr","batch_size","heartbeat","requestTimeout","leftToFetch","feed","seq_interval","param_name","lastFetchedSeq","controller","aborted","fetchOpts","signal","fetched","raw_results_length","finished","QueryParseError","captureStackTrace","NotFoundError","BuiltInError","promisedCallback","sequentialize","promiseFactory","uniq","theSet","mapToKeysArray","createBuiltInError","sum","jLen","jNum","log","evalFunctionWithEval","TaskQueue$1","createView","sourceDB","reduceFun","temporary","localDocName","cachedViews","viewSignature","createViewSignature","_cachedViews","promiseForView","depDbName","fullViewName","depDbs","lastSeqDoc","persistentQueues","tempViewQueue","parseViewName","emitError","builtInReduce","sumsqr","_sumsqr","abstract","mapper","reducer","ddocValidator","tryMap","tryReduce","rereduce","output","sortByKeyThenValue","y","keyCompare","sliceResults","rowToDocId","postprocessAttachments","addHttpParam","paramName","asJson","coerceInteger","integerCandidate","asNumber","checkQueryParseError","startkeyName","endkeyName","group","group_level","optionName","number","checkPositiveInteger","defaultsTo","getDocsToPersist","docIdsToChangesAndEmits","metaDocId","defaultMetaDoc","docData","indexableKeysToKeyValues","isGenOne","getKeyValueDocs","kvDocsRes","kvDocs","oldKeys","keyValue","newKeys","kvDoc","processKeyValueDocs","getQueue","updateView","mapResults","currentSeq","listOfDocsToPersist","docsToPersist","saveKeyValues","processNextBatch","createIndexableKeysToKeyValues","createDocIdsToChangesAndEmits","emittedKeyValue","complexKey","updateViewInQueue","queryView","totalRows","shouldReduce","fetchFromView","viewOpts","expectedKeys","parsedKeyAndDocId","parsedStr","parseIndexableString","onMapResultsReady","finalResults","shouldGroup","groups","lvl","POSITIVE_INFINITY","last","groupKey","reduceTry","reduceView","allDocsRes","docIdsToDocs","fetchPromises","keyStart","keyEnd","queryViewInQueue","queryPromised","_query","customQuery","keysAsString","httpQuery","finalPromiseFactory","designDocName","stale","coerceOptions","viewCleanup","_viewCleanup","customViewCleanup","httpViewCleanup","docsToViews","viewsToStatus","ddocName","viewDBNames","statusIsGood","viewDBName","destroyPromises","localViewCleanup","createAbstractMapReduce","origMap","reduceFunString","builtIn","getBuiltIn","mapreduce","isGenOne$1","getDocAttachments","getDocs","src","diffs","resultDocs","fetchRevisionOneDocs","hasConflicts","bulkGetOpts","missingRev","createBulkGetOpts","bulkGetResponse","bulkGetInfo","remoteDoc","doCheckForLocalAttachments","fileHasChanged","getDocAttachmentsFromTargetOrSource","Boolean","updateCheckpoint","checkpoint","session","returnValue","session_id","replicator","Checkpointer","writeCheckpoint","updateTarget","updateSource","writeTargetCheckpoint","writeSourceCheckpoint","isForbiddenError","comparisons","targetDoc","sourceDoc","srcDoc","tgtDoc","compareReplicationHistory","sourceHistory","targetHistory","S","sourceRest","T","targetRest","hasSessionId","compareReplicationLogs","sessionId","props","rest","floor","getCheckpoint","generateReplicationId","queryParams","filterViewName","sortObjectPropertiesByKey","queryData","md5sum","replicate","currentBatch","repId","checkpointer","batches","pendingBatch","writingCheckpoint","changesCompleted","replicationCompleted","batches_limit","changesPending","changedDocs","start_time","docs_read","docs_written","doc_write_failures","errors","initCheckpointer","checkpointOpts","writeDocs","bulkOpts","completeReplication","errorsById","errorsNo","errorName","finishBatch","outResult","getChanges","onCheckpointError","getBatchDocs","got","startNextBatch","abortReplication","processPendingBatch","immediate$$1","fatalError","end_time","retry","back_off_function","backOffSet","current_back_off","backOff","onChangesComplete","onChangesError","_abortChanges","abortChanges","startChanges","_addedListeners","Replication","toPouch","PouchConstructor","replicateWrapper","replicateRet","sync","Sync","canceled","optsPush","optsPull","pull","pullChange","direction","pushChange","pushDenied","pullDenied","pushPaused","pullPaused","pushActive","pullActive","removed","removeAll","addOneListener","out","success","_readyCalled","replicateMethods","other","queueMicrotask","Mutation","MutationObserver","WebKitMutationObserver","handle","observer","document","createTextNode","observe","characterData","MessageChannel","channel","port1","onmessage","port2","postMessage","createElement","scriptEl","onreadystatechange","parentNode","removeChild","documentElement","appendChild","MODEL","NAME","TYPE","VENDOR","VERSION","MOBILE","TABLET","SMARTTV","util","extend","regexes","extensions","mergedRegexes","str1","str2","lowerize","major","trim","rgx","arrays","q","matches","regex","maps","oldSafari","oldEdge","os","windows","cpu","device","engine","UAParser","getResult","_ua","_rgxmap","getBrowser","_browser","getCPU","_cpu","architecture","getDevice","_device","vendor","model","getEngine","_engine","getOS","_os","getUA","setUA","BROWSER","MAJOR","CPU","ARCHITECTURE","DEVICE","CONSOLE","WEARABLE","EMBEDDED","ENGINE","OS","$","jQuery","Zepto","uastring","L","Control","Dialog","minSize","maxSize","anchor","initOpen","initialize","setOptions","_attributions","onAdd","_initLayout","_map","update","_container","visibility","fire","onRemove","setLocation","location","_oldMousePos","_move","setSize","_resize","lock","_resizerNode","_grabberNode","_closeNode","unlock","freeze","unfreeze","hideClose","showClose","hideResize","showResize","setContent","_content","getContent","getElement","_updateContent","_updateLayout","className","container","DomUtil","width","top","stop","DomEvent","innerContainer","_innerContainer","grabberNode","grabberIcon","_handleMoveStart","closeNode","closeIcon","_handleClose","resizerNode","resizeIcon","_handleResizeStart","contentNode","_contentNode","clientX","clientY","_handleMouseMove","_handleMouseUp","_resizing","_moving","diffX","originalEvent","diffY","newY","newX","innerHTML","hasChildNodes","firstChild","control","dialog","drawVersion","Draw","drawLocal","draw","toolbar","actions","text","undo","buttons","polyline","polygon","rectangle","circle","circlemarker","handlers","tooltip","radius","cont","simpleshape","edit","save","clearAll","editDisabled","removeDisabled","subtext","Event","CREATED","EDITED","DELETED","DRAWSTART","DRAWSTOP","DRAWVERTEX","EDITSTART","EDITMOVE","EDITRESIZE","EDITVERTEX","EDITSTOP","DELETESTART","DELETESTOP","TOOLBAROPENED","TOOLBARCLOSED","MARKERCONTEXT","Feature","Handler","_overlayPane","_panes","overlayPane","_popupPane","popupPane","shapeOptions","Util","include","Evented","Mixin","Events","enable","_enabled","layerType","disable","addHooks","disableTextSelection","getContainer","focus","_tooltip","Tooltip","_cancelDrawing","removeHooks","enableTextSelection","dispose","_fireCreatedEvent","layer","keyCode","Polyline","statics","Poly","allowIntersection","repeatMode","drawError","color","icon","DivIcon","iconSize","Point","touchIcon","guidelineDistance","maxGuideLineLength","stroke","weight","opacity","fill","clickable","metric","feet","nautic","showLength","zIndexOffset","maxPoints","Browser","touch","_markers","_markerGroup","LayerGroup","addLayer","_poly","updateContent","_getTooltipText","_mouseMarker","getCenter","divIcon","iconAnchor","_onMouseOut","_onMouseMove","_onMouseDown","_onMouseUp","addTo","_onZoomEnd","_onTouch","_clearHideErrorTimeout","_cleanUpShape","removeLayer","_clearGuides","deleteLastVertex","getLatLngs","setLatLngs","_vertexChanged","addVertex","newLatLngIntersects","_showErrorTooltip","_errorShown","_hideErrorTooltip","_createMarker","addLatLng","completeShape","_shapeIsValid","_finishShape","_defaultShape","_updateGuide","mouseEventToLayerPoint","layerPointToLatLng","_currentLatLng","_updateTooltip","setLatLng","layers","_updateFinishHandler","_updateRunningMeasure","_clickHandled","_touchHandled","_disableMarkers","_disableNewMarkers","_startPoint","_mouseDownOrigin","point","_endPoint","distanceTo","_calculateFinishDistance","latlng","devicePixelRatio","_enableNewMarkers","touches","Polygon","latLngToContainerPoint","getLatLng","Marker","latLngToLayerPoint","_drawGuide","updatePosition","sqrt","pow","_guidesContainer","backgroundColor","setPosition","_updateGuideColor","childNodes","_getMeasurementString","_measurementRunningTotal","GeometryUtil","isVersion07x","distance","readableDistance","precision","showAsError","setStyle","_hideErrorTimeout","removeError","showArea","fillColor","fillOpacity","_area","readableArea","geodesicArea","SimpleShape","_endLabelText","_mapDraggable","dragging","enabled","_initialLabelText","passive","removeEventListener","_shape","_isDrawing","_startLatLng","_drawShape","Rectangle","_isCurrentlyTwoClickDrawing","parentElement","classList","contains","setBounds","LatLngBounds","getBounds","Icon","Default","_onClick","_marker","Touch","CircleMarker","Circle","showRadius","setRadius","getRadius","Edit","_onDragEnd","_toggleMarkerHighlight","edited","_icon","display","hasClass","removeClass","_offsetMarker","addClass","marginTop","marginLeft","addInitHook","editing","editable","latlngs","_latlngs","_holes","_updateLatLngs","_flat","_eachVertexHandler","_verticesHandlers","_initHandlers","updateMarkers","PolyVerticesEdit","poly","_path","original","_initMarkers","clearLayers","_onMarkerClick","_onContextMenu","_createMiddleMarker","_updatePrevNext","draggable","_origLatLng","_index","_onMarkerDragStart","_onMarkerDrag","_fireEdit","_onTouchMove","_spliceLatLngs","_convertLatLngs","redraw","_removeMarker","_updateIndexes","LatLngUtil","cloneLatLng","_latlng","_editTooltip","intersects","_middleLeft","_getMiddleLatLng","_prev","_middleRight","_next","_bounds","_southWest","latLng","_northEast","eachLayer","setOpacity","lat","lng","project","unproject","_add","_divideBy","moveIcon","touchMoveIcon","touchResizeIcon","_unbindMarker","_moveMarker","_resizeMarkers","_createMoveMarker","_createResizeMarker","_bindMarker","_onMarkerDragEnd","_onTouchStart","_onTouchEnd","_getCorners","_cornerIndex","_oppositeCorner","_toggleCornerMarkers","_repositionCornerMarkers","latLngBounds","getNorthWest","getNorthEast","getSouthEast","getSouthWest","_getResizeMarkerPoint","_radius","cos","PI","editTooltip","mergeOptions","touchExtend","TouchExtend","_pane","_detectIE","_onTouchCancel","_onTouchLeave","_touchEvent","pointerType","_filterClick","mouseEventToContainerPoint","layerPoint","containerPoint","pageX","pageY","timeStamp","_lastClick","_simulatedClick","_simulated","_loaded","_initInteraction","addInteractiveTarget","_initInteractionLegacy","_onMouseClick","_onKeyPress","_fireMouseEvent","MarkerDrag","cloneLatLngs","km","ha","mi","ac","yd","ft","nm","sin","formattedNumber","format","numeric","delimiters","thousands","decimal","LineUtil","segmentsIntersect","_checkCounterclockwise","_getProjectedPoints","_tooFewPointsForIntersection","_lineSegmentsIntersectsRange","newPointIntersects","_originalPoints","_toolbars","DrawToolbar","_toolbarEnabled","EditToolbar","addToolbar","removeToolbar","setDrawingOptions","drawControlTooltips","drawControl","addControl","Toolbar","Class","_modes","_actionButtons","_activeMode","_toolbarClass","getModeHandlers","_toolbarContainer","_initModeHandler","_lastButtonIndex","_actionsContainer","_disposeButton","button","_handlerActivated","_handlerDeactivated","_createButton","buttonIndex","_detectIOS","MSStream","href","_showActionsToolbar","_hideActionsToolbar","_createActions","getActions","offsetTop","_visible","_singleLineLabel","selectedPathOptions","dashArray","maintainColor","featureGroup","_selectedFeatureCount","Delete","_save","removeAllLayers","_clearAllLayers","_checkDisabled","revertLayers","getLayers","setAttribute","_featureGroup","FeatureGroup","_uneditedLayerProps","_hasAvailableLayers","_enableLayerEdit","_disableLayerEdit","_revertLayer","_backupLayer","stamp","_selectedPathOptions","previousOptions","changedTouches","_deletableLayers","_enableLayerDelete","_disableLayerDelete","_deletedLayers","_removeLayer"],"mappings":"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","file":"stats_bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 24);\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function eventListener() {\n      if (errorListener !== undefined) {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n    var errorListener;\n\n    // Adding an error listener is not optional because\n    // if an error is thrown on an event emitter we cannot\n    // guarantee that the actual event we are waiting will\n    // be fired. The result could be a silent way to create\n    // memory or file descriptor leaks, which is something\n    // we should avoid.\n    if (name !== 'error') {\n      errorListener = function errorListener(err) {\n        emitter.removeListener(name, eventListener);\n        reject(err);\n      };\n\n      emitter.once('error', errorListener);\n    }\n\n    emitter.once(name, eventListener);\n  });\n}\n","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor\n      ctor.prototype = Object.create(superCtor.prototype, {\n        constructor: {\n          value: ctor,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      })\n    }\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor\n      var TempCtor = function () {}\n      TempCtor.prototype = superCtor.prototype\n      ctor.prototype = new TempCtor()\n      ctor.prototype.constructor = ctor\n    }\n  }\n}\n","'use strict';\nvar types = [\n  require('./nextTick'),\n  require('./queueMicrotask'),\n  require('./mutation.js'),\n  require('./messageChannel'),\n  require('./stateChange'),\n  require('./timeout')\n];\nvar draining;\nvar currentQueue;\nvar queueIndex = -1;\nvar queue = [];\nvar scheduled = false;\nfunction cleanUpNextTick() {\n  if (!draining || !currentQueue) {\n    return;\n  }\n  draining = false;\n  if (currentQueue.length) {\n    queue = currentQueue.concat(queue);\n  } else {\n    queueIndex = -1;\n  }\n  if (queue.length) {\n    nextTick();\n  }\n}\n\n//named nextTick for less confusing stack traces\nfunction nextTick() {\n  if (draining) {\n    return;\n  }\n  scheduled = false;\n  draining = true;\n  var len = queue.length;\n  var timeout = setTimeout(cleanUpNextTick);\n  while (len) {\n    currentQueue = queue;\n    queue = [];\n    while (currentQueue && ++queueIndex < len) {\n      currentQueue[queueIndex].run();\n    }\n    queueIndex = -1;\n    len = queue.length;\n  }\n  currentQueue = null;\n  queueIndex = -1;\n  draining = false;\n  clearTimeout(timeout);\n}\nvar scheduleDrain;\nvar i = -1;\nvar len = types.length;\nwhile (++i < len) {\n  if (types[i] && types[i].test && types[i].test()) {\n    scheduleDrain = types[i].install(nextTick);\n    break;\n  }\n}\n// v8 likes predictible objects\nfunction Item(fun, array) {\n  this.fun = fun;\n  this.array = array;\n}\nItem.prototype.run = function () {\n  var fun = this.fun;\n  var array = this.array;\n  switch (array.length) {\n  case 0:\n    return fun();\n  case 1:\n    return fun(array[0]);\n  case 2:\n    return fun(array[0], array[1]);\n  case 3:\n    return fun(array[0], array[1], array[2]);\n  default:\n    return fun.apply(null, array);\n  }\n\n};\nmodule.exports = immediate;\nfunction immediate(task) {\n  var args = new Array(arguments.length - 1);\n  if (arguments.length > 1) {\n    for (var i = 1; i < arguments.length; i++) {\n      args[i - 1] = arguments[i];\n    }\n  }\n  queue.push(new Item(task, args));\n  if (!scheduled && !draining) {\n    scheduled = true;\n    scheduleDrain();\n  }\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","'use strict';\n\nmodule.exports = argsArray;\n\nfunction argsArray(fun) {\n  return function () {\n    var len = arguments.length;\n    if (len) {\n      var args = [];\n      var i = -1;\n      while (++i < len) {\n        args[i] = arguments[i];\n      }\n      return fun.call(this, args);\n    } else {\n      return fun.call(this, []);\n    }\n  };\n}","(function (factory) {\n    if (typeof exports === 'object') {\n        // Node/CommonJS\n        module.exports = factory();\n    } else if (typeof define === 'function' && define.amd) {\n        // AMD\n        define(factory);\n    } else {\n        // Browser globals (with support for web workers)\n        var glob;\n\n        try {\n            glob = window;\n        } catch (e) {\n            glob = self;\n        }\n\n        glob.SparkMD5 = factory();\n    }\n}(function (undefined) {\n\n    'use strict';\n\n    /*\n     * Fastest md5 implementation around (JKM md5).\n     * Credits: Joseph Myers\n     *\n     * @see http://www.myersdaily.org/joseph/javascript/md5-text.html\n     * @see http://jsperf.com/md5-shootout/7\n     */\n\n    /* this function is much faster,\n      so if possible we use it. Some IEs\n      are the only ones I know of that\n      need the idiotic second function,\n      generated by an if clause.  */\n    var add32 = function (a, b) {\n        return (a + b) & 0xFFFFFFFF;\n    },\n        hex_chr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'];\n\n\n    function cmn(q, a, b, x, s, t) {\n        a = add32(add32(a, q), add32(x, t));\n        return add32((a << s) | (a >>> (32 - s)), b);\n    }\n\n    function md5cycle(x, k) {\n        var a = x[0],\n            b = x[1],\n            c = x[2],\n            d = x[3];\n\n        a += (b & c | ~b & d) + k[0] - 680876936 | 0;\n        a  = (a << 7 | a >>> 25) + b | 0;\n        d += (a & b | ~a & c) + k[1] - 389564586 | 0;\n        d  = (d << 12 | d >>> 20) + a | 0;\n        c += (d & a | ~d & b) + k[2] + 606105819 | 0;\n        c  = (c << 17 | c >>> 15) + d | 0;\n        b += (c & d | ~c & a) + k[3] - 1044525330 | 0;\n        b  = (b << 22 | b >>> 10) + c | 0;\n        a += (b & c | ~b & d) + k[4] - 176418897 | 0;\n        a  = (a << 7 | a >>> 25) + b | 0;\n        d += (a & b | ~a & c) + k[5] + 1200080426 | 0;\n        d  = (d << 12 | d >>> 20) + a | 0;\n        c += (d & a | ~d & b) + k[6] - 1473231341 | 0;\n        c  = (c << 17 | c >>> 15) + d | 0;\n        b += (c & d | ~c & a) + k[7] - 45705983 | 0;\n        b  = (b << 22 | b >>> 10) + c | 0;\n        a += (b & c | ~b & d) + k[8] + 1770035416 | 0;\n        a  = (a << 7 | a >>> 25) + b | 0;\n        d += (a & b | ~a & c) + k[9] - 1958414417 | 0;\n        d  = (d << 12 | d >>> 20) + a | 0;\n        c += (d & a | ~d & b) + k[10] - 42063 | 0;\n        c  = (c << 17 | c >>> 15) + d | 0;\n        b += (c & d | ~c & a) + k[11] - 1990404162 | 0;\n        b  = (b << 22 | b >>> 10) + c | 0;\n        a += (b & c | ~b & d) + k[12] + 1804603682 | 0;\n        a  = (a << 7 | a >>> 25) + b | 0;\n        d += (a & b | ~a & c) + k[13] - 40341101 | 0;\n        d  = (d << 12 | d >>> 20) + a | 0;\n        c += (d & a | ~d & b) + k[14] - 1502002290 | 0;\n        c  = (c << 17 | c >>> 15) + d | 0;\n        b += (c & d | ~c & a) + k[15] + 1236535329 | 0;\n        b  = (b << 22 | b >>> 10) + c | 0;\n\n        a += (b & d | c & ~d) + k[1] - 165796510 | 0;\n        a  = (a << 5 | a >>> 27) + b | 0;\n        d += (a & c | b & ~c) + k[6] - 1069501632 | 0;\n        d  = (d << 9 | d >>> 23) + a | 0;\n        c += (d & b | a & ~b) + k[11] + 643717713 | 0;\n        c  = (c << 14 | c >>> 18) + d | 0;\n        b += (c & a | d & ~a) + k[0] - 373897302 | 0;\n        b  = (b << 20 | b >>> 12) + c | 0;\n        a += (b & d | c & ~d) + k[5] - 701558691 | 0;\n        a  = (a << 5 | a >>> 27) + b | 0;\n        d += (a & c | b & ~c) + k[10] + 38016083 | 0;\n        d  = (d << 9 | d >>> 23) + a | 0;\n        c += (d & b | a & ~b) + k[15] - 660478335 | 0;\n        c  = (c << 14 | c >>> 18) + d | 0;\n        b += (c & a | d & ~a) + k[4] - 405537848 | 0;\n        b  = (b << 20 | b >>> 12) + c | 0;\n        a += (b & d | c & ~d) + k[9] + 568446438 | 0;\n        a  = (a << 5 | a >>> 27) + b | 0;\n        d += (a & c | b & ~c) + k[14] - 1019803690 | 0;\n        d  = (d << 9 | d >>> 23) + a | 0;\n        c += (d & b | a & ~b) + k[3] - 187363961 | 0;\n        c  = (c << 14 | c >>> 18) + d | 0;\n        b += (c & a | d & ~a) + k[8] + 1163531501 | 0;\n        b  = (b << 20 | b >>> 12) + c | 0;\n        a += (b & d | c & ~d) + k[13] - 1444681467 | 0;\n        a  = (a << 5 | a >>> 27) + b | 0;\n        d += (a & c | b & ~c) + k[2] - 51403784 | 0;\n        d  = (d << 9 | d >>> 23) + a | 0;\n        c += (d & b | a & ~b) + k[7] + 1735328473 | 0;\n        c  = (c << 14 | c >>> 18) + d | 0;\n        b += (c & a | d & ~a) + k[12] - 1926607734 | 0;\n        b  = (b << 20 | b >>> 12) + c | 0;\n\n        a += (b ^ c ^ d) + k[5] - 378558 | 0;\n        a  = (a << 4 | a >>> 28) + b | 0;\n        d += (a ^ b ^ c) + k[8] - 2022574463 | 0;\n        d  = (d << 11 | d >>> 21) + a | 0;\n        c += (d ^ a ^ b) + k[11] + 1839030562 | 0;\n        c  = (c << 16 | c >>> 16) + d | 0;\n        b += (c ^ d ^ a) + k[14] - 35309556 | 0;\n        b  = (b << 23 | b >>> 9) + c | 0;\n        a += (b ^ c ^ d) + k[1] - 1530992060 | 0;\n        a  = (a << 4 | a >>> 28) + b | 0;\n        d += (a ^ b ^ c) + k[4] + 1272893353 | 0;\n        d  = (d << 11 | d >>> 21) + a | 0;\n        c += (d ^ a ^ b) + k[7] - 155497632 | 0;\n        c  = (c << 16 | c >>> 16) + d | 0;\n        b += (c ^ d ^ a) + k[10] - 1094730640 | 0;\n        b  = (b << 23 | b >>> 9) + c | 0;\n        a += (b ^ c ^ d) + k[13] + 681279174 | 0;\n        a  = (a << 4 | a >>> 28) + b | 0;\n        d += (a ^ b ^ c) + k[0] - 358537222 | 0;\n        d  = (d << 11 | d >>> 21) + a | 0;\n        c += (d ^ a ^ b) + k[3] - 722521979 | 0;\n        c  = (c << 16 | c >>> 16) + d | 0;\n        b += (c ^ d ^ a) + k[6] + 76029189 | 0;\n        b  = (b << 23 | b >>> 9) + c | 0;\n        a += (b ^ c ^ d) + k[9] - 640364487 | 0;\n        a  = (a << 4 | a >>> 28) + b | 0;\n        d += (a ^ b ^ c) + k[12] - 421815835 | 0;\n        d  = (d << 11 | d >>> 21) + a | 0;\n        c += (d ^ a ^ b) + k[15] + 530742520 | 0;\n        c  = (c << 16 | c >>> 16) + d | 0;\n        b += (c ^ d ^ a) + k[2] - 995338651 | 0;\n        b  = (b << 23 | b >>> 9) + c | 0;\n\n        a += (c ^ (b | ~d)) + k[0] - 198630844 | 0;\n        a  = (a << 6 | a >>> 26) + b | 0;\n        d += (b ^ (a | ~c)) + k[7] + 1126891415 | 0;\n        d  = (d << 10 | d >>> 22) + a | 0;\n        c += (a ^ (d | ~b)) + k[14] - 1416354905 | 0;\n        c  = (c << 15 | c >>> 17) + d | 0;\n        b += (d ^ (c | ~a)) + k[5] - 57434055 | 0;\n        b  = (b << 21 |b >>> 11) + c | 0;\n        a += (c ^ (b | ~d)) + k[12] + 1700485571 | 0;\n        a  = (a << 6 | a >>> 26) + b | 0;\n        d += (b ^ (a | ~c)) + k[3] - 1894986606 | 0;\n        d  = (d << 10 | d >>> 22) + a | 0;\n        c += (a ^ (d | ~b)) + k[10] - 1051523 | 0;\n        c  = (c << 15 | c >>> 17) + d | 0;\n        b += (d ^ (c | ~a)) + k[1] - 2054922799 | 0;\n        b  = (b << 21 |b >>> 11) + c | 0;\n        a += (c ^ (b | ~d)) + k[8] + 1873313359 | 0;\n        a  = (a << 6 | a >>> 26) + b | 0;\n        d += (b ^ (a | ~c)) + k[15] - 30611744 | 0;\n        d  = (d << 10 | d >>> 22) + a | 0;\n        c += (a ^ (d | ~b)) + k[6] - 1560198380 | 0;\n        c  = (c << 15 | c >>> 17) + d | 0;\n        b += (d ^ (c | ~a)) + k[13] + 1309151649 | 0;\n        b  = (b << 21 |b >>> 11) + c | 0;\n        a += (c ^ (b | ~d)) + k[4] - 145523070 | 0;\n        a  = (a << 6 | a >>> 26) + b | 0;\n        d += (b ^ (a | ~c)) + k[11] - 1120210379 | 0;\n        d  = (d << 10 | d >>> 22) + a | 0;\n        c += (a ^ (d | ~b)) + k[2] + 718787259 | 0;\n        c  = (c << 15 | c >>> 17) + d | 0;\n        b += (d ^ (c | ~a)) + k[9] - 343485551 | 0;\n        b  = (b << 21 | b >>> 11) + c | 0;\n\n        x[0] = a + x[0] | 0;\n        x[1] = b + x[1] | 0;\n        x[2] = c + x[2] | 0;\n        x[3] = d + x[3] | 0;\n    }\n\n    function md5blk(s) {\n        var md5blks = [],\n            i; /* Andy King said do it this way. */\n\n        for (i = 0; i < 64; i += 4) {\n            md5blks[i >> 2] = s.charCodeAt(i) + (s.charCodeAt(i + 1) << 8) + (s.charCodeAt(i + 2) << 16) + (s.charCodeAt(i + 3) << 24);\n        }\n        return md5blks;\n    }\n\n    function md5blk_array(a) {\n        var md5blks = [],\n            i; /* Andy King said do it this way. */\n\n        for (i = 0; i < 64; i += 4) {\n            md5blks[i >> 2] = a[i] + (a[i + 1] << 8) + (a[i + 2] << 16) + (a[i + 3] << 24);\n        }\n        return md5blks;\n    }\n\n    function md51(s) {\n        var n = s.length,\n            state = [1732584193, -271733879, -1732584194, 271733878],\n            i,\n            length,\n            tail,\n            tmp,\n            lo,\n            hi;\n\n        for (i = 64; i <= n; i += 64) {\n            md5cycle(state, md5blk(s.substring(i - 64, i)));\n        }\n        s = s.substring(i - 64);\n        length = s.length;\n        tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n        for (i = 0; i < length; i += 1) {\n            tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);\n        }\n        tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n        if (i > 55) {\n            md5cycle(state, tail);\n            for (i = 0; i < 16; i += 1) {\n                tail[i] = 0;\n            }\n        }\n\n        // Beware that the final length might not fit in 32 bits so we take care of that\n        tmp = n * 8;\n        tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n        lo = parseInt(tmp[2], 16);\n        hi = parseInt(tmp[1], 16) || 0;\n\n        tail[14] = lo;\n        tail[15] = hi;\n\n        md5cycle(state, tail);\n        return state;\n    }\n\n    function md51_array(a) {\n        var n = a.length,\n            state = [1732584193, -271733879, -1732584194, 271733878],\n            i,\n            length,\n            tail,\n            tmp,\n            lo,\n            hi;\n\n        for (i = 64; i <= n; i += 64) {\n            md5cycle(state, md5blk_array(a.subarray(i - 64, i)));\n        }\n\n        // Not sure if it is a bug, however IE10 will always produce a sub array of length 1\n        // containing the last element of the parent array if the sub array specified starts\n        // beyond the length of the parent array - weird.\n        // https://connect.microsoft.com/IE/feedback/details/771452/typed-array-subarray-issue\n        a = (i - 64) < n ? a.subarray(i - 64) : new Uint8Array(0);\n\n        length = a.length;\n        tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n        for (i = 0; i < length; i += 1) {\n            tail[i >> 2] |= a[i] << ((i % 4) << 3);\n        }\n\n        tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n        if (i > 55) {\n            md5cycle(state, tail);\n            for (i = 0; i < 16; i += 1) {\n                tail[i] = 0;\n            }\n        }\n\n        // Beware that the final length might not fit in 32 bits so we take care of that\n        tmp = n * 8;\n        tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n        lo = parseInt(tmp[2], 16);\n        hi = parseInt(tmp[1], 16) || 0;\n\n        tail[14] = lo;\n        tail[15] = hi;\n\n        md5cycle(state, tail);\n\n        return state;\n    }\n\n    function rhex(n) {\n        var s = '',\n            j;\n        for (j = 0; j < 4; j += 1) {\n            s += hex_chr[(n >> (j * 8 + 4)) & 0x0F] + hex_chr[(n >> (j * 8)) & 0x0F];\n        }\n        return s;\n    }\n\n    function hex(x) {\n        var i;\n        for (i = 0; i < x.length; i += 1) {\n            x[i] = rhex(x[i]);\n        }\n        return x.join('');\n    }\n\n    // In some cases the fast add32 function cannot be used..\n    if (hex(md51('hello')) !== '5d41402abc4b2a76b9719d911017c592') {\n        add32 = function (x, y) {\n            var lsw = (x & 0xFFFF) + (y & 0xFFFF),\n                msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n            return (msw << 16) | (lsw & 0xFFFF);\n        };\n    }\n\n    // ---------------------------------------------------\n\n    /**\n     * ArrayBuffer slice polyfill.\n     *\n     * @see https://github.com/ttaubert/node-arraybuffer-slice\n     */\n\n    if (typeof ArrayBuffer !== 'undefined' && !ArrayBuffer.prototype.slice) {\n        (function () {\n            function clamp(val, length) {\n                val = (val | 0) || 0;\n\n                if (val < 0) {\n                    return Math.max(val + length, 0);\n                }\n\n                return Math.min(val, length);\n            }\n\n            ArrayBuffer.prototype.slice = function (from, to) {\n                var length = this.byteLength,\n                    begin = clamp(from, length),\n                    end = length,\n                    num,\n                    target,\n                    targetArray,\n                    sourceArray;\n\n                if (to !== undefined) {\n                    end = clamp(to, length);\n                }\n\n                if (begin > end) {\n                    return new ArrayBuffer(0);\n                }\n\n                num = end - begin;\n                target = new ArrayBuffer(num);\n                targetArray = new Uint8Array(target);\n\n                sourceArray = new Uint8Array(this, begin, num);\n                targetArray.set(sourceArray);\n\n                return target;\n            };\n        })();\n    }\n\n    // ---------------------------------------------------\n\n    /**\n     * Helpers.\n     */\n\n    function toUtf8(str) {\n        if (/[\\u0080-\\uFFFF]/.test(str)) {\n            str = unescape(encodeURIComponent(str));\n        }\n\n        return str;\n    }\n\n    function utf8Str2ArrayBuffer(str, returnUInt8Array) {\n        var length = str.length,\n           buff = new ArrayBuffer(length),\n           arr = new Uint8Array(buff),\n           i;\n\n        for (i = 0; i < length; i += 1) {\n            arr[i] = str.charCodeAt(i);\n        }\n\n        return returnUInt8Array ? arr : buff;\n    }\n\n    function arrayBuffer2Utf8Str(buff) {\n        return String.fromCharCode.apply(null, new Uint8Array(buff));\n    }\n\n    function concatenateArrayBuffers(first, second, returnUInt8Array) {\n        var result = new Uint8Array(first.byteLength + second.byteLength);\n\n        result.set(new Uint8Array(first));\n        result.set(new Uint8Array(second), first.byteLength);\n\n        return returnUInt8Array ? result : result.buffer;\n    }\n\n    function hexToBinaryString(hex) {\n        var bytes = [],\n            length = hex.length,\n            x;\n\n        for (x = 0; x < length - 1; x += 2) {\n            bytes.push(parseInt(hex.substr(x, 2), 16));\n        }\n\n        return String.fromCharCode.apply(String, bytes);\n    }\n\n    // ---------------------------------------------------\n\n    /**\n     * SparkMD5 OOP implementation.\n     *\n     * Use this class to perform an incremental md5, otherwise use the\n     * static methods instead.\n     */\n\n    function SparkMD5() {\n        // call reset to init the instance\n        this.reset();\n    }\n\n    /**\n     * Appends a string.\n     * A conversion will be applied if an utf8 string is detected.\n     *\n     * @param {String} str The string to be appended\n     *\n     * @return {SparkMD5} The instance itself\n     */\n    SparkMD5.prototype.append = function (str) {\n        // Converts the string to utf8 bytes if necessary\n        // Then append as binary\n        this.appendBinary(toUtf8(str));\n\n        return this;\n    };\n\n    /**\n     * Appends a binary string.\n     *\n     * @param {String} contents The binary string to be appended\n     *\n     * @return {SparkMD5} The instance itself\n     */\n    SparkMD5.prototype.appendBinary = function (contents) {\n        this._buff += contents;\n        this._length += contents.length;\n\n        var length = this._buff.length,\n            i;\n\n        for (i = 64; i <= length; i += 64) {\n            md5cycle(this._hash, md5blk(this._buff.substring(i - 64, i)));\n        }\n\n        this._buff = this._buff.substring(i - 64);\n\n        return this;\n    };\n\n    /**\n     * Finishes the incremental computation, reseting the internal state and\n     * returning the result.\n     *\n     * @param {Boolean} raw True to get the raw string, false to get the hex string\n     *\n     * @return {String} The result\n     */\n    SparkMD5.prototype.end = function (raw) {\n        var buff = this._buff,\n            length = buff.length,\n            i,\n            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n            ret;\n\n        for (i = 0; i < length; i += 1) {\n            tail[i >> 2] |= buff.charCodeAt(i) << ((i % 4) << 3);\n        }\n\n        this._finish(tail, length);\n        ret = hex(this._hash);\n\n        if (raw) {\n            ret = hexToBinaryString(ret);\n        }\n\n        this.reset();\n\n        return ret;\n    };\n\n    /**\n     * Resets the internal state of the computation.\n     *\n     * @return {SparkMD5} The instance itself\n     */\n    SparkMD5.prototype.reset = function () {\n        this._buff = '';\n        this._length = 0;\n        this._hash = [1732584193, -271733879, -1732584194, 271733878];\n\n        return this;\n    };\n\n    /**\n     * Gets the internal state of the computation.\n     *\n     * @return {Object} The state\n     */\n    SparkMD5.prototype.getState = function () {\n        return {\n            buff: this._buff,\n            length: this._length,\n            hash: this._hash.slice()\n        };\n    };\n\n    /**\n     * Gets the internal state of the computation.\n     *\n     * @param {Object} state The state\n     *\n     * @return {SparkMD5} The instance itself\n     */\n    SparkMD5.prototype.setState = function (state) {\n        this._buff = state.buff;\n        this._length = state.length;\n        this._hash = state.hash;\n\n        return this;\n    };\n\n    /**\n     * Releases memory used by the incremental buffer and other additional\n     * resources. If you plan to use the instance again, use reset instead.\n     */\n    SparkMD5.prototype.destroy = function () {\n        delete this._hash;\n        delete this._buff;\n        delete this._length;\n    };\n\n    /**\n     * Finish the final calculation based on the tail.\n     *\n     * @param {Array}  tail   The tail (will be modified)\n     * @param {Number} length The length of the remaining buffer\n     */\n    SparkMD5.prototype._finish = function (tail, length) {\n        var i = length,\n            tmp,\n            lo,\n            hi;\n\n        tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n        if (i > 55) {\n            md5cycle(this._hash, tail);\n            for (i = 0; i < 16; i += 1) {\n                tail[i] = 0;\n            }\n        }\n\n        // Do the final computation based on the tail and length\n        // Beware that the final length may not fit in 32 bits so we take care of that\n        tmp = this._length * 8;\n        tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n        lo = parseInt(tmp[2], 16);\n        hi = parseInt(tmp[1], 16) || 0;\n\n        tail[14] = lo;\n        tail[15] = hi;\n        md5cycle(this._hash, tail);\n    };\n\n    /**\n     * Performs the md5 hash on a string.\n     * A conversion will be applied if utf8 string is detected.\n     *\n     * @param {String}  str The string\n     * @param {Boolean} [raw] True to get the raw string, false to get the hex string\n     *\n     * @return {String} The result\n     */\n    SparkMD5.hash = function (str, raw) {\n        // Converts the string to utf8 bytes if necessary\n        // Then compute it using the binary function\n        return SparkMD5.hashBinary(toUtf8(str), raw);\n    };\n\n    /**\n     * Performs the md5 hash on a binary string.\n     *\n     * @param {String}  content The binary string\n     * @param {Boolean} [raw]     True to get the raw string, false to get the hex string\n     *\n     * @return {String} The result\n     */\n    SparkMD5.hashBinary = function (content, raw) {\n        var hash = md51(content),\n            ret = hex(hash);\n\n        return raw ? hexToBinaryString(ret) : ret;\n    };\n\n    // ---------------------------------------------------\n\n    /**\n     * SparkMD5 OOP implementation for array buffers.\n     *\n     * Use this class to perform an incremental md5 ONLY for array buffers.\n     */\n    SparkMD5.ArrayBuffer = function () {\n        // call reset to init the instance\n        this.reset();\n    };\n\n    /**\n     * Appends an array buffer.\n     *\n     * @param {ArrayBuffer} arr The array to be appended\n     *\n     * @return {SparkMD5.ArrayBuffer} The instance itself\n     */\n    SparkMD5.ArrayBuffer.prototype.append = function (arr) {\n        var buff = concatenateArrayBuffers(this._buff.buffer, arr, true),\n            length = buff.length,\n            i;\n\n        this._length += arr.byteLength;\n\n        for (i = 64; i <= length; i += 64) {\n            md5cycle(this._hash, md5blk_array(buff.subarray(i - 64, i)));\n        }\n\n        this._buff = (i - 64) < length ? new Uint8Array(buff.buffer.slice(i - 64)) : new Uint8Array(0);\n\n        return this;\n    };\n\n    /**\n     * Finishes the incremental computation, reseting the internal state and\n     * returning the result.\n     *\n     * @param {Boolean} raw True to get the raw string, false to get the hex string\n     *\n     * @return {String} The result\n     */\n    SparkMD5.ArrayBuffer.prototype.end = function (raw) {\n        var buff = this._buff,\n            length = buff.length,\n            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n            i,\n            ret;\n\n        for (i = 0; i < length; i += 1) {\n            tail[i >> 2] |= buff[i] << ((i % 4) << 3);\n        }\n\n        this._finish(tail, length);\n        ret = hex(this._hash);\n\n        if (raw) {\n            ret = hexToBinaryString(ret);\n        }\n\n        this.reset();\n\n        return ret;\n    };\n\n    /**\n     * Resets the internal state of the computation.\n     *\n     * @return {SparkMD5.ArrayBuffer} The instance itself\n     */\n    SparkMD5.ArrayBuffer.prototype.reset = function () {\n        this._buff = new Uint8Array(0);\n        this._length = 0;\n        this._hash = [1732584193, -271733879, -1732584194, 271733878];\n\n        return this;\n    };\n\n    /**\n     * Gets the internal state of the computation.\n     *\n     * @return {Object} The state\n     */\n    SparkMD5.ArrayBuffer.prototype.getState = function () {\n        var state = SparkMD5.prototype.getState.call(this);\n\n        // Convert buffer to a string\n        state.buff = arrayBuffer2Utf8Str(state.buff);\n\n        return state;\n    };\n\n    /**\n     * Gets the internal state of the computation.\n     *\n     * @param {Object} state The state\n     *\n     * @return {SparkMD5.ArrayBuffer} The instance itself\n     */\n    SparkMD5.ArrayBuffer.prototype.setState = function (state) {\n        // Convert string to buffer\n        state.buff = utf8Str2ArrayBuffer(state.buff, true);\n\n        return SparkMD5.prototype.setState.call(this, state);\n    };\n\n    SparkMD5.ArrayBuffer.prototype.destroy = SparkMD5.prototype.destroy;\n\n    SparkMD5.ArrayBuffer.prototype._finish = SparkMD5.prototype._finish;\n\n    /**\n     * Performs the md5 hash on an array buffer.\n     *\n     * @param {ArrayBuffer} arr The array buffer\n     * @param {Boolean}     [raw] True to get the raw string, false to get the hex one\n     *\n     * @return {String} The result\n     */\n    SparkMD5.ArrayBuffer.hash = function (arr, raw) {\n        var hash = md51_array(new Uint8Array(arr)),\n            ret = hex(hash);\n\n        return raw ? hexToBinaryString(ret) : ret;\n    };\n\n    return SparkMD5;\n}));\n","'use strict';\n\n/**\n * Stringify/parse functions that don't operate\n * recursively, so they avoid call stack exceeded\n * errors.\n */\nexports.stringify = function stringify(input) {\n  var queue = [];\n  queue.push({obj: input});\n\n  var res = '';\n  var next, obj, prefix, val, i, arrayPrefix, keys, k, key, value, objPrefix;\n  while ((next = queue.pop())) {\n    obj = next.obj;\n    prefix = next.prefix || '';\n    val = next.val || '';\n    res += prefix;\n    if (val) {\n      res += val;\n    } else if (typeof obj !== 'object') {\n      res += typeof obj === 'undefined' ? null : JSON.stringify(obj);\n    } else if (obj === null) {\n      res += 'null';\n    } else if (Array.isArray(obj)) {\n      queue.push({val: ']'});\n      for (i = obj.length - 1; i >= 0; i--) {\n        arrayPrefix = i === 0 ? '' : ',';\n        queue.push({obj: obj[i], prefix: arrayPrefix});\n      }\n      queue.push({val: '['});\n    } else { // object\n      keys = [];\n      for (k in obj) {\n        if (obj.hasOwnProperty(k)) {\n          keys.push(k);\n        }\n      }\n      queue.push({val: '}'});\n      for (i = keys.length - 1; i >= 0; i--) {\n        key = keys[i];\n        value = obj[key];\n        objPrefix = (i > 0 ? ',' : '');\n        objPrefix += JSON.stringify(key) + ':';\n        queue.push({obj: value, prefix: objPrefix});\n      }\n      queue.push({val: '{'});\n    }\n  }\n  return res;\n};\n\n// Convenience function for the parse function.\n// This pop function is basically copied from\n// pouchCollate.parseIndexableString\nfunction pop(obj, stack, metaStack) {\n  var lastMetaElement = metaStack[metaStack.length - 1];\n  if (obj === lastMetaElement.element) {\n    // popping a meta-element, e.g. an object whose value is another object\n    metaStack.pop();\n    lastMetaElement = metaStack[metaStack.length - 1];\n  }\n  var element = lastMetaElement.element;\n  var lastElementIndex = lastMetaElement.index;\n  if (Array.isArray(element)) {\n    element.push(obj);\n  } else if (lastElementIndex === stack.length - 2) { // obj with key+value\n    var key = stack.pop();\n    element[key] = obj;\n  } else {\n    stack.push(obj); // obj with key only\n  }\n}\n\nexports.parse = function (str) {\n  var stack = [];\n  var metaStack = []; // stack for arrays and objects\n  var i = 0;\n  var collationIndex,parsedNum,numChar;\n  var parsedString,lastCh,numConsecutiveSlashes,ch;\n  var arrayElement, objElement;\n  while (true) {\n    collationIndex = str[i++];\n    if (collationIndex === '}' ||\n        collationIndex === ']' ||\n        typeof collationIndex === 'undefined') {\n      if (stack.length === 1) {\n        return stack.pop();\n      } else {\n        pop(stack.pop(), stack, metaStack);\n        continue;\n      }\n    }\n    switch (collationIndex) {\n      case ' ':\n      case '\\t':\n      case '\\n':\n      case ':':\n      case ',':\n        break;\n      case 'n':\n        i += 3; // 'ull'\n        pop(null, stack, metaStack);\n        break;\n      case 't':\n        i += 3; // 'rue'\n        pop(true, stack, metaStack);\n        break;\n      case 'f':\n        i += 4; // 'alse'\n        pop(false, stack, metaStack);\n        break;\n      case '0':\n      case '1':\n      case '2':\n      case '3':\n      case '4':\n      case '5':\n      case '6':\n      case '7':\n      case '8':\n      case '9':\n      case '-':\n        parsedNum = '';\n        i--;\n        while (true) {\n          numChar = str[i++];\n          if (/[\\d\\.\\-e\\+]/.test(numChar)) {\n            parsedNum += numChar;\n          } else {\n            i--;\n            break;\n          }\n        }\n        pop(parseFloat(parsedNum), stack, metaStack);\n        break;\n      case '\"':\n        parsedString = '';\n        lastCh = void 0;\n        numConsecutiveSlashes = 0;\n        while (true) {\n          ch = str[i++];\n          if (ch !== '\"' || (lastCh === '\\\\' &&\n              numConsecutiveSlashes % 2 === 1)) {\n            parsedString += ch;\n            lastCh = ch;\n            if (lastCh === '\\\\') {\n              numConsecutiveSlashes++;\n            } else {\n              numConsecutiveSlashes = 0;\n            }\n          } else {\n            break;\n          }\n        }\n        pop(JSON.parse('\"' + parsedString + '\"'), stack, metaStack);\n        break;\n      case '[':\n        arrayElement = { element: [], index: stack.length };\n        stack.push(arrayElement.element);\n        metaStack.push(arrayElement);\n        break;\n      case '{':\n        objElement = { element: {}, index: stack.length };\n        stack.push(objElement.element);\n        metaStack.push(objElement);\n        break;\n      default:\n        throw new Error(\n          'unexpectedly reached end of input: ' + collationIndex);\n    }\n  }\n};\n","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n// find the complete implementation of crypto (msCrypto) on IE11.\nvar getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  if (!getRandomValues) {\n    throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n  }\n\n  return getRandomValues(rnds8);\n}","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex; // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n\n  return (bth[buf[i + 0]] + bth[buf[i + 1]] + bth[buf[i + 2]] + bth[buf[i + 3]] + '-' + bth[buf[i + 4]] + bth[buf[i + 5]] + '-' + bth[buf[i + 6]] + bth[buf[i + 7]] + '-' + bth[buf[i + 8]] + bth[buf[i + 9]] + '-' + bth[buf[i + 10]] + bth[buf[i + 11]] + bth[buf[i + 12]] + bth[buf[i + 13]] + bth[buf[i + 14]] + bth[buf[i + 15]]).toLowerCase();\n}\n\nexport default bytesToUuid;","import rng from './rng.js';\nimport bytesToUuid from './bytesToUuid.js';\n\nfunction v4(options, buf, offset) {\n  if (typeof options === 'string') {\n    buf = options === 'binary' ? new Uint8Array(16) : null;\n    options = null;\n  }\n\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    var start = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[start + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return bytesToUuid(rnds);\n}\n\nexport default v4;","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","import immediate from 'immediate';\nimport { v4 } from 'uuid';\nimport Md5 from 'spark-md5';\nimport vuvuzela from 'vuvuzela';\nimport getArguments from 'argsarray';\nimport inherits from 'inherits';\nimport EE from 'events';\n\nfunction mangle(key) {\n  return '$' + key;\n}\nfunction unmangle(key) {\n  return key.substring(1);\n}\nfunction Map$1() {\n  this._store = {};\n}\nMap$1.prototype.get = function (key) {\n  var mangled = mangle(key);\n  return this._store[mangled];\n};\nMap$1.prototype.set = function (key, value) {\n  var mangled = mangle(key);\n  this._store[mangled] = value;\n  return true;\n};\nMap$1.prototype.has = function (key) {\n  var mangled = mangle(key);\n  return mangled in this._store;\n};\nMap$1.prototype.delete = function (key) {\n  var mangled = mangle(key);\n  var res = mangled in this._store;\n  delete this._store[mangled];\n  return res;\n};\nMap$1.prototype.forEach = function (cb) {\n  var keys = Object.keys(this._store);\n  for (var i = 0, len = keys.length; i < len; i++) {\n    var key = keys[i];\n    var value = this._store[key];\n    key = unmangle(key);\n    cb(value, key);\n  }\n};\nObject.defineProperty(Map$1.prototype, 'size', {\n  get: function () {\n    return Object.keys(this._store).length;\n  }\n});\n\nfunction Set$1(array) {\n  this._store = new Map$1();\n\n  // init with an array\n  if (array && Array.isArray(array)) {\n    for (var i = 0, len = array.length; i < len; i++) {\n      this.add(array[i]);\n    }\n  }\n}\nSet$1.prototype.add = function (key) {\n  return this._store.set(key, true);\n};\nSet$1.prototype.has = function (key) {\n  return this._store.has(key);\n};\nSet$1.prototype.forEach = function (cb) {\n  this._store.forEach(function (value, key) {\n    cb(key);\n  });\n};\nObject.defineProperty(Set$1.prototype, 'size', {\n  get: function () {\n    return this._store.size;\n  }\n});\n\n/* global Map,Set,Symbol */\n// Based on https://kangax.github.io/compat-table/es6/ we can sniff out\n// incomplete Map/Set implementations which would otherwise cause our tests to fail.\n// Notably they fail in IE11 and iOS 8.4, which this prevents.\nfunction supportsMapAndSet() {\n  if (typeof Symbol === 'undefined' || typeof Map === 'undefined' || typeof Set === 'undefined') {\n    return false;\n  }\n  var prop = Object.getOwnPropertyDescriptor(Map, Symbol.species);\n  return prop && 'get' in prop && Map[Symbol.species] === Map;\n}\n\n// based on https://github.com/montagejs/collections\n\nvar ExportedSet;\nvar ExportedMap;\n\n{\n  if (supportsMapAndSet()) { // prefer built-in Map/Set\n    ExportedSet = Set;\n    ExportedMap = Map;\n  } else { // fall back to our polyfill\n    ExportedSet = Set$1;\n    ExportedMap = Map$1;\n  }\n}\n\nfunction isBinaryObject(object) {\n  return (typeof ArrayBuffer !== 'undefined' && object instanceof ArrayBuffer) ||\n    (typeof Blob !== 'undefined' && object instanceof Blob);\n}\n\nfunction cloneArrayBuffer(buff) {\n  if (typeof buff.slice === 'function') {\n    return buff.slice(0);\n  }\n  // IE10-11 slice() polyfill\n  var target = new ArrayBuffer(buff.byteLength);\n  var targetArray = new Uint8Array(target);\n  var sourceArray = new Uint8Array(buff);\n  targetArray.set(sourceArray);\n  return target;\n}\n\nfunction cloneBinaryObject(object) {\n  if (object instanceof ArrayBuffer) {\n    return cloneArrayBuffer(object);\n  }\n  var size = object.size;\n  var type = object.type;\n  // Blob\n  if (typeof object.slice === 'function') {\n    return object.slice(0, size, type);\n  }\n  // PhantomJS slice() replacement\n  return object.webkitSlice(0, size, type);\n}\n\n// most of this is borrowed from lodash.isPlainObject:\n// https://github.com/fis-components/lodash.isplainobject/\n// blob/29c358140a74f252aeb08c9eb28bef86f2217d4a/index.js\n\nvar funcToString = Function.prototype.toString;\nvar objectCtorString = funcToString.call(Object);\n\nfunction isPlainObject(value) {\n  var proto = Object.getPrototypeOf(value);\n  /* istanbul ignore if */\n  if (proto === null) { // not sure when this happens, but I guess it can\n    return true;\n  }\n  var Ctor = proto.constructor;\n  return (typeof Ctor == 'function' &&\n    Ctor instanceof Ctor && funcToString.call(Ctor) == objectCtorString);\n}\n\nfunction clone(object) {\n  var newObject;\n  var i;\n  var len;\n\n  if (!object || typeof object !== 'object') {\n    return object;\n  }\n\n  if (Array.isArray(object)) {\n    newObject = [];\n    for (i = 0, len = object.length; i < len; i++) {\n      newObject[i] = clone(object[i]);\n    }\n    return newObject;\n  }\n\n  // special case: to avoid inconsistencies between IndexedDB\n  // and other backends, we automatically stringify Dates\n  if (object instanceof Date) {\n    return object.toISOString();\n  }\n\n  if (isBinaryObject(object)) {\n    return cloneBinaryObject(object);\n  }\n\n  if (!isPlainObject(object)) {\n    return object; // don't clone objects like Workers\n  }\n\n  newObject = {};\n  for (i in object) {\n    /* istanbul ignore else */\n    if (Object.prototype.hasOwnProperty.call(object, i)) {\n      var value = clone(object[i]);\n      if (typeof value !== 'undefined') {\n        newObject[i] = value;\n      }\n    }\n  }\n  return newObject;\n}\n\nfunction once(fun) {\n  var called = false;\n  return getArguments(function (args) {\n    /* istanbul ignore if */\n    if (called) {\n      // this is a smoke test and should never actually happen\n      throw new Error('once called more than once');\n    } else {\n      called = true;\n      fun.apply(this, args);\n    }\n  });\n}\n\nfunction toPromise(func) {\n  //create the function we will be returning\n  return getArguments(function (args) {\n    // Clone arguments\n    args = clone(args);\n    var self = this;\n    // if the last argument is a function, assume its a callback\n    var usedCB = (typeof args[args.length - 1] === 'function') ? args.pop() : false;\n    var promise = new Promise(function (fulfill, reject) {\n      var resp;\n      try {\n        var callback = once(function (err, mesg) {\n          if (err) {\n            reject(err);\n          } else {\n            fulfill(mesg);\n          }\n        });\n        // create a callback for this invocation\n        // apply the function in the orig context\n        args.push(callback);\n        resp = func.apply(self, args);\n        if (resp && typeof resp.then === 'function') {\n          fulfill(resp);\n        }\n      } catch (e) {\n        reject(e);\n      }\n    });\n    // if there is a callback, call it back\n    if (usedCB) {\n      promise.then(function (result) {\n        usedCB(null, result);\n      }, usedCB);\n    }\n    return promise;\n  });\n}\n\nfunction logApiCall(self, name, args) {\n  /* istanbul ignore if */\n  if (self.constructor.listeners('debug').length) {\n    var logArgs = ['api', self.name, name];\n    for (var i = 0; i < args.length - 1; i++) {\n      logArgs.push(args[i]);\n    }\n    self.constructor.emit('debug', logArgs);\n\n    // override the callback itself to log the response\n    var origCallback = args[args.length - 1];\n    args[args.length - 1] = function (err, res) {\n      var responseArgs = ['api', self.name, name];\n      responseArgs = responseArgs.concat(\n        err ? ['error', err] : ['success', res]\n      );\n      self.constructor.emit('debug', responseArgs);\n      origCallback(err, res);\n    };\n  }\n}\n\nfunction adapterFun(name, callback) {\n  return toPromise(getArguments(function (args) {\n    if (this._closed) {\n      return Promise.reject(new Error('database is closed'));\n    }\n    if (this._destroyed) {\n      return Promise.reject(new Error('database is destroyed'));\n    }\n    var self = this;\n    logApiCall(self, name, args);\n    if (!this.taskqueue.isReady) {\n      return new Promise(function (fulfill, reject) {\n        self.taskqueue.addTask(function (failed) {\n          if (failed) {\n            reject(failed);\n          } else {\n            fulfill(self[name].apply(self, args));\n          }\n        });\n      });\n    }\n    return callback.apply(this, args);\n  }));\n}\n\n// like underscore/lodash _.pick()\nfunction pick(obj, arr) {\n  var res = {};\n  for (var i = 0, len = arr.length; i < len; i++) {\n    var prop = arr[i];\n    if (prop in obj) {\n      res[prop] = obj[prop];\n    }\n  }\n  return res;\n}\n\n// Most browsers throttle concurrent requests at 6, so it's silly\n// to shim _bulk_get by trying to launch potentially hundreds of requests\n// and then letting the majority time out. We can handle this ourselves.\nvar MAX_NUM_CONCURRENT_REQUESTS = 6;\n\nfunction identityFunction(x) {\n  return x;\n}\n\nfunction formatResultForOpenRevsGet(result) {\n  return [{\n    ok: result\n  }];\n}\n\n// shim for P/CouchDB adapters that don't directly implement _bulk_get\nfunction bulkGet(db, opts, callback) {\n  var requests = opts.docs;\n\n  // consolidate into one request per doc if possible\n  var requestsById = new ExportedMap();\n  requests.forEach(function (request) {\n    if (requestsById.has(request.id)) {\n      requestsById.get(request.id).push(request);\n    } else {\n      requestsById.set(request.id, [request]);\n    }\n  });\n\n  var numDocs = requestsById.size;\n  var numDone = 0;\n  var perDocResults = new Array(numDocs);\n\n  function collapseResultsAndFinish() {\n    var results = [];\n    perDocResults.forEach(function (res) {\n      res.docs.forEach(function (info) {\n        results.push({\n          id: res.id,\n          docs: [info]\n        });\n      });\n    });\n    callback(null, {results: results});\n  }\n\n  function checkDone() {\n    if (++numDone === numDocs) {\n      collapseResultsAndFinish();\n    }\n  }\n\n  function gotResult(docIndex, id, docs) {\n    perDocResults[docIndex] = {id: id, docs: docs};\n    checkDone();\n  }\n\n  var allRequests = [];\n  requestsById.forEach(function (value, key) {\n    allRequests.push(key);\n  });\n\n  var i = 0;\n\n  function nextBatch() {\n\n    if (i >= allRequests.length) {\n      return;\n    }\n\n    var upTo = Math.min(i + MAX_NUM_CONCURRENT_REQUESTS, allRequests.length);\n    var batch = allRequests.slice(i, upTo);\n    processBatch(batch, i);\n    i += batch.length;\n  }\n\n  function processBatch(batch, offset) {\n    batch.forEach(function (docId, j) {\n      var docIdx = offset + j;\n      var docRequests = requestsById.get(docId);\n\n      // just use the first request as the \"template\"\n      // TODO: The _bulk_get API allows for more subtle use cases than this,\n      // but for now it is unlikely that there will be a mix of different\n      // \"atts_since\" or \"attachments\" in the same request, since it's just\n      // replicate.js that is using this for the moment.\n      // Also, atts_since is aspirational, since we don't support it yet.\n      var docOpts = pick(docRequests[0], ['atts_since', 'attachments']);\n      docOpts.open_revs = docRequests.map(function (request) {\n        // rev is optional, open_revs disallowed\n        return request.rev;\n      });\n\n      // remove falsey / undefined revisions\n      docOpts.open_revs = docOpts.open_revs.filter(identityFunction);\n\n      var formatResult = identityFunction;\n\n      if (docOpts.open_revs.length === 0) {\n        delete docOpts.open_revs;\n\n        // when fetching only the \"winning\" leaf,\n        // transform the result so it looks like an open_revs\n        // request\n        formatResult = formatResultForOpenRevsGet;\n      }\n\n      // globally-supplied options\n      ['revs', 'attachments', 'binary', 'ajax', 'latest'].forEach(function (param) {\n        if (param in opts) {\n          docOpts[param] = opts[param];\n        }\n      });\n      db.get(docId, docOpts, function (err, res) {\n        var result;\n        /* istanbul ignore if */\n        if (err) {\n          result = [{error: err}];\n        } else {\n          result = formatResult(res);\n        }\n        gotResult(docIdx, docId, result);\n        nextBatch();\n      });\n    });\n  }\n\n  nextBatch();\n\n}\n\nvar hasLocal;\n\ntry {\n  localStorage.setItem('_pouch_check_localstorage', 1);\n  hasLocal = !!localStorage.getItem('_pouch_check_localstorage');\n} catch (e) {\n  hasLocal = false;\n}\n\nfunction hasLocalStorage() {\n  return hasLocal;\n}\n\n// Custom nextTick() shim for browsers. In node, this will just be process.nextTick(). We\n\ninherits(Changes, EE);\n\n/* istanbul ignore next */\nfunction attachBrowserEvents(self) {\n  if (hasLocalStorage()) {\n    addEventListener(\"storage\", function (e) {\n      self.emit(e.key);\n    });\n  }\n}\n\nfunction Changes() {\n  EE.call(this);\n  this._listeners = {};\n\n  attachBrowserEvents(this);\n}\nChanges.prototype.addListener = function (dbName, id, db, opts) {\n  /* istanbul ignore if */\n  if (this._listeners[id]) {\n    return;\n  }\n  var self = this;\n  var inprogress = false;\n  function eventFunction() {\n    /* istanbul ignore if */\n    if (!self._listeners[id]) {\n      return;\n    }\n    if (inprogress) {\n      inprogress = 'waiting';\n      return;\n    }\n    inprogress = true;\n    var changesOpts = pick(opts, [\n      'style', 'include_docs', 'attachments', 'conflicts', 'filter',\n      'doc_ids', 'view', 'since', 'query_params', 'binary', 'return_docs'\n    ]);\n\n    /* istanbul ignore next */\n    function onError() {\n      inprogress = false;\n    }\n\n    db.changes(changesOpts).on('change', function (c) {\n      if (c.seq > opts.since && !opts.cancelled) {\n        opts.since = c.seq;\n        opts.onChange(c);\n      }\n    }).on('complete', function () {\n      if (inprogress === 'waiting') {\n        immediate(eventFunction);\n      }\n      inprogress = false;\n    }).on('error', onError);\n  }\n  this._listeners[id] = eventFunction;\n  this.on(dbName, eventFunction);\n};\n\nChanges.prototype.removeListener = function (dbName, id) {\n  /* istanbul ignore if */\n  if (!(id in this._listeners)) {\n    return;\n  }\n  EE.prototype.removeListener.call(this, dbName,\n    this._listeners[id]);\n  delete this._listeners[id];\n};\n\n\n/* istanbul ignore next */\nChanges.prototype.notifyLocalWindows = function (dbName) {\n  //do a useless change on a storage thing\n  //in order to get other windows's listeners to activate\n  if (hasLocalStorage()) {\n    localStorage[dbName] = (localStorage[dbName] === \"a\") ? \"b\" : \"a\";\n  }\n};\n\nChanges.prototype.notify = function (dbName) {\n  this.emit(dbName);\n  this.notifyLocalWindows(dbName);\n};\n\nfunction guardedConsole(method) {\n  /* istanbul ignore else */\n  if (typeof console !== 'undefined' && typeof console[method] === 'function') {\n    var args = Array.prototype.slice.call(arguments, 1);\n    console[method].apply(console, args);\n  }\n}\n\nfunction randomNumber(min, max) {\n  var maxTimeout = 600000; // Hard-coded default of 10 minutes\n  min = parseInt(min, 10) || 0;\n  max = parseInt(max, 10);\n  if (max !== max || max <= min) {\n    max = (min || 1) << 1; //doubling\n  } else {\n    max = max + 1;\n  }\n  // In order to not exceed maxTimeout, pick a random value between half of maxTimeout and maxTimeout\n  if (max > maxTimeout) {\n    min = maxTimeout >> 1; // divide by two\n    max = maxTimeout;\n  }\n  var ratio = Math.random();\n  var range = max - min;\n\n  return ~~(range * ratio + min); // ~~ coerces to an int, but fast.\n}\n\nfunction defaultBackOff(min) {\n  var max = 0;\n  if (!min) {\n    max = 2000;\n  }\n  return randomNumber(min, max);\n}\n\n// designed to give info to browser users, who are disturbed\n// when they see http errors in the console\nfunction explainError(status, str) {\n  guardedConsole('info', 'The above ' + status + ' is totally normal. ' + str);\n}\n\nvar assign;\n{\n  if (typeof Object.assign === 'function') {\n    assign = Object.assign;\n  } else {\n    // lite Object.assign polyfill based on\n    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\n    assign = function (target) {\n      var to = Object(target);\n\n      for (var index = 1; index < arguments.length; index++) {\n        var nextSource = arguments[index];\n\n        if (nextSource != null) { // Skip over if undefined or null\n          for (var nextKey in nextSource) {\n            // Avoid bugs when hasOwnProperty is shadowed\n            if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\n              to[nextKey] = nextSource[nextKey];\n            }\n          }\n        }\n      }\n      return to;\n    };\n  }\n}\n\nvar $inject_Object_assign = assign;\n\ninherits(PouchError, Error);\n\nfunction PouchError(status, error, reason) {\n  Error.call(this, reason);\n  this.status = status;\n  this.name = error;\n  this.message = reason;\n  this.error = true;\n}\n\nPouchError.prototype.toString = function () {\n  return JSON.stringify({\n    status: this.status,\n    name: this.name,\n    message: this.message,\n    reason: this.reason\n  });\n};\n\nvar UNAUTHORIZED = new PouchError(401, 'unauthorized', \"Name or password is incorrect.\");\nvar MISSING_BULK_DOCS = new PouchError(400, 'bad_request', \"Missing JSON list of 'docs'\");\nvar MISSING_DOC = new PouchError(404, 'not_found', 'missing');\nvar REV_CONFLICT = new PouchError(409, 'conflict', 'Document update conflict');\nvar INVALID_ID = new PouchError(400, 'bad_request', '_id field must contain a string');\nvar MISSING_ID = new PouchError(412, 'missing_id', '_id is required for puts');\nvar RESERVED_ID = new PouchError(400, 'bad_request', 'Only reserved document ids may start with underscore.');\nvar NOT_OPEN = new PouchError(412, 'precondition_failed', 'Database not open');\nvar UNKNOWN_ERROR = new PouchError(500, 'unknown_error', 'Database encountered an unknown error');\nvar BAD_ARG = new PouchError(500, 'badarg', 'Some query argument is invalid');\nvar INVALID_REQUEST = new PouchError(400, 'invalid_request', 'Request was invalid');\nvar QUERY_PARSE_ERROR = new PouchError(400, 'query_parse_error', 'Some query parameter is invalid');\nvar DOC_VALIDATION = new PouchError(500, 'doc_validation', 'Bad special document member');\nvar BAD_REQUEST = new PouchError(400, 'bad_request', 'Something wrong with the request');\nvar NOT_AN_OBJECT = new PouchError(400, 'bad_request', 'Document must be a JSON object');\nvar DB_MISSING = new PouchError(404, 'not_found', 'Database not found');\nvar IDB_ERROR = new PouchError(500, 'indexed_db_went_bad', 'unknown');\nvar WSQ_ERROR = new PouchError(500, 'web_sql_went_bad', 'unknown');\nvar LDB_ERROR = new PouchError(500, 'levelDB_went_went_bad', 'unknown');\nvar FORBIDDEN = new PouchError(403, 'forbidden', 'Forbidden by design doc validate_doc_update function');\nvar INVALID_REV = new PouchError(400, 'bad_request', 'Invalid rev format');\nvar FILE_EXISTS = new PouchError(412, 'file_exists', 'The database could not be created, the file already exists.');\nvar MISSING_STUB = new PouchError(412, 'missing_stub', 'A pre-existing attachment stub wasn\\'t found');\nvar INVALID_URL = new PouchError(413, 'invalid_url', 'Provided URL is invalid');\n\nfunction createError(error, reason) {\n  function CustomPouchError(reason) {\n    // inherit error properties from our parent error manually\n    // so as to allow proper JSON parsing.\n    /* jshint ignore:start */\n    var names = Object.getOwnPropertyNames(error);\n    for (var i = 0, len = names.length; i < len; i++) {\n      if (typeof error[names[i]] !== 'function') {\n        this[names[i]] = error[names[i]];\n      }\n    }\n    /* jshint ignore:end */\n    if (reason !== undefined) {\n      this.reason = reason;\n    }\n  }\n  CustomPouchError.prototype = PouchError.prototype;\n  return new CustomPouchError(reason);\n}\n\nfunction generateErrorFromResponse(err) {\n\n  if (typeof err !== 'object') {\n    var data = err;\n    err = UNKNOWN_ERROR;\n    err.data = data;\n  }\n\n  if ('error' in err && err.error === 'conflict') {\n    err.name = 'conflict';\n    err.status = 409;\n  }\n\n  if (!('name' in err)) {\n    err.name = err.error || 'unknown';\n  }\n\n  if (!('status' in err)) {\n    err.status = 500;\n  }\n\n  if (!('message' in err)) {\n    err.message = err.message || err.reason;\n  }\n\n  return err;\n}\n\nfunction tryFilter(filter, doc, req) {\n  try {\n    return !filter(doc, req);\n  } catch (err) {\n    var msg = 'Filter function threw: ' + err.toString();\n    return createError(BAD_REQUEST, msg);\n  }\n}\n\nfunction filterChange(opts) {\n  var req = {};\n  var hasFilter = opts.filter && typeof opts.filter === 'function';\n  req.query = opts.query_params;\n\n  return function filter(change) {\n    if (!change.doc) {\n      // CSG sends events on the changes feed that don't have documents,\n      // this hack makes a whole lot of existing code robust.\n      change.doc = {};\n    }\n\n    var filterReturn = hasFilter && tryFilter(opts.filter, change.doc, req);\n\n    if (typeof filterReturn === 'object') {\n      return filterReturn;\n    }\n\n    if (filterReturn) {\n      return false;\n    }\n\n    if (!opts.include_docs) {\n      delete change.doc;\n    } else if (!opts.attachments) {\n      for (var att in change.doc._attachments) {\n        /* istanbul ignore else */\n        if (change.doc._attachments.hasOwnProperty(att)) {\n          change.doc._attachments[att].stub = true;\n        }\n      }\n    }\n    return true;\n  };\n}\n\nfunction flatten(arrs) {\n  var res = [];\n  for (var i = 0, len = arrs.length; i < len; i++) {\n    res = res.concat(arrs[i]);\n  }\n  return res;\n}\n\n// shim for Function.prototype.name,\n\n// Determine id an ID is valid\n//   - invalid IDs begin with an underescore that does not begin '_design' or\n//     '_local'\n//   - any other string value is a valid id\n// Returns the specific error object for each case\nfunction invalidIdError(id) {\n  var err;\n  if (!id) {\n    err = createError(MISSING_ID);\n  } else if (typeof id !== 'string') {\n    err = createError(INVALID_ID);\n  } else if (/^_/.test(id) && !(/^_(design|local)/).test(id)) {\n    err = createError(RESERVED_ID);\n  }\n  if (err) {\n    throw err;\n  }\n}\n\n// Checks if a PouchDB object is \"remote\" or not. This is\n\nfunction isRemote(db) {\n  if (typeof db._remote === 'boolean') {\n    return db._remote;\n  }\n  /* istanbul ignore next */\n  if (typeof db.type === 'function') {\n    guardedConsole('warn',\n      'db.type() is deprecated and will be removed in ' +\n      'a future version of PouchDB');\n    return db.type() === 'http';\n  }\n  /* istanbul ignore next */\n  return false;\n}\n\nfunction listenerCount(ee, type) {\n  return 'listenerCount' in ee ? ee.listenerCount(type) :\n                                 EE.listenerCount(ee, type);\n}\n\nfunction parseDesignDocFunctionName(s) {\n  if (!s) {\n    return null;\n  }\n  var parts = s.split('/');\n  if (parts.length === 2) {\n    return parts;\n  }\n  if (parts.length === 1) {\n    return [s, s];\n  }\n  return null;\n}\n\nfunction normalizeDesignDocFunctionName(s) {\n  var normalized = parseDesignDocFunctionName(s);\n  return normalized ? normalized.join('/') : null;\n}\n\n// originally parseUri 1.2.2, now patched by us\n// (c) Steven Levithan <stevenlevithan.com>\n// MIT License\nvar keys = [\"source\", \"protocol\", \"authority\", \"userInfo\", \"user\", \"password\",\n    \"host\", \"port\", \"relative\", \"path\", \"directory\", \"file\", \"query\", \"anchor\"];\nvar qName =\"queryKey\";\nvar qParser = /(?:^|&)([^&=]*)=?([^&]*)/g;\n\n// use the \"loose\" parser\n/* eslint maxlen: 0, no-useless-escape: 0 */\nvar parser = /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\n\nfunction parseUri(str) {\n  var m = parser.exec(str);\n  var uri = {};\n  var i = 14;\n\n  while (i--) {\n    var key = keys[i];\n    var value = m[i] || \"\";\n    var encoded = ['user', 'password'].indexOf(key) !== -1;\n    uri[key] = encoded ? decodeURIComponent(value) : value;\n  }\n\n  uri[qName] = {};\n  uri[keys[12]].replace(qParser, function ($0, $1, $2) {\n    if ($1) {\n      uri[qName][$1] = $2;\n    }\n  });\n\n  return uri;\n}\n\n// Based on https://github.com/alexdavid/scope-eval v0.0.3\n// (source: https://unpkg.com/scope-eval@0.0.3/scope_eval.js)\n// This is basically just a wrapper around new Function()\n\nfunction scopeEval(source, scope) {\n  var keys = [];\n  var values = [];\n  for (var key in scope) {\n    if (scope.hasOwnProperty(key)) {\n      keys.push(key);\n      values.push(scope[key]);\n    }\n  }\n  keys.push(source);\n  return Function.apply(null, keys).apply(null, values);\n}\n\n// this is essentially the \"update sugar\" function from daleharvey/pouchdb#1388\n// the diffFun tells us what delta to apply to the doc.  it either returns\n// the doc, or false if it doesn't need to do an update after all\nfunction upsert(db, docId, diffFun) {\n  return new Promise(function (fulfill, reject) {\n    db.get(docId, function (err, doc) {\n      if (err) {\n        /* istanbul ignore next */\n        if (err.status !== 404) {\n          return reject(err);\n        }\n        doc = {};\n      }\n\n      // the user might change the _rev, so save it for posterity\n      var docRev = doc._rev;\n      var newDoc = diffFun(doc);\n\n      if (!newDoc) {\n        // if the diffFun returns falsy, we short-circuit as\n        // an optimization\n        return fulfill({updated: false, rev: docRev});\n      }\n\n      // users aren't allowed to modify these values,\n      // so reset them here\n      newDoc._id = docId;\n      newDoc._rev = docRev;\n      fulfill(tryAndPut(db, newDoc, diffFun));\n    });\n  });\n}\n\nfunction tryAndPut(db, doc, diffFun) {\n  return db.put(doc).then(function (res) {\n    return {\n      updated: true,\n      rev: res.rev\n    };\n  }, function (err) {\n    /* istanbul ignore next */\n    if (err.status !== 409) {\n      throw err;\n    }\n    return upsert(db, doc._id, diffFun);\n  });\n}\n\nvar thisAtob = function (str) {\n  return atob(str);\n};\n\nvar thisBtoa = function (str) {\n  return btoa(str);\n};\n\n// Abstracts constructing a Blob object, so it also works in older\n// browsers that don't support the native Blob constructor (e.g.\n// old QtWebKit versions, Android < 4.4).\nfunction createBlob(parts, properties) {\n  /* global BlobBuilder,MSBlobBuilder,MozBlobBuilder,WebKitBlobBuilder */\n  parts = parts || [];\n  properties = properties || {};\n  try {\n    return new Blob(parts, properties);\n  } catch (e) {\n    if (e.name !== \"TypeError\") {\n      throw e;\n    }\n    var Builder = typeof BlobBuilder !== 'undefined' ? BlobBuilder :\n                  typeof MSBlobBuilder !== 'undefined' ? MSBlobBuilder :\n                  typeof MozBlobBuilder !== 'undefined' ? MozBlobBuilder :\n                  WebKitBlobBuilder;\n    var builder = new Builder();\n    for (var i = 0; i < parts.length; i += 1) {\n      builder.append(parts[i]);\n    }\n    return builder.getBlob(properties.type);\n  }\n}\n\n// From http://stackoverflow.com/questions/14967647/ (continues on next line)\n// encode-decode-image-with-base64-breaks-image (2013-04-21)\nfunction binaryStringToArrayBuffer(bin) {\n  var length = bin.length;\n  var buf = new ArrayBuffer(length);\n  var arr = new Uint8Array(buf);\n  for (var i = 0; i < length; i++) {\n    arr[i] = bin.charCodeAt(i);\n  }\n  return buf;\n}\n\nfunction binStringToBluffer(binString, type) {\n  return createBlob([binaryStringToArrayBuffer(binString)], {type: type});\n}\n\nfunction b64ToBluffer(b64, type) {\n  return binStringToBluffer(thisAtob(b64), type);\n}\n\n//Can't find original post, but this is close\n//http://stackoverflow.com/questions/6965107/ (continues on next line)\n//converting-between-strings-and-arraybuffers\nfunction arrayBufferToBinaryString(buffer) {\n  var binary = '';\n  var bytes = new Uint8Array(buffer);\n  var length = bytes.byteLength;\n  for (var i = 0; i < length; i++) {\n    binary += String.fromCharCode(bytes[i]);\n  }\n  return binary;\n}\n\n// shim for browsers that don't support it\nfunction readAsBinaryString(blob, callback) {\n  var reader = new FileReader();\n  var hasBinaryString = typeof reader.readAsBinaryString === 'function';\n  reader.onloadend = function (e) {\n    var result = e.target.result || '';\n    if (hasBinaryString) {\n      return callback(result);\n    }\n    callback(arrayBufferToBinaryString(result));\n  };\n  if (hasBinaryString) {\n    reader.readAsBinaryString(blob);\n  } else {\n    reader.readAsArrayBuffer(blob);\n  }\n}\n\nfunction blobToBinaryString(blobOrBuffer, callback) {\n  readAsBinaryString(blobOrBuffer, function (bin) {\n    callback(bin);\n  });\n}\n\nfunction blobToBase64(blobOrBuffer, callback) {\n  blobToBinaryString(blobOrBuffer, function (base64) {\n    callback(thisBtoa(base64));\n  });\n}\n\n// simplified API. universal browser support is assumed\nfunction readAsArrayBuffer(blob, callback) {\n  var reader = new FileReader();\n  reader.onloadend = function (e) {\n    var result = e.target.result || new ArrayBuffer(0);\n    callback(result);\n  };\n  reader.readAsArrayBuffer(blob);\n}\n\n// this is not used in the browser\n\nvar setImmediateShim = self.setImmediate || self.setTimeout;\nvar MD5_CHUNK_SIZE = 32768;\n\nfunction rawToBase64(raw) {\n  return thisBtoa(raw);\n}\n\nfunction sliceBlob(blob, start, end) {\n  if (blob.webkitSlice) {\n    return blob.webkitSlice(start, end);\n  }\n  return blob.slice(start, end);\n}\n\nfunction appendBlob(buffer, blob, start, end, callback) {\n  if (start > 0 || end < blob.size) {\n    // only slice blob if we really need to\n    blob = sliceBlob(blob, start, end);\n  }\n  readAsArrayBuffer(blob, function (arrayBuffer) {\n    buffer.append(arrayBuffer);\n    callback();\n  });\n}\n\nfunction appendString(buffer, string, start, end, callback) {\n  if (start > 0 || end < string.length) {\n    // only create a substring if we really need to\n    string = string.substring(start, end);\n  }\n  buffer.appendBinary(string);\n  callback();\n}\n\nfunction binaryMd5(data, callback) {\n  var inputIsString = typeof data === 'string';\n  var len = inputIsString ? data.length : data.size;\n  var chunkSize = Math.min(MD5_CHUNK_SIZE, len);\n  var chunks = Math.ceil(len / chunkSize);\n  var currentChunk = 0;\n  var buffer = inputIsString ? new Md5() : new Md5.ArrayBuffer();\n\n  var append = inputIsString ? appendString : appendBlob;\n\n  function next() {\n    setImmediateShim(loadNextChunk);\n  }\n\n  function done() {\n    var raw = buffer.end(true);\n    var base64 = rawToBase64(raw);\n    callback(base64);\n    buffer.destroy();\n  }\n\n  function loadNextChunk() {\n    var start = currentChunk * chunkSize;\n    var end = start + chunkSize;\n    currentChunk++;\n    if (currentChunk < chunks) {\n      append(buffer, data, start, end, next);\n    } else {\n      append(buffer, data, start, end, done);\n    }\n  }\n  loadNextChunk();\n}\n\nfunction stringMd5(string) {\n  return Md5.hash(string);\n}\n\nfunction rev(doc, deterministic_revs) {\n  var clonedDoc = clone(doc);\n  if (!deterministic_revs) {\n    return v4().replace(/-/g, '').toLowerCase();\n  }\n\n  delete clonedDoc._rev_tree;\n  return stringMd5(JSON.stringify(clonedDoc));\n}\n\nvar uuid = v4; // mimic old import, only v4 is ever used elsewhere\n\n// We fetch all leafs of the revision tree, and sort them based on tree length\n// and whether they were deleted, undeleted documents with the longest revision\n// tree (most edits) win\n// The final sort algorithm is slightly documented in a sidebar here:\n// http://guide.couchdb.org/draft/conflicts.html\nfunction winningRev(metadata) {\n  var winningId;\n  var winningPos;\n  var winningDeleted;\n  var toVisit = metadata.rev_tree.slice();\n  var node;\n  while ((node = toVisit.pop())) {\n    var tree = node.ids;\n    var branches = tree[2];\n    var pos = node.pos;\n    if (branches.length) { // non-leaf\n      for (var i = 0, len = branches.length; i < len; i++) {\n        toVisit.push({pos: pos + 1, ids: branches[i]});\n      }\n      continue;\n    }\n    var deleted = !!tree[1].deleted;\n    var id = tree[0];\n    // sort by deleted, then pos, then id\n    if (!winningId || (winningDeleted !== deleted ? winningDeleted :\n        winningPos !== pos ? winningPos < pos : winningId < id)) {\n      winningId = id;\n      winningPos = pos;\n      winningDeleted = deleted;\n    }\n  }\n\n  return winningPos + '-' + winningId;\n}\n\n// Pretty much all below can be combined into a higher order function to\n// traverse revisions\n// The return value from the callback will be passed as context to all\n// children of that node\nfunction traverseRevTree(revs, callback) {\n  var toVisit = revs.slice();\n\n  var node;\n  while ((node = toVisit.pop())) {\n    var pos = node.pos;\n    var tree = node.ids;\n    var branches = tree[2];\n    var newCtx =\n      callback(branches.length === 0, pos, tree[0], node.ctx, tree[1]);\n    for (var i = 0, len = branches.length; i < len; i++) {\n      toVisit.push({pos: pos + 1, ids: branches[i], ctx: newCtx});\n    }\n  }\n}\n\nfunction sortByPos(a, b) {\n  return a.pos - b.pos;\n}\n\nfunction collectLeaves(revs) {\n  var leaves = [];\n  traverseRevTree(revs, function (isLeaf, pos, id, acc, opts) {\n    if (isLeaf) {\n      leaves.push({rev: pos + \"-\" + id, pos: pos, opts: opts});\n    }\n  });\n  leaves.sort(sortByPos).reverse();\n  for (var i = 0, len = leaves.length; i < len; i++) {\n    delete leaves[i].pos;\n  }\n  return leaves;\n}\n\n// returns revs of all conflicts that is leaves such that\n// 1. are not deleted and\n// 2. are different than winning revision\nfunction collectConflicts(metadata) {\n  var win = winningRev(metadata);\n  var leaves = collectLeaves(metadata.rev_tree);\n  var conflicts = [];\n  for (var i = 0, len = leaves.length; i < len; i++) {\n    var leaf = leaves[i];\n    if (leaf.rev !== win && !leaf.opts.deleted) {\n      conflicts.push(leaf.rev);\n    }\n  }\n  return conflicts;\n}\n\n// compact a tree by marking its non-leafs as missing,\n// and return a list of revs to delete\nfunction compactTree(metadata) {\n  var revs = [];\n  traverseRevTree(metadata.rev_tree, function (isLeaf, pos,\n                                               revHash, ctx, opts) {\n    if (opts.status === 'available' && !isLeaf) {\n      revs.push(pos + '-' + revHash);\n      opts.status = 'missing';\n    }\n  });\n  return revs;\n}\n\n// build up a list of all the paths to the leafs in this revision tree\nfunction rootToLeaf(revs) {\n  var paths = [];\n  var toVisit = revs.slice();\n  var node;\n  while ((node = toVisit.pop())) {\n    var pos = node.pos;\n    var tree = node.ids;\n    var id = tree[0];\n    var opts = tree[1];\n    var branches = tree[2];\n    var isLeaf = branches.length === 0;\n\n    var history = node.history ? node.history.slice() : [];\n    history.push({id: id, opts: opts});\n    if (isLeaf) {\n      paths.push({pos: (pos + 1 - history.length), ids: history});\n    }\n    for (var i = 0, len = branches.length; i < len; i++) {\n      toVisit.push({pos: pos + 1, ids: branches[i], history: history});\n    }\n  }\n  return paths.reverse();\n}\n\n// for a better overview of what this is doing, read:\n\nfunction sortByPos$1(a, b) {\n  return a.pos - b.pos;\n}\n\n// classic binary search\nfunction binarySearch(arr, item, comparator) {\n  var low = 0;\n  var high = arr.length;\n  var mid;\n  while (low < high) {\n    mid = (low + high) >>> 1;\n    if (comparator(arr[mid], item) < 0) {\n      low = mid + 1;\n    } else {\n      high = mid;\n    }\n  }\n  return low;\n}\n\n// assuming the arr is sorted, insert the item in the proper place\nfunction insertSorted(arr, item, comparator) {\n  var idx = binarySearch(arr, item, comparator);\n  arr.splice(idx, 0, item);\n}\n\n// Turn a path as a flat array into a tree with a single branch.\n// If any should be stemmed from the beginning of the array, that's passed\n// in as the second argument\nfunction pathToTree(path, numStemmed) {\n  var root;\n  var leaf;\n  for (var i = numStemmed, len = path.length; i < len; i++) {\n    var node = path[i];\n    var currentLeaf = [node.id, node.opts, []];\n    if (leaf) {\n      leaf[2].push(currentLeaf);\n      leaf = currentLeaf;\n    } else {\n      root = leaf = currentLeaf;\n    }\n  }\n  return root;\n}\n\n// compare the IDs of two trees\nfunction compareTree(a, b) {\n  return a[0] < b[0] ? -1 : 1;\n}\n\n// Merge two trees together\n// The roots of tree1 and tree2 must be the same revision\nfunction mergeTree(in_tree1, in_tree2) {\n  var queue = [{tree1: in_tree1, tree2: in_tree2}];\n  var conflicts = false;\n  while (queue.length > 0) {\n    var item = queue.pop();\n    var tree1 = item.tree1;\n    var tree2 = item.tree2;\n\n    if (tree1[1].status || tree2[1].status) {\n      tree1[1].status =\n        (tree1[1].status ===  'available' ||\n        tree2[1].status === 'available') ? 'available' : 'missing';\n    }\n\n    for (var i = 0; i < tree2[2].length; i++) {\n      if (!tree1[2][0]) {\n        conflicts = 'new_leaf';\n        tree1[2][0] = tree2[2][i];\n        continue;\n      }\n\n      var merged = false;\n      for (var j = 0; j < tree1[2].length; j++) {\n        if (tree1[2][j][0] === tree2[2][i][0]) {\n          queue.push({tree1: tree1[2][j], tree2: tree2[2][i]});\n          merged = true;\n        }\n      }\n      if (!merged) {\n        conflicts = 'new_branch';\n        insertSorted(tree1[2], tree2[2][i], compareTree);\n      }\n    }\n  }\n  return {conflicts: conflicts, tree: in_tree1};\n}\n\nfunction doMerge(tree, path, dontExpand) {\n  var restree = [];\n  var conflicts = false;\n  var merged = false;\n  var res;\n\n  if (!tree.length) {\n    return {tree: [path], conflicts: 'new_leaf'};\n  }\n\n  for (var i = 0, len = tree.length; i < len; i++) {\n    var branch = tree[i];\n    if (branch.pos === path.pos && branch.ids[0] === path.ids[0]) {\n      // Paths start at the same position and have the same root, so they need\n      // merged\n      res = mergeTree(branch.ids, path.ids);\n      restree.push({pos: branch.pos, ids: res.tree});\n      conflicts = conflicts || res.conflicts;\n      merged = true;\n    } else if (dontExpand !== true) {\n      // The paths start at a different position, take the earliest path and\n      // traverse up until it as at the same point from root as the path we\n      // want to merge.  If the keys match we return the longer path with the\n      // other merged After stemming we dont want to expand the trees\n\n      var t1 = branch.pos < path.pos ? branch : path;\n      var t2 = branch.pos < path.pos ? path : branch;\n      var diff = t2.pos - t1.pos;\n\n      var candidateParents = [];\n\n      var trees = [];\n      trees.push({ids: t1.ids, diff: diff, parent: null, parentIdx: null});\n      while (trees.length > 0) {\n        var item = trees.pop();\n        if (item.diff === 0) {\n          if (item.ids[0] === t2.ids[0]) {\n            candidateParents.push(item);\n          }\n          continue;\n        }\n        var elements = item.ids[2];\n        for (var j = 0, elementsLen = elements.length; j < elementsLen; j++) {\n          trees.push({\n            ids: elements[j],\n            diff: item.diff - 1,\n            parent: item.ids,\n            parentIdx: j\n          });\n        }\n      }\n\n      var el = candidateParents[0];\n\n      if (!el) {\n        restree.push(branch);\n      } else {\n        res = mergeTree(el.ids, t2.ids);\n        el.parent[2][el.parentIdx] = res.tree;\n        restree.push({pos: t1.pos, ids: t1.ids});\n        conflicts = conflicts || res.conflicts;\n        merged = true;\n      }\n    } else {\n      restree.push(branch);\n    }\n  }\n\n  // We didnt find\n  if (!merged) {\n    restree.push(path);\n  }\n\n  restree.sort(sortByPos$1);\n\n  return {\n    tree: restree,\n    conflicts: conflicts || 'internal_node'\n  };\n}\n\n// To ensure we dont grow the revision tree infinitely, we stem old revisions\nfunction stem(tree, depth) {\n  // First we break out the tree into a complete list of root to leaf paths\n  var paths = rootToLeaf(tree);\n  var stemmedRevs;\n\n  var result;\n  for (var i = 0, len = paths.length; i < len; i++) {\n    // Then for each path, we cut off the start of the path based on the\n    // `depth` to stem to, and generate a new set of flat trees\n    var path = paths[i];\n    var stemmed = path.ids;\n    var node;\n    if (stemmed.length > depth) {\n      // only do the stemming work if we actually need to stem\n      if (!stemmedRevs) {\n        stemmedRevs = {}; // avoid allocating this object unnecessarily\n      }\n      var numStemmed = stemmed.length - depth;\n      node = {\n        pos: path.pos + numStemmed,\n        ids: pathToTree(stemmed, numStemmed)\n      };\n\n      for (var s = 0; s < numStemmed; s++) {\n        var rev = (path.pos + s) + '-' + stemmed[s].id;\n        stemmedRevs[rev] = true;\n      }\n    } else { // no need to actually stem\n      node = {\n        pos: path.pos,\n        ids: pathToTree(stemmed, 0)\n      };\n    }\n\n    // Then we remerge all those flat trees together, ensuring that we dont\n    // connect trees that would go beyond the depth limit\n    if (result) {\n      result = doMerge(result, node, true).tree;\n    } else {\n      result = [node];\n    }\n  }\n\n  // this is memory-heavy per Chrome profiler, avoid unless we actually stemmed\n  if (stemmedRevs) {\n    traverseRevTree(result, function (isLeaf, pos, revHash) {\n      // some revisions may have been removed in a branch but not in another\n      delete stemmedRevs[pos + '-' + revHash];\n    });\n  }\n\n  return {\n    tree: result,\n    revs: stemmedRevs ? Object.keys(stemmedRevs) : []\n  };\n}\n\nfunction merge(tree, path, depth) {\n  var newTree = doMerge(tree, path);\n  var stemmed = stem(newTree.tree, depth);\n  return {\n    tree: stemmed.tree,\n    stemmedRevs: stemmed.revs,\n    conflicts: newTree.conflicts\n  };\n}\n\n// return true if a rev exists in the rev tree, false otherwise\nfunction revExists(revs, rev) {\n  var toVisit = revs.slice();\n  var splitRev = rev.split('-');\n  var targetPos = parseInt(splitRev[0], 10);\n  var targetId = splitRev[1];\n\n  var node;\n  while ((node = toVisit.pop())) {\n    if (node.pos === targetPos && node.ids[0] === targetId) {\n      return true;\n    }\n    var branches = node.ids[2];\n    for (var i = 0, len = branches.length; i < len; i++) {\n      toVisit.push({pos: node.pos + 1, ids: branches[i]});\n    }\n  }\n  return false;\n}\n\nfunction getTrees(node) {\n  return node.ids;\n}\n\n// check if a specific revision of a doc has been deleted\n//  - metadata: the metadata object from the doc store\n//  - rev: (optional) the revision to check. defaults to winning revision\nfunction isDeleted(metadata, rev) {\n  if (!rev) {\n    rev = winningRev(metadata);\n  }\n  var id = rev.substring(rev.indexOf('-') + 1);\n  var toVisit = metadata.rev_tree.map(getTrees);\n\n  var tree;\n  while ((tree = toVisit.pop())) {\n    if (tree[0] === id) {\n      return !!tree[1].deleted;\n    }\n    toVisit = toVisit.concat(tree[2]);\n  }\n}\n\nfunction isLocalId(id) {\n  return (/^_local/).test(id);\n}\n\n// returns the current leaf node for a given revision\nfunction latest(rev, metadata) {\n  var toVisit = metadata.rev_tree.slice();\n  var node;\n  while ((node = toVisit.pop())) {\n    var pos = node.pos;\n    var tree = node.ids;\n    var id = tree[0];\n    var opts = tree[1];\n    var branches = tree[2];\n    var isLeaf = branches.length === 0;\n\n    var history = node.history ? node.history.slice() : [];\n    history.push({id: id, pos: pos, opts: opts});\n\n    if (isLeaf) {\n      for (var i = 0, len = history.length; i < len; i++) {\n        var historyNode = history[i];\n        var historyRev = historyNode.pos + '-' + historyNode.id;\n\n        if (historyRev === rev) {\n          // return the rev of this leaf\n          return pos + '-' + id;\n        }\n      }\n    }\n\n    for (var j = 0, l = branches.length; j < l; j++) {\n      toVisit.push({pos: pos + 1, ids: branches[j], history: history});\n    }\n  }\n\n  /* istanbul ignore next */\n  throw new Error('Unable to resolve latest revision for id ' + metadata.id + ', rev ' + rev);\n}\n\ninherits(Changes$1, EE);\n\nfunction tryCatchInChangeListener(self, change, pending, lastSeq) {\n  // isolate try/catches to avoid V8 deoptimizations\n  try {\n    self.emit('change', change, pending, lastSeq);\n  } catch (e) {\n    guardedConsole('error', 'Error in .on(\"change\", function):', e);\n  }\n}\n\nfunction Changes$1(db, opts, callback) {\n  EE.call(this);\n  var self = this;\n  this.db = db;\n  opts = opts ? clone(opts) : {};\n  var complete = opts.complete = once(function (err, resp) {\n    if (err) {\n      if (listenerCount(self, 'error') > 0) {\n        self.emit('error', err);\n      }\n    } else {\n      self.emit('complete', resp);\n    }\n    self.removeAllListeners();\n    db.removeListener('destroyed', onDestroy);\n  });\n  if (callback) {\n    self.on('complete', function (resp) {\n      callback(null, resp);\n    });\n    self.on('error', callback);\n  }\n  function onDestroy() {\n    self.cancel();\n  }\n  db.once('destroyed', onDestroy);\n\n  opts.onChange = function (change, pending, lastSeq) {\n    /* istanbul ignore if */\n    if (self.isCancelled) {\n      return;\n    }\n    tryCatchInChangeListener(self, change, pending, lastSeq);\n  };\n\n  var promise = new Promise(function (fulfill, reject) {\n    opts.complete = function (err, res) {\n      if (err) {\n        reject(err);\n      } else {\n        fulfill(res);\n      }\n    };\n  });\n  self.once('cancel', function () {\n    db.removeListener('destroyed', onDestroy);\n    opts.complete(null, {status: 'cancelled'});\n  });\n  this.then = promise.then.bind(promise);\n  this['catch'] = promise['catch'].bind(promise);\n  this.then(function (result) {\n    complete(null, result);\n  }, complete);\n\n\n\n  if (!db.taskqueue.isReady) {\n    db.taskqueue.addTask(function (failed) {\n      if (failed) {\n        opts.complete(failed);\n      } else if (self.isCancelled) {\n        self.emit('cancel');\n      } else {\n        self.validateChanges(opts);\n      }\n    });\n  } else {\n    self.validateChanges(opts);\n  }\n}\nChanges$1.prototype.cancel = function () {\n  this.isCancelled = true;\n  if (this.db.taskqueue.isReady) {\n    this.emit('cancel');\n  }\n};\nfunction processChange(doc, metadata, opts) {\n  var changeList = [{rev: doc._rev}];\n  if (opts.style === 'all_docs') {\n    changeList = collectLeaves(metadata.rev_tree)\n    .map(function (x) { return {rev: x.rev}; });\n  }\n  var change = {\n    id: metadata.id,\n    changes: changeList,\n    doc: doc\n  };\n\n  if (isDeleted(metadata, doc._rev)) {\n    change.deleted = true;\n  }\n  if (opts.conflicts) {\n    change.doc._conflicts = collectConflicts(metadata);\n    if (!change.doc._conflicts.length) {\n      delete change.doc._conflicts;\n    }\n  }\n  return change;\n}\n\nChanges$1.prototype.validateChanges = function (opts) {\n  var callback = opts.complete;\n  var self = this;\n\n  /* istanbul ignore else */\n  if (PouchDB._changesFilterPlugin) {\n    PouchDB._changesFilterPlugin.validate(opts, function (err) {\n      if (err) {\n        return callback(err);\n      }\n      self.doChanges(opts);\n    });\n  } else {\n    self.doChanges(opts);\n  }\n};\n\nChanges$1.prototype.doChanges = function (opts) {\n  var self = this;\n  var callback = opts.complete;\n\n  opts = clone(opts);\n  if ('live' in opts && !('continuous' in opts)) {\n    opts.continuous = opts.live;\n  }\n  opts.processChange = processChange;\n\n  if (opts.since === 'latest') {\n    opts.since = 'now';\n  }\n  if (!opts.since) {\n    opts.since = 0;\n  }\n  if (opts.since === 'now') {\n    this.db.info().then(function (info) {\n      /* istanbul ignore if */\n      if (self.isCancelled) {\n        callback(null, {status: 'cancelled'});\n        return;\n      }\n      opts.since = info.update_seq;\n      self.doChanges(opts);\n    }, callback);\n    return;\n  }\n\n  /* istanbul ignore else */\n  if (PouchDB._changesFilterPlugin) {\n    PouchDB._changesFilterPlugin.normalize(opts);\n    if (PouchDB._changesFilterPlugin.shouldFilter(this, opts)) {\n      return PouchDB._changesFilterPlugin.filter(this, opts);\n    }\n  } else {\n    ['doc_ids', 'filter', 'selector', 'view'].forEach(function (key) {\n      if (key in opts) {\n        guardedConsole('warn',\n          'The \"' + key + '\" option was passed in to changes/replicate, ' +\n          'but pouchdb-changes-filter plugin is not installed, so it ' +\n          'was ignored. Please install the plugin to enable filtering.'\n        );\n      }\n    });\n  }\n\n  if (!('descending' in opts)) {\n    opts.descending = false;\n  }\n\n  // 0 and 1 should return 1 document\n  opts.limit = opts.limit === 0 ? 1 : opts.limit;\n  opts.complete = callback;\n  var newPromise = this.db._changes(opts);\n  /* istanbul ignore else */\n  if (newPromise && typeof newPromise.cancel === 'function') {\n    var cancel = self.cancel;\n    self.cancel = getArguments(function (args) {\n      newPromise.cancel();\n      cancel.apply(this, args);\n    });\n  }\n};\n\n/*\n * A generic pouch adapter\n */\n\nfunction compare(left, right) {\n  return left < right ? -1 : left > right ? 1 : 0;\n}\n\n// Wrapper for functions that call the bulkdocs api with a single doc,\n// if the first result is an error, return an error\nfunction yankError(callback, docId) {\n  return function (err, results) {\n    if (err || (results[0] && results[0].error)) {\n      err = err || results[0];\n      err.docId = docId;\n      callback(err);\n    } else {\n      callback(null, results.length ? results[0]  : results);\n    }\n  };\n}\n\n// clean docs given to us by the user\nfunction cleanDocs(docs) {\n  for (var i = 0; i < docs.length; i++) {\n    var doc = docs[i];\n    if (doc._deleted) {\n      delete doc._attachments; // ignore atts for deleted docs\n    } else if (doc._attachments) {\n      // filter out extraneous keys from _attachments\n      var atts = Object.keys(doc._attachments);\n      for (var j = 0; j < atts.length; j++) {\n        var att = atts[j];\n        doc._attachments[att] = pick(doc._attachments[att],\n          ['data', 'digest', 'content_type', 'length', 'revpos', 'stub']);\n      }\n    }\n  }\n}\n\n// compare two docs, first by _id then by _rev\nfunction compareByIdThenRev(a, b) {\n  var idCompare = compare(a._id, b._id);\n  if (idCompare !== 0) {\n    return idCompare;\n  }\n  var aStart = a._revisions ? a._revisions.start : 0;\n  var bStart = b._revisions ? b._revisions.start : 0;\n  return compare(aStart, bStart);\n}\n\n// for every node in a revision tree computes its distance from the closest\n// leaf\nfunction computeHeight(revs) {\n  var height = {};\n  var edges = [];\n  traverseRevTree(revs, function (isLeaf, pos, id, prnt) {\n    var rev$$1 = pos + \"-\" + id;\n    if (isLeaf) {\n      height[rev$$1] = 0;\n    }\n    if (prnt !== undefined) {\n      edges.push({from: prnt, to: rev$$1});\n    }\n    return rev$$1;\n  });\n\n  edges.reverse();\n  edges.forEach(function (edge) {\n    if (height[edge.from] === undefined) {\n      height[edge.from] = 1 + height[edge.to];\n    } else {\n      height[edge.from] = Math.min(height[edge.from], 1 + height[edge.to]);\n    }\n  });\n  return height;\n}\n\nfunction allDocsKeysParse(opts) {\n  var keys =  ('limit' in opts) ?\n    opts.keys.slice(opts.skip, opts.limit + opts.skip) :\n    (opts.skip > 0) ? opts.keys.slice(opts.skip) : opts.keys;\n  opts.keys = keys;\n  opts.skip = 0;\n  delete opts.limit;\n  if (opts.descending) {\n    keys.reverse();\n    opts.descending = false;\n  }\n}\n\n// all compaction is done in a queue, to avoid attaching\n// too many listeners at once\nfunction doNextCompaction(self) {\n  var task = self._compactionQueue[0];\n  var opts = task.opts;\n  var callback = task.callback;\n  self.get('_local/compaction').catch(function () {\n    return false;\n  }).then(function (doc) {\n    if (doc && doc.last_seq) {\n      opts.last_seq = doc.last_seq;\n    }\n    self._compact(opts, function (err, res) {\n      /* istanbul ignore if */\n      if (err) {\n        callback(err);\n      } else {\n        callback(null, res);\n      }\n      immediate(function () {\n        self._compactionQueue.shift();\n        if (self._compactionQueue.length) {\n          doNextCompaction(self);\n        }\n      });\n    });\n  });\n}\n\nfunction attachmentNameError(name) {\n  if (name.charAt(0) === '_') {\n    return name + ' is not a valid attachment name, attachment ' +\n      'names cannot start with \\'_\\'';\n  }\n  return false;\n}\n\ninherits(AbstractPouchDB, EE);\n\nfunction AbstractPouchDB() {\n  EE.call(this);\n\n  // re-bind prototyped methods\n  for (var p in AbstractPouchDB.prototype) {\n    if (typeof this[p] === 'function') {\n      this[p] = this[p].bind(this);\n    }\n  }\n}\n\nAbstractPouchDB.prototype.post =\n  adapterFun('post', function (doc, opts, callback) {\n  if (typeof opts === 'function') {\n    callback = opts;\n    opts = {};\n  }\n  if (typeof doc !== 'object' || Array.isArray(doc)) {\n    return callback(createError(NOT_AN_OBJECT));\n  }\n  this.bulkDocs({docs: [doc]}, opts, yankError(callback, doc._id));\n});\n\nAbstractPouchDB.prototype.put = adapterFun('put', function (doc, opts, cb) {\n  if (typeof opts === 'function') {\n    cb = opts;\n    opts = {};\n  }\n  if (typeof doc !== 'object' || Array.isArray(doc)) {\n    return cb(createError(NOT_AN_OBJECT));\n  }\n  invalidIdError(doc._id);\n  if (isLocalId(doc._id) && typeof this._putLocal === 'function') {\n    if (doc._deleted) {\n      return this._removeLocal(doc, cb);\n    } else {\n      return this._putLocal(doc, cb);\n    }\n  }\n  var self = this;\n  if (opts.force && doc._rev) {\n    transformForceOptionToNewEditsOption();\n    putDoc(function (err) {\n      var result = err ? null : {ok: true, id: doc._id, rev: doc._rev};\n      cb(err, result);\n    });\n  } else {\n    putDoc(cb);\n  }\n\n  function transformForceOptionToNewEditsOption() {\n    var parts = doc._rev.split('-');\n    var oldRevId = parts[1];\n    var oldRevNum = parseInt(parts[0], 10);\n\n    var newRevNum = oldRevNum + 1;\n    var newRevId = rev();\n\n    doc._revisions = {\n      start: newRevNum,\n      ids: [newRevId, oldRevId]\n    };\n    doc._rev = newRevNum + '-' + newRevId;\n    opts.new_edits = false;\n  }\n  function putDoc(next) {\n    if (typeof self._put === 'function' && opts.new_edits !== false) {\n      self._put(doc, opts, next);\n    } else {\n      self.bulkDocs({docs: [doc]}, opts, yankError(next, doc._id));\n    }\n  }\n});\n\nAbstractPouchDB.prototype.putAttachment =\n  adapterFun('putAttachment', function (docId, attachmentId, rev$$1,\n                                              blob, type) {\n  var api = this;\n  if (typeof type === 'function') {\n    type = blob;\n    blob = rev$$1;\n    rev$$1 = null;\n  }\n  // Lets fix in https://github.com/pouchdb/pouchdb/issues/3267\n  /* istanbul ignore if */\n  if (typeof type === 'undefined') {\n    type = blob;\n    blob = rev$$1;\n    rev$$1 = null;\n  }\n  if (!type) {\n    guardedConsole('warn', 'Attachment', attachmentId, 'on document', docId, 'is missing content_type');\n  }\n\n  function createAttachment(doc) {\n    var prevrevpos = '_rev' in doc ? parseInt(doc._rev, 10) : 0;\n    doc._attachments = doc._attachments || {};\n    doc._attachments[attachmentId] = {\n      content_type: type,\n      data: blob,\n      revpos: ++prevrevpos\n    };\n    return api.put(doc);\n  }\n\n  return api.get(docId).then(function (doc) {\n    if (doc._rev !== rev$$1) {\n      throw createError(REV_CONFLICT);\n    }\n\n    return createAttachment(doc);\n  }, function (err) {\n     // create new doc\n    /* istanbul ignore else */\n    if (err.reason === MISSING_DOC.message) {\n      return createAttachment({_id: docId});\n    } else {\n      throw err;\n    }\n  });\n});\n\nAbstractPouchDB.prototype.removeAttachment =\n  adapterFun('removeAttachment', function (docId, attachmentId, rev$$1,\n                                                 callback) {\n  var self = this;\n  self.get(docId, function (err, obj) {\n    /* istanbul ignore if */\n    if (err) {\n      callback(err);\n      return;\n    }\n    if (obj._rev !== rev$$1) {\n      callback(createError(REV_CONFLICT));\n      return;\n    }\n    /* istanbul ignore if */\n    if (!obj._attachments) {\n      return callback();\n    }\n    delete obj._attachments[attachmentId];\n    if (Object.keys(obj._attachments).length === 0) {\n      delete obj._attachments;\n    }\n    self.put(obj, callback);\n  });\n});\n\nAbstractPouchDB.prototype.remove =\n  adapterFun('remove', function (docOrId, optsOrRev, opts, callback) {\n  var doc;\n  if (typeof optsOrRev === 'string') {\n    // id, rev, opts, callback style\n    doc = {\n      _id: docOrId,\n      _rev: optsOrRev\n    };\n    if (typeof opts === 'function') {\n      callback = opts;\n      opts = {};\n    }\n  } else {\n    // doc, opts, callback style\n    doc = docOrId;\n    if (typeof optsOrRev === 'function') {\n      callback = optsOrRev;\n      opts = {};\n    } else {\n      callback = opts;\n      opts = optsOrRev;\n    }\n  }\n  opts = opts || {};\n  opts.was_delete = true;\n  var newDoc = {_id: doc._id, _rev: (doc._rev || opts.rev)};\n  newDoc._deleted = true;\n  if (isLocalId(newDoc._id) && typeof this._removeLocal === 'function') {\n    return this._removeLocal(doc, callback);\n  }\n  this.bulkDocs({docs: [newDoc]}, opts, yankError(callback, newDoc._id));\n});\n\nAbstractPouchDB.prototype.revsDiff =\n  adapterFun('revsDiff', function (req, opts, callback) {\n  if (typeof opts === 'function') {\n    callback = opts;\n    opts = {};\n  }\n  var ids = Object.keys(req);\n\n  if (!ids.length) {\n    return callback(null, {});\n  }\n\n  var count = 0;\n  var missing = new ExportedMap();\n\n  function addToMissing(id, revId) {\n    if (!missing.has(id)) {\n      missing.set(id, {missing: []});\n    }\n    missing.get(id).missing.push(revId);\n  }\n\n  function processDoc(id, rev_tree) {\n    // Is this fast enough? Maybe we should switch to a set simulated by a map\n    var missingForId = req[id].slice(0);\n    traverseRevTree(rev_tree, function (isLeaf, pos, revHash, ctx,\n      opts) {\n        var rev$$1 = pos + '-' + revHash;\n        var idx = missingForId.indexOf(rev$$1);\n        if (idx === -1) {\n          return;\n        }\n\n        missingForId.splice(idx, 1);\n        /* istanbul ignore if */\n        if (opts.status !== 'available') {\n          addToMissing(id, rev$$1);\n        }\n      });\n\n    // Traversing the tree is synchronous, so now `missingForId` contains\n    // revisions that were not found in the tree\n    missingForId.forEach(function (rev$$1) {\n      addToMissing(id, rev$$1);\n    });\n  }\n\n  ids.map(function (id) {\n    this._getRevisionTree(id, function (err, rev_tree) {\n      if (err && err.status === 404 && err.message === 'missing') {\n        missing.set(id, {missing: req[id]});\n      } else if (err) {\n        /* istanbul ignore next */\n        return callback(err);\n      } else {\n        processDoc(id, rev_tree);\n      }\n\n      if (++count === ids.length) {\n        // convert LazyMap to object\n        var missingObj = {};\n        missing.forEach(function (value, key) {\n          missingObj[key] = value;\n        });\n        return callback(null, missingObj);\n      }\n    });\n  }, this);\n});\n\n// _bulk_get API for faster replication, as described in\n// https://github.com/apache/couchdb-chttpd/pull/33\n// At the \"abstract\" level, it will just run multiple get()s in\n// parallel, because this isn't much of a performance cost\n// for local databases (except the cost of multiple transactions, which is\n// small). The http adapter overrides this in order\n// to do a more efficient single HTTP request.\nAbstractPouchDB.prototype.bulkGet =\n  adapterFun('bulkGet', function (opts, callback) {\n  bulkGet(this, opts, callback);\n});\n\n// compact one document and fire callback\n// by compacting we mean removing all revisions which\n// are further from the leaf in revision tree than max_height\nAbstractPouchDB.prototype.compactDocument =\n  adapterFun('compactDocument', function (docId, maxHeight, callback) {\n  var self = this;\n  this._getRevisionTree(docId, function (err, revTree) {\n    /* istanbul ignore if */\n    if (err) {\n      return callback(err);\n    }\n    var height = computeHeight(revTree);\n    var candidates = [];\n    var revs = [];\n    Object.keys(height).forEach(function (rev$$1) {\n      if (height[rev$$1] > maxHeight) {\n        candidates.push(rev$$1);\n      }\n    });\n\n    traverseRevTree(revTree, function (isLeaf, pos, revHash, ctx, opts) {\n      var rev$$1 = pos + '-' + revHash;\n      if (opts.status === 'available' && candidates.indexOf(rev$$1) !== -1) {\n        revs.push(rev$$1);\n      }\n    });\n    self._doCompaction(docId, revs, callback);\n  });\n});\n\n// compact the whole database using single document\n// compaction\nAbstractPouchDB.prototype.compact =\n  adapterFun('compact', function (opts, callback) {\n  if (typeof opts === 'function') {\n    callback = opts;\n    opts = {};\n  }\n\n  var self = this;\n  opts = opts || {};\n\n  self._compactionQueue = self._compactionQueue || [];\n  self._compactionQueue.push({opts: opts, callback: callback});\n  if (self._compactionQueue.length === 1) {\n    doNextCompaction(self);\n  }\n});\nAbstractPouchDB.prototype._compact = function (opts, callback) {\n  var self = this;\n  var changesOpts = {\n    return_docs: false,\n    last_seq: opts.last_seq || 0\n  };\n  var promises = [];\n\n  function onChange(row) {\n    promises.push(self.compactDocument(row.id, 0));\n  }\n  function onComplete(resp) {\n    var lastSeq = resp.last_seq;\n    Promise.all(promises).then(function () {\n      return upsert(self, '_local/compaction', function deltaFunc(doc) {\n        if (!doc.last_seq || doc.last_seq < lastSeq) {\n          doc.last_seq = lastSeq;\n          return doc;\n        }\n        return false; // somebody else got here first, don't update\n      });\n    }).then(function () {\n      callback(null, {ok: true});\n    }).catch(callback);\n  }\n  self.changes(changesOpts)\n    .on('change', onChange)\n    .on('complete', onComplete)\n    .on('error', callback);\n};\n\n/* Begin api wrappers. Specific functionality to storage belongs in the\n   _[method] */\nAbstractPouchDB.prototype.get = adapterFun('get', function (id, opts, cb) {\n  if (typeof opts === 'function') {\n    cb = opts;\n    opts = {};\n  }\n  if (typeof id !== 'string') {\n    return cb(createError(INVALID_ID));\n  }\n  if (isLocalId(id) && typeof this._getLocal === 'function') {\n    return this._getLocal(id, cb);\n  }\n  var leaves = [], self = this;\n\n  function finishOpenRevs() {\n    var result = [];\n    var count = leaves.length;\n    /* istanbul ignore if */\n    if (!count) {\n      return cb(null, result);\n    }\n\n    // order with open_revs is unspecified\n    leaves.forEach(function (leaf) {\n      self.get(id, {\n        rev: leaf,\n        revs: opts.revs,\n        latest: opts.latest,\n        attachments: opts.attachments,\n        binary: opts.binary\n      }, function (err, doc) {\n        if (!err) {\n          // using latest=true can produce duplicates\n          var existing;\n          for (var i = 0, l = result.length; i < l; i++) {\n            if (result[i].ok && result[i].ok._rev === doc._rev) {\n              existing = true;\n              break;\n            }\n          }\n          if (!existing) {\n            result.push({ok: doc});\n          }\n        } else {\n          result.push({missing: leaf});\n        }\n        count--;\n        if (!count) {\n          cb(null, result);\n        }\n      });\n    });\n  }\n\n  if (opts.open_revs) {\n    if (opts.open_revs === \"all\") {\n      this._getRevisionTree(id, function (err, rev_tree) {\n        /* istanbul ignore if */\n        if (err) {\n          return cb(err);\n        }\n        leaves = collectLeaves(rev_tree).map(function (leaf) {\n          return leaf.rev;\n        });\n        finishOpenRevs();\n      });\n    } else {\n      if (Array.isArray(opts.open_revs)) {\n        leaves = opts.open_revs;\n        for (var i = 0; i < leaves.length; i++) {\n          var l = leaves[i];\n          // looks like it's the only thing couchdb checks\n          if (!(typeof (l) === \"string\" && /^\\d+-/.test(l))) {\n            return cb(createError(INVALID_REV));\n          }\n        }\n        finishOpenRevs();\n      } else {\n        return cb(createError(UNKNOWN_ERROR, 'function_clause'));\n      }\n    }\n    return; // open_revs does not like other options\n  }\n\n  return this._get(id, opts, function (err, result) {\n    if (err) {\n      err.docId = id;\n      return cb(err);\n    }\n\n    var doc = result.doc;\n    var metadata = result.metadata;\n    var ctx = result.ctx;\n\n    if (opts.conflicts) {\n      var conflicts = collectConflicts(metadata);\n      if (conflicts.length) {\n        doc._conflicts = conflicts;\n      }\n    }\n\n    if (isDeleted(metadata, doc._rev)) {\n      doc._deleted = true;\n    }\n\n    if (opts.revs || opts.revs_info) {\n      var splittedRev = doc._rev.split('-');\n      var revNo       = parseInt(splittedRev[0], 10);\n      var revHash     = splittedRev[1];\n\n      var paths = rootToLeaf(metadata.rev_tree);\n      var path = null;\n\n      for (var i = 0; i < paths.length; i++) {\n        var currentPath = paths[i];\n        var hashIndex = currentPath.ids.map(function (x) { return x.id; })\n          .indexOf(revHash);\n        var hashFoundAtRevPos = hashIndex === (revNo - 1);\n\n        if (hashFoundAtRevPos || (!path && hashIndex !== -1)) {\n          path = currentPath;\n        }\n      }\n\n      /* istanbul ignore if */\n      if (!path) {\n        err = new Error('invalid rev tree');\n        err.docId = id;\n        return cb(err);\n      }\n\n      var indexOfRev = path.ids.map(function (x) { return x.id; })\n        .indexOf(doc._rev.split('-')[1]) + 1;\n      var howMany = path.ids.length - indexOfRev;\n      path.ids.splice(indexOfRev, howMany);\n      path.ids.reverse();\n\n      if (opts.revs) {\n        doc._revisions = {\n          start: (path.pos + path.ids.length) - 1,\n          ids: path.ids.map(function (rev$$1) {\n            return rev$$1.id;\n          })\n        };\n      }\n      if (opts.revs_info) {\n        var pos =  path.pos + path.ids.length;\n        doc._revs_info = path.ids.map(function (rev$$1) {\n          pos--;\n          return {\n            rev: pos + '-' + rev$$1.id,\n            status: rev$$1.opts.status\n          };\n        });\n      }\n    }\n\n    if (opts.attachments && doc._attachments) {\n      var attachments = doc._attachments;\n      var count = Object.keys(attachments).length;\n      if (count === 0) {\n        return cb(null, doc);\n      }\n      Object.keys(attachments).forEach(function (key) {\n        this._getAttachment(doc._id, key, attachments[key], {\n          // Previously the revision handling was done in adapter.js\n          // getAttachment, however since idb-next doesnt we need to\n          // pass the rev through\n          rev: doc._rev,\n          binary: opts.binary,\n          ctx: ctx\n        }, function (err, data) {\n          var att = doc._attachments[key];\n          att.data = data;\n          delete att.stub;\n          delete att.length;\n          if (!--count) {\n            cb(null, doc);\n          }\n        });\n      }, self);\n    } else {\n      if (doc._attachments) {\n        for (var key in doc._attachments) {\n          /* istanbul ignore else */\n          if (doc._attachments.hasOwnProperty(key)) {\n            doc._attachments[key].stub = true;\n          }\n        }\n      }\n      cb(null, doc);\n    }\n  });\n});\n\n// TODO: I dont like this, it forces an extra read for every\n// attachment read and enforces a confusing api between\n// adapter.js and the adapter implementation\nAbstractPouchDB.prototype.getAttachment =\n  adapterFun('getAttachment', function (docId, attachmentId, opts, callback) {\n  var self = this;\n  if (opts instanceof Function) {\n    callback = opts;\n    opts = {};\n  }\n  this._get(docId, opts, function (err, res) {\n    if (err) {\n      return callback(err);\n    }\n    if (res.doc._attachments && res.doc._attachments[attachmentId]) {\n      opts.ctx = res.ctx;\n      opts.binary = true;\n      self._getAttachment(docId, attachmentId,\n                          res.doc._attachments[attachmentId], opts, callback);\n    } else {\n      return callback(createError(MISSING_DOC));\n    }\n  });\n});\n\nAbstractPouchDB.prototype.allDocs =\n  adapterFun('allDocs', function (opts, callback) {\n  if (typeof opts === 'function') {\n    callback = opts;\n    opts = {};\n  }\n  opts.skip = typeof opts.skip !== 'undefined' ? opts.skip : 0;\n  if (opts.start_key) {\n    opts.startkey = opts.start_key;\n  }\n  if (opts.end_key) {\n    opts.endkey = opts.end_key;\n  }\n  if ('keys' in opts) {\n    if (!Array.isArray(opts.keys)) {\n      return callback(new TypeError('options.keys must be an array'));\n    }\n    var incompatibleOpt =\n      ['startkey', 'endkey', 'key'].filter(function (incompatibleOpt) {\n      return incompatibleOpt in opts;\n    })[0];\n    if (incompatibleOpt) {\n      callback(createError(QUERY_PARSE_ERROR,\n        'Query parameter `' + incompatibleOpt +\n        '` is not compatible with multi-get'\n      ));\n      return;\n    }\n    if (!isRemote(this)) {\n      allDocsKeysParse(opts);\n      if (opts.keys.length === 0) {\n        return this._allDocs({limit: 0}, callback);\n      }\n    }\n  }\n\n  return this._allDocs(opts, callback);\n});\n\nAbstractPouchDB.prototype.changes = function (opts, callback) {\n  if (typeof opts === 'function') {\n    callback = opts;\n    opts = {};\n  }\n\n  opts = opts || {};\n\n  // By default set return_docs to false if the caller has opts.live = true,\n  // this will prevent us from collecting the set of changes indefinitely\n  // resulting in growing memory\n  opts.return_docs = ('return_docs' in opts) ? opts.return_docs : !opts.live;\n\n  return new Changes$1(this, opts, callback);\n};\n\nAbstractPouchDB.prototype.close = adapterFun('close', function (callback) {\n  this._closed = true;\n  this.emit('closed');\n  return this._close(callback);\n});\n\nAbstractPouchDB.prototype.info = adapterFun('info', function (callback) {\n  var self = this;\n  this._info(function (err, info) {\n    if (err) {\n      return callback(err);\n    }\n    // assume we know better than the adapter, unless it informs us\n    info.db_name = info.db_name || self.name;\n    info.auto_compaction = !!(self.auto_compaction && !isRemote(self));\n    info.adapter = self.adapter;\n    callback(null, info);\n  });\n});\n\nAbstractPouchDB.prototype.id = adapterFun('id', function (callback) {\n  return this._id(callback);\n});\n\n/* istanbul ignore next */\nAbstractPouchDB.prototype.type = function () {\n  return (typeof this._type === 'function') ? this._type() : this.adapter;\n};\n\nAbstractPouchDB.prototype.bulkDocs =\n  adapterFun('bulkDocs', function (req, opts, callback) {\n  if (typeof opts === 'function') {\n    callback = opts;\n    opts = {};\n  }\n\n  opts = opts || {};\n\n  if (Array.isArray(req)) {\n    req = {\n      docs: req\n    };\n  }\n\n  if (!req || !req.docs || !Array.isArray(req.docs)) {\n    return callback(createError(MISSING_BULK_DOCS));\n  }\n\n  for (var i = 0; i < req.docs.length; ++i) {\n    if (typeof req.docs[i] !== 'object' || Array.isArray(req.docs[i])) {\n      return callback(createError(NOT_AN_OBJECT));\n    }\n  }\n\n  var attachmentError;\n  req.docs.forEach(function (doc) {\n    if (doc._attachments) {\n      Object.keys(doc._attachments).forEach(function (name) {\n        attachmentError = attachmentError || attachmentNameError(name);\n        if (!doc._attachments[name].content_type) {\n          guardedConsole('warn', 'Attachment', name, 'on document', doc._id, 'is missing content_type');\n        }\n      });\n    }\n  });\n\n  if (attachmentError) {\n    return callback(createError(BAD_REQUEST, attachmentError));\n  }\n\n  if (!('new_edits' in opts)) {\n    if ('new_edits' in req) {\n      opts.new_edits = req.new_edits;\n    } else {\n      opts.new_edits = true;\n    }\n  }\n\n  var adapter = this;\n  if (!opts.new_edits && !isRemote(adapter)) {\n    // ensure revisions of the same doc are sorted, so that\n    // the local adapter processes them correctly (#2935)\n    req.docs.sort(compareByIdThenRev);\n  }\n\n  cleanDocs(req.docs);\n\n  // in the case of conflicts, we want to return the _ids to the user\n  // however, the underlying adapter may destroy the docs array, so\n  // create a copy here\n  var ids = req.docs.map(function (doc) {\n    return doc._id;\n  });\n\n  return this._bulkDocs(req, opts, function (err, res) {\n    if (err) {\n      return callback(err);\n    }\n    if (!opts.new_edits) {\n      // this is what couch does when new_edits is false\n      res = res.filter(function (x) {\n        return x.error;\n      });\n    }\n    // add ids for error/conflict responses (not required for CouchDB)\n    if (!isRemote(adapter)) {\n      for (var i = 0, l = res.length; i < l; i++) {\n        res[i].id = res[i].id || ids[i];\n      }\n    }\n\n    callback(null, res);\n  });\n});\n\nAbstractPouchDB.prototype.registerDependentDatabase =\n  adapterFun('registerDependentDatabase', function (dependentDb,\n                                                          callback) {\n  var depDB = new this.constructor(dependentDb, this.__opts);\n\n  function diffFun(doc) {\n    doc.dependentDbs = doc.dependentDbs || {};\n    if (doc.dependentDbs[dependentDb]) {\n      return false; // no update required\n    }\n    doc.dependentDbs[dependentDb] = true;\n    return doc;\n  }\n  upsert(this, '_local/_pouch_dependentDbs', diffFun)\n    .then(function () {\n      callback(null, {db: depDB});\n    }).catch(callback);\n});\n\nAbstractPouchDB.prototype.destroy =\n  adapterFun('destroy', function (opts, callback) {\n\n  if (typeof opts === 'function') {\n    callback = opts;\n    opts = {};\n  }\n\n  var self = this;\n  var usePrefix = 'use_prefix' in self ? self.use_prefix : true;\n\n  function destroyDb() {\n    // call destroy method of the particular adaptor\n    self._destroy(opts, function (err, resp) {\n      if (err) {\n        return callback(err);\n      }\n      self._destroyed = true;\n      self.emit('destroyed');\n      callback(null, resp || { 'ok': true });\n    });\n  }\n\n  if (isRemote(self)) {\n    // no need to check for dependent DBs if it's a remote DB\n    return destroyDb();\n  }\n\n  self.get('_local/_pouch_dependentDbs', function (err, localDoc) {\n    if (err) {\n      /* istanbul ignore if */\n      if (err.status !== 404) {\n        return callback(err);\n      } else { // no dependencies\n        return destroyDb();\n      }\n    }\n    var dependentDbs = localDoc.dependentDbs;\n    var PouchDB = self.constructor;\n    var deletedMap = Object.keys(dependentDbs).map(function (name) {\n      // use_prefix is only false in the browser\n      /* istanbul ignore next */\n      var trueName = usePrefix ?\n        name.replace(new RegExp('^' + PouchDB.prefix), '') : name;\n      return new PouchDB(trueName, self.__opts).destroy();\n    });\n    Promise.all(deletedMap).then(destroyDb, callback);\n  });\n});\n\nfunction TaskQueue() {\n  this.isReady = false;\n  this.failed = false;\n  this.queue = [];\n}\n\nTaskQueue.prototype.execute = function () {\n  var fun;\n  if (this.failed) {\n    while ((fun = this.queue.shift())) {\n      fun(this.failed);\n    }\n  } else {\n    while ((fun = this.queue.shift())) {\n      fun();\n    }\n  }\n};\n\nTaskQueue.prototype.fail = function (err) {\n  this.failed = err;\n  this.execute();\n};\n\nTaskQueue.prototype.ready = function (db) {\n  this.isReady = true;\n  this.db = db;\n  this.execute();\n};\n\nTaskQueue.prototype.addTask = function (fun) {\n  this.queue.push(fun);\n  if (this.failed) {\n    this.execute();\n  }\n};\n\nfunction parseAdapter(name, opts) {\n  var match = name.match(/([a-z-]*):\\/\\/(.*)/);\n  if (match) {\n    // the http adapter expects the fully qualified name\n    return {\n      name: /https?/.test(match[1]) ? match[1] + '://' + match[2] : match[2],\n      adapter: match[1]\n    };\n  }\n\n  var adapters = PouchDB.adapters;\n  var preferredAdapters = PouchDB.preferredAdapters;\n  var prefix = PouchDB.prefix;\n  var adapterName = opts.adapter;\n\n  if (!adapterName) { // automatically determine adapter\n    for (var i = 0; i < preferredAdapters.length; ++i) {\n      adapterName = preferredAdapters[i];\n      // check for browsers that have been upgraded from websql-only to websql+idb\n      /* istanbul ignore if */\n      if (adapterName === 'idb' && 'websql' in adapters &&\n          hasLocalStorage() && localStorage['_pouch__websqldb_' + prefix + name]) {\n        // log it, because this can be confusing during development\n        guardedConsole('log', 'PouchDB is downgrading \"' + name + '\" to WebSQL to' +\n          ' avoid data loss, because it was already opened with WebSQL.');\n        continue; // keep using websql to avoid user data loss\n      }\n      break;\n    }\n  }\n\n  var adapter = adapters[adapterName];\n\n  // if adapter is invalid, then an error will be thrown later\n  var usePrefix = (adapter && 'use_prefix' in adapter) ?\n    adapter.use_prefix : true;\n\n  return {\n    name: usePrefix ? (prefix + name) : name,\n    adapter: adapterName\n  };\n}\n\n// OK, so here's the deal. Consider this code:\n//     var db1 = new PouchDB('foo');\n//     var db2 = new PouchDB('foo');\n//     db1.destroy();\n// ^ these two both need to emit 'destroyed' events,\n// as well as the PouchDB constructor itself.\n// So we have one db object (whichever one got destroy() called on it)\n// responsible for emitting the initial event, which then gets emitted\n// by the constructor, which then broadcasts it to any other dbs\n// that may have been created with the same name.\nfunction prepareForDestruction(self) {\n\n  function onDestroyed(from_constructor) {\n    self.removeListener('closed', onClosed);\n    if (!from_constructor) {\n      self.constructor.emit('destroyed', self.name);\n    }\n  }\n\n  function onClosed() {\n    self.removeListener('destroyed', onDestroyed);\n    self.constructor.emit('unref', self);\n  }\n\n  self.once('destroyed', onDestroyed);\n  self.once('closed', onClosed);\n  self.constructor.emit('ref', self);\n}\n\ninherits(PouchDB, AbstractPouchDB);\nfunction PouchDB(name, opts) {\n  // In Node our test suite only tests this for PouchAlt unfortunately\n  /* istanbul ignore if */\n  if (!(this instanceof PouchDB)) {\n    return new PouchDB(name, opts);\n  }\n\n  var self = this;\n  opts = opts || {};\n\n  if (name && typeof name === 'object') {\n    opts = name;\n    name = opts.name;\n    delete opts.name;\n  }\n\n  if (opts.deterministic_revs === undefined) {\n    opts.deterministic_revs = true;\n  }\n\n  this.__opts = opts = clone(opts);\n\n  self.auto_compaction = opts.auto_compaction;\n  self.prefix = PouchDB.prefix;\n\n  if (typeof name !== 'string') {\n    throw new Error('Missing/invalid DB name');\n  }\n\n  var prefixedName = (opts.prefix || '') + name;\n  var backend = parseAdapter(prefixedName, opts);\n\n  opts.name = backend.name;\n  opts.adapter = opts.adapter || backend.adapter;\n\n  self.name = name;\n  self._adapter = opts.adapter;\n  PouchDB.emit('debug', ['adapter', 'Picked adapter: ', opts.adapter]);\n\n  if (!PouchDB.adapters[opts.adapter] ||\n      !PouchDB.adapters[opts.adapter].valid()) {\n    throw new Error('Invalid Adapter: ' + opts.adapter);\n  }\n\n  AbstractPouchDB.call(self);\n  self.taskqueue = new TaskQueue();\n\n  self.adapter = opts.adapter;\n\n  PouchDB.adapters[opts.adapter].call(self, opts, function (err) {\n    if (err) {\n      return self.taskqueue.fail(err);\n    }\n    prepareForDestruction(self);\n\n    self.emit('created', self);\n    PouchDB.emit('created', self.name);\n    self.taskqueue.ready(self);\n  });\n\n}\n\n// AbortController was introduced quite a while after fetch and\n// isnt required for PouchDB to function so polyfill if needed\nvar a = (typeof AbortController !== 'undefined')\n    ? AbortController\n    : function () { return {abort: function () {}}; };\n\nvar f$1 = fetch;\nvar h = Headers;\n\nPouchDB.adapters = {};\nPouchDB.preferredAdapters = [];\n\nPouchDB.prefix = '_pouch_';\n\nvar eventEmitter = new EE();\n\nfunction setUpEventEmitter(Pouch) {\n  Object.keys(EE.prototype).forEach(function (key) {\n    if (typeof EE.prototype[key] === 'function') {\n      Pouch[key] = eventEmitter[key].bind(eventEmitter);\n    }\n  });\n\n  // these are created in constructor.js, and allow us to notify each DB with\n  // the same name that it was destroyed, via the constructor object\n  var destructListeners = Pouch._destructionListeners = new ExportedMap();\n\n  Pouch.on('ref', function onConstructorRef(db) {\n    if (!destructListeners.has(db.name)) {\n      destructListeners.set(db.name, []);\n    }\n    destructListeners.get(db.name).push(db);\n  });\n\n  Pouch.on('unref', function onConstructorUnref(db) {\n    if (!destructListeners.has(db.name)) {\n      return;\n    }\n    var dbList = destructListeners.get(db.name);\n    var pos = dbList.indexOf(db);\n    if (pos < 0) {\n      /* istanbul ignore next */\n      return;\n    }\n    dbList.splice(pos, 1);\n    if (dbList.length > 1) {\n      /* istanbul ignore next */\n      destructListeners.set(db.name, dbList);\n    } else {\n      destructListeners.delete(db.name);\n    }\n  });\n\n  Pouch.on('destroyed', function onConstructorDestroyed(name) {\n    if (!destructListeners.has(name)) {\n      return;\n    }\n    var dbList = destructListeners.get(name);\n    destructListeners.delete(name);\n    dbList.forEach(function (db) {\n      db.emit('destroyed',true);\n    });\n  });\n}\n\nsetUpEventEmitter(PouchDB);\n\nPouchDB.adapter = function (id, obj, addToPreferredAdapters) {\n  /* istanbul ignore else */\n  if (obj.valid()) {\n    PouchDB.adapters[id] = obj;\n    if (addToPreferredAdapters) {\n      PouchDB.preferredAdapters.push(id);\n    }\n  }\n};\n\nPouchDB.plugin = function (obj) {\n  if (typeof obj === 'function') { // function style for plugins\n    obj(PouchDB);\n  } else if (typeof obj !== 'object' || Object.keys(obj).length === 0) {\n    throw new Error('Invalid plugin: got \"' + obj + '\", expected an object or a function');\n  } else {\n    Object.keys(obj).forEach(function (id) { // object style for plugins\n      PouchDB.prototype[id] = obj[id];\n    });\n  }\n  if (this.__defaults) {\n    PouchDB.__defaults = $inject_Object_assign({}, this.__defaults);\n  }\n  return PouchDB;\n};\n\nPouchDB.defaults = function (defaultOpts) {\n  function PouchAlt(name, opts) {\n    if (!(this instanceof PouchAlt)) {\n      return new PouchAlt(name, opts);\n    }\n\n    opts = opts || {};\n\n    if (name && typeof name === 'object') {\n      opts = name;\n      name = opts.name;\n      delete opts.name;\n    }\n\n    opts = $inject_Object_assign({}, PouchAlt.__defaults, opts);\n    PouchDB.call(this, name, opts);\n  }\n\n  inherits(PouchAlt, PouchDB);\n\n  PouchAlt.preferredAdapters = PouchDB.preferredAdapters.slice();\n  Object.keys(PouchDB).forEach(function (key) {\n    if (!(key in PouchAlt)) {\n      PouchAlt[key] = PouchDB[key];\n    }\n  });\n\n  // make default options transitive\n  // https://github.com/pouchdb/pouchdb/issues/5922\n  PouchAlt.__defaults = $inject_Object_assign({}, this.__defaults, defaultOpts);\n\n  return PouchAlt;\n};\n\nPouchDB.fetch = function (url, opts) {\n  return f$1(url, opts);\n};\n\n// managed automatically by set-version.js\nvar version = \"7.2.2\";\n\n// this would just be \"return doc[field]\", but fields\n// can be \"deep\" due to dot notation\nfunction getFieldFromDoc(doc, parsedField) {\n  var value = doc;\n  for (var i = 0, len = parsedField.length; i < len; i++) {\n    var key = parsedField[i];\n    value = value[key];\n    if (!value) {\n      break;\n    }\n  }\n  return value;\n}\n\nfunction compare$1(left, right) {\n  return left < right ? -1 : left > right ? 1 : 0;\n}\n\n// Converts a string in dot notation to an array of its components, with backslash escaping\nfunction parseField(fieldName) {\n  // fields may be deep (e.g. \"foo.bar.baz\"), so parse\n  var fields = [];\n  var current = '';\n  for (var i = 0, len = fieldName.length; i < len; i++) {\n    var ch = fieldName[i];\n    if (ch === '.') {\n      if (i > 0 && fieldName[i - 1] === '\\\\') { // escaped delimiter\n        current = current.substring(0, current.length - 1) + '.';\n      } else { // not escaped, so delimiter\n        fields.push(current);\n        current = '';\n      }\n    } else { // normal character\n      current += ch;\n    }\n  }\n  fields.push(current);\n  return fields;\n}\n\nvar combinationFields = ['$or', '$nor', '$not'];\nfunction isCombinationalField(field) {\n  return combinationFields.indexOf(field) > -1;\n}\n\nfunction getKey(obj) {\n  return Object.keys(obj)[0];\n}\n\nfunction getValue(obj) {\n  return obj[getKey(obj)];\n}\n\n\n// flatten an array of selectors joined by an $and operator\nfunction mergeAndedSelectors(selectors) {\n\n  // sort to ensure that e.g. if the user specified\n  // $and: [{$gt: 'a'}, {$gt: 'b'}], then it's collapsed into\n  // just {$gt: 'b'}\n  var res = {};\n\n  selectors.forEach(function (selector) {\n    Object.keys(selector).forEach(function (field) {\n      var matcher = selector[field];\n      if (typeof matcher !== 'object') {\n        matcher = {$eq: matcher};\n      }\n\n      if (isCombinationalField(field)) {\n        if (matcher instanceof Array) {\n          res[field] = matcher.map(function (m) {\n            return mergeAndedSelectors([m]);\n          });\n        } else {\n          res[field] = mergeAndedSelectors([matcher]);\n        }\n      } else {\n        var fieldMatchers = res[field] = res[field] || {};\n        Object.keys(matcher).forEach(function (operator) {\n          var value = matcher[operator];\n\n          if (operator === '$gt' || operator === '$gte') {\n            return mergeGtGte(operator, value, fieldMatchers);\n          } else if (operator === '$lt' || operator === '$lte') {\n            return mergeLtLte(operator, value, fieldMatchers);\n          } else if (operator === '$ne') {\n            return mergeNe(value, fieldMatchers);\n          } else if (operator === '$eq') {\n            return mergeEq(value, fieldMatchers);\n          }\n          fieldMatchers[operator] = value;\n        });\n      }\n    });\n  });\n\n  return res;\n}\n\n\n\n// collapse logically equivalent gt/gte values\nfunction mergeGtGte(operator, value, fieldMatchers) {\n  if (typeof fieldMatchers.$eq !== 'undefined') {\n    return; // do nothing\n  }\n  if (typeof fieldMatchers.$gte !== 'undefined') {\n    if (operator === '$gte') {\n      if (value > fieldMatchers.$gte) { // more specificity\n        fieldMatchers.$gte = value;\n      }\n    } else { // operator === '$gt'\n      if (value >= fieldMatchers.$gte) { // more specificity\n        delete fieldMatchers.$gte;\n        fieldMatchers.$gt = value;\n      }\n    }\n  } else if (typeof fieldMatchers.$gt !== 'undefined') {\n    if (operator === '$gte') {\n      if (value > fieldMatchers.$gt) { // more specificity\n        delete fieldMatchers.$gt;\n        fieldMatchers.$gte = value;\n      }\n    } else { // operator === '$gt'\n      if (value > fieldMatchers.$gt) { // more specificity\n        fieldMatchers.$gt = value;\n      }\n    }\n  } else {\n    fieldMatchers[operator] = value;\n  }\n}\n\n// collapse logically equivalent lt/lte values\nfunction mergeLtLte(operator, value, fieldMatchers) {\n  if (typeof fieldMatchers.$eq !== 'undefined') {\n    return; // do nothing\n  }\n  if (typeof fieldMatchers.$lte !== 'undefined') {\n    if (operator === '$lte') {\n      if (value < fieldMatchers.$lte) { // more specificity\n        fieldMatchers.$lte = value;\n      }\n    } else { // operator === '$gt'\n      if (value <= fieldMatchers.$lte) { // more specificity\n        delete fieldMatchers.$lte;\n        fieldMatchers.$lt = value;\n      }\n    }\n  } else if (typeof fieldMatchers.$lt !== 'undefined') {\n    if (operator === '$lte') {\n      if (value < fieldMatchers.$lt) { // more specificity\n        delete fieldMatchers.$lt;\n        fieldMatchers.$lte = value;\n      }\n    } else { // operator === '$gt'\n      if (value < fieldMatchers.$lt) { // more specificity\n        fieldMatchers.$lt = value;\n      }\n    }\n  } else {\n    fieldMatchers[operator] = value;\n  }\n}\n\n// combine $ne values into one array\nfunction mergeNe(value, fieldMatchers) {\n  if ('$ne' in fieldMatchers) {\n    // there are many things this could \"not\" be\n    fieldMatchers.$ne.push(value);\n  } else { // doesn't exist yet\n    fieldMatchers.$ne = [value];\n  }\n}\n\n// add $eq into the mix\nfunction mergeEq(value, fieldMatchers) {\n  // these all have less specificity than the $eq\n  // TODO: check for user errors here\n  delete fieldMatchers.$gt;\n  delete fieldMatchers.$gte;\n  delete fieldMatchers.$lt;\n  delete fieldMatchers.$lte;\n  delete fieldMatchers.$ne;\n  fieldMatchers.$eq = value;\n}\n\n//#7458: execute function mergeAndedSelectors on nested $and\nfunction mergeAndedSelectorsNested(obj) {\n    for (var prop in obj) {\n        if (Array.isArray(obj)) {\n            for (var i in obj) {\n                if (obj[i]['$and']) {\n                    obj[i] = mergeAndedSelectors(obj[i]['$and']);\n                }\n            }\n        }\n        var value = obj[prop];\n        if (typeof value === 'object') {\n            mergeAndedSelectorsNested(value); // <- recursive call\n        }\n    }\n    return obj;\n}\n\n//#7458: determine id $and is present in selector (at any level)\nfunction isAndInSelector(obj, isAnd) {\n    for (var prop in obj) {\n        if (prop === '$and') {\n            isAnd = true;\n        }\n        var value = obj[prop];\n        if (typeof value === 'object') {\n            isAnd = isAndInSelector(value, isAnd); // <- recursive call\n        }\n    }\n    return isAnd;\n}\n\n//\n// normalize the selector\n//\nfunction massageSelector(input) {\n  var result = clone(input);\n  var wasAnded = false;\n    //#7458: if $and is present in selector (at any level) merge nested $and\n    if (isAndInSelector(result, false)) {\n        result = mergeAndedSelectorsNested(result);\n        if ('$and' in result) {\n            result = mergeAndedSelectors(result['$and']);\n        }\n        wasAnded = true;\n    }\n\n  ['$or', '$nor'].forEach(function (orOrNor) {\n    if (orOrNor in result) {\n      // message each individual selector\n      // e.g. {foo: 'bar'} becomes {foo: {$eq: 'bar'}}\n      result[orOrNor].forEach(function (subSelector) {\n        var fields = Object.keys(subSelector);\n        for (var i = 0; i < fields.length; i++) {\n          var field = fields[i];\n          var matcher = subSelector[field];\n          if (typeof matcher !== 'object' || matcher === null) {\n            subSelector[field] = {$eq: matcher};\n          }\n        }\n      });\n    }\n  });\n\n  if ('$not' in result) {\n    //This feels a little like forcing, but it will work for now,\n    //I would like to come back to this and make the merging of selectors a little more generic\n    result['$not'] = mergeAndedSelectors([result['$not']]);\n  }\n\n  var fields = Object.keys(result);\n\n  for (var i = 0; i < fields.length; i++) {\n    var field = fields[i];\n    var matcher = result[field];\n\n    if (typeof matcher !== 'object' || matcher === null) {\n      matcher = {$eq: matcher};\n    } else if ('$ne' in matcher && !wasAnded) {\n      // I put these in an array, since there may be more than one\n      // but in the \"mergeAnded\" operation, I already take care of that\n      matcher.$ne = [matcher.$ne];\n    }\n    result[field] = matcher;\n  }\n\n  return result;\n}\n\nfunction pad(str, padWith, upToLength) {\n  var padding = '';\n  var targetLength = upToLength - str.length;\n  /* istanbul ignore next */\n  while (padding.length < targetLength) {\n    padding += padWith;\n  }\n  return padding;\n}\n\nfunction padLeft(str, padWith, upToLength) {\n  var padding = pad(str, padWith, upToLength);\n  return padding + str;\n}\n\nvar MIN_MAGNITUDE = -324; // verified by -Number.MIN_VALUE\nvar MAGNITUDE_DIGITS = 3; // ditto\nvar SEP = ''; // set to '_' for easier debugging \n\nfunction collate(a, b) {\n\n  if (a === b) {\n    return 0;\n  }\n\n  a = normalizeKey(a);\n  b = normalizeKey(b);\n\n  var ai = collationIndex(a);\n  var bi = collationIndex(b);\n  if ((ai - bi) !== 0) {\n    return ai - bi;\n  }\n  switch (typeof a) {\n    case 'number':\n      return a - b;\n    case 'boolean':\n      return a < b ? -1 : 1;\n    case 'string':\n      return stringCollate(a, b);\n  }\n  return Array.isArray(a) ? arrayCollate(a, b) : objectCollate(a, b);\n}\n\n// couch considers null/NaN/Infinity/-Infinity === undefined,\n// for the purposes of mapreduce indexes. also, dates get stringified.\nfunction normalizeKey(key) {\n  switch (typeof key) {\n    case 'undefined':\n      return null;\n    case 'number':\n      if (key === Infinity || key === -Infinity || isNaN(key)) {\n        return null;\n      }\n      return key;\n    case 'object':\n      var origKey = key;\n      if (Array.isArray(key)) {\n        var len = key.length;\n        key = new Array(len);\n        for (var i = 0; i < len; i++) {\n          key[i] = normalizeKey(origKey[i]);\n        }\n      /* istanbul ignore next */\n      } else if (key instanceof Date) {\n        return key.toJSON();\n      } else if (key !== null) { // generic object\n        key = {};\n        for (var k in origKey) {\n          if (origKey.hasOwnProperty(k)) {\n            var val = origKey[k];\n            if (typeof val !== 'undefined') {\n              key[k] = normalizeKey(val);\n            }\n          }\n        }\n      }\n  }\n  return key;\n}\n\nfunction indexify(key) {\n  if (key !== null) {\n    switch (typeof key) {\n      case 'boolean':\n        return key ? 1 : 0;\n      case 'number':\n        return numToIndexableString(key);\n      case 'string':\n        // We've to be sure that key does not contain \\u0000\n        // Do order-preserving replacements:\n        // 0 -> 1, 1\n        // 1 -> 1, 2\n        // 2 -> 2, 2\n        /* eslint-disable no-control-regex */\n        return key\n          .replace(/\\u0002/g, '\\u0002\\u0002')\n          .replace(/\\u0001/g, '\\u0001\\u0002')\n          .replace(/\\u0000/g, '\\u0001\\u0001');\n        /* eslint-enable no-control-regex */\n      case 'object':\n        var isArray = Array.isArray(key);\n        var arr = isArray ? key : Object.keys(key);\n        var i = -1;\n        var len = arr.length;\n        var result = '';\n        if (isArray) {\n          while (++i < len) {\n            result += toIndexableString(arr[i]);\n          }\n        } else {\n          while (++i < len) {\n            var objKey = arr[i];\n            result += toIndexableString(objKey) +\n                toIndexableString(key[objKey]);\n          }\n        }\n        return result;\n    }\n  }\n  return '';\n}\n\n// convert the given key to a string that would be appropriate\n// for lexical sorting, e.g. within a database, where the\n// sorting is the same given by the collate() function.\nfunction toIndexableString(key) {\n  var zero = '\\u0000';\n  key = normalizeKey(key);\n  return collationIndex(key) + SEP + indexify(key) + zero;\n}\n\nfunction parseNumber(str, i) {\n  var originalIdx = i;\n  var num;\n  var zero = str[i] === '1';\n  if (zero) {\n    num = 0;\n    i++;\n  } else {\n    var neg = str[i] === '0';\n    i++;\n    var numAsString = '';\n    var magAsString = str.substring(i, i + MAGNITUDE_DIGITS);\n    var magnitude = parseInt(magAsString, 10) + MIN_MAGNITUDE;\n    /* istanbul ignore next */\n    if (neg) {\n      magnitude = -magnitude;\n    }\n    i += MAGNITUDE_DIGITS;\n    while (true) {\n      var ch = str[i];\n      if (ch === '\\u0000') {\n        break;\n      } else {\n        numAsString += ch;\n      }\n      i++;\n    }\n    numAsString = numAsString.split('.');\n    if (numAsString.length === 1) {\n      num = parseInt(numAsString, 10);\n    } else {\n      /* istanbul ignore next */\n      num = parseFloat(numAsString[0] + '.' + numAsString[1]);\n    }\n    /* istanbul ignore next */\n    if (neg) {\n      num = num - 10;\n    }\n    /* istanbul ignore next */\n    if (magnitude !== 0) {\n      // parseFloat is more reliable than pow due to rounding errors\n      // e.g. Number.MAX_VALUE would return Infinity if we did\n      // num * Math.pow(10, magnitude);\n      num = parseFloat(num + 'e' + magnitude);\n    }\n  }\n  return {num: num, length : i - originalIdx};\n}\n\n// move up the stack while parsing\n// this function moved outside of parseIndexableString for performance\nfunction pop(stack, metaStack) {\n  var obj = stack.pop();\n\n  if (metaStack.length) {\n    var lastMetaElement = metaStack[metaStack.length - 1];\n    if (obj === lastMetaElement.element) {\n      // popping a meta-element, e.g. an object whose value is another object\n      metaStack.pop();\n      lastMetaElement = metaStack[metaStack.length - 1];\n    }\n    var element = lastMetaElement.element;\n    var lastElementIndex = lastMetaElement.index;\n    if (Array.isArray(element)) {\n      element.push(obj);\n    } else if (lastElementIndex === stack.length - 2) { // obj with key+value\n      var key = stack.pop();\n      element[key] = obj;\n    } else {\n      stack.push(obj); // obj with key only\n    }\n  }\n}\n\nfunction parseIndexableString(str) {\n  var stack = [];\n  var metaStack = []; // stack for arrays and objects\n  var i = 0;\n\n  /*eslint no-constant-condition: [\"error\", { \"checkLoops\": false }]*/\n  while (true) {\n    var collationIndex = str[i++];\n    if (collationIndex === '\\u0000') {\n      if (stack.length === 1) {\n        return stack.pop();\n      } else {\n        pop(stack, metaStack);\n        continue;\n      }\n    }\n    switch (collationIndex) {\n      case '1':\n        stack.push(null);\n        break;\n      case '2':\n        stack.push(str[i] === '1');\n        i++;\n        break;\n      case '3':\n        var parsedNum = parseNumber(str, i);\n        stack.push(parsedNum.num);\n        i += parsedNum.length;\n        break;\n      case '4':\n        var parsedStr = '';\n        /*eslint no-constant-condition: [\"error\", { \"checkLoops\": false }]*/\n        while (true) {\n          var ch = str[i];\n          if (ch === '\\u0000') {\n            break;\n          }\n          parsedStr += ch;\n          i++;\n        }\n        // perform the reverse of the order-preserving replacement\n        // algorithm (see above)\n        /* eslint-disable no-control-regex */\n        parsedStr = parsedStr.replace(/\\u0001\\u0001/g, '\\u0000')\n          .replace(/\\u0001\\u0002/g, '\\u0001')\n          .replace(/\\u0002\\u0002/g, '\\u0002');\n        /* eslint-enable no-control-regex */\n        stack.push(parsedStr);\n        break;\n      case '5':\n        var arrayElement = { element: [], index: stack.length };\n        stack.push(arrayElement.element);\n        metaStack.push(arrayElement);\n        break;\n      case '6':\n        var objElement = { element: {}, index: stack.length };\n        stack.push(objElement.element);\n        metaStack.push(objElement);\n        break;\n      /* istanbul ignore next */\n      default:\n        throw new Error(\n          'bad collationIndex or unexpectedly reached end of input: ' +\n            collationIndex);\n    }\n  }\n}\n\nfunction arrayCollate(a, b) {\n  var len = Math.min(a.length, b.length);\n  for (var i = 0; i < len; i++) {\n    var sort = collate(a[i], b[i]);\n    if (sort !== 0) {\n      return sort;\n    }\n  }\n  return (a.length === b.length) ? 0 :\n    (a.length > b.length) ? 1 : -1;\n}\nfunction stringCollate(a, b) {\n  // See: https://github.com/daleharvey/pouchdb/issues/40\n  // This is incompatible with the CouchDB implementation, but its the\n  // best we can do for now\n  return (a === b) ? 0 : ((a > b) ? 1 : -1);\n}\nfunction objectCollate(a, b) {\n  var ak = Object.keys(a), bk = Object.keys(b);\n  var len = Math.min(ak.length, bk.length);\n  for (var i = 0; i < len; i++) {\n    // First sort the keys\n    var sort = collate(ak[i], bk[i]);\n    if (sort !== 0) {\n      return sort;\n    }\n    // if the keys are equal sort the values\n    sort = collate(a[ak[i]], b[bk[i]]);\n    if (sort !== 0) {\n      return sort;\n    }\n\n  }\n  return (ak.length === bk.length) ? 0 :\n    (ak.length > bk.length) ? 1 : -1;\n}\n// The collation is defined by erlangs ordered terms\n// the atoms null, true, false come first, then numbers, strings,\n// arrays, then objects\n// null/undefined/NaN/Infinity/-Infinity are all considered null\nfunction collationIndex(x) {\n  var id = ['boolean', 'number', 'string', 'object'];\n  var idx = id.indexOf(typeof x);\n  //false if -1 otherwise true, but fast!!!!1\n  if (~idx) {\n    if (x === null) {\n      return 1;\n    }\n    if (Array.isArray(x)) {\n      return 5;\n    }\n    return idx < 3 ? (idx + 2) : (idx + 3);\n  }\n  /* istanbul ignore next */\n  if (Array.isArray(x)) {\n    return 5;\n  }\n}\n\n// conversion:\n// x yyy zz...zz\n// x = 0 for negative, 1 for 0, 2 for positive\n// y = exponent (for negative numbers negated) moved so that it's >= 0\n// z = mantisse\nfunction numToIndexableString(num) {\n\n  if (num === 0) {\n    return '1';\n  }\n\n  // convert number to exponential format for easier and\n  // more succinct string sorting\n  var expFormat = num.toExponential().split(/e\\+?/);\n  var magnitude = parseInt(expFormat[1], 10);\n\n  var neg = num < 0;\n\n  var result = neg ? '0' : '2';\n\n  // first sort by magnitude\n  // it's easier if all magnitudes are positive\n  var magForComparison = ((neg ? -magnitude : magnitude) - MIN_MAGNITUDE);\n  var magString = padLeft((magForComparison).toString(), '0', MAGNITUDE_DIGITS);\n\n  result += SEP + magString;\n\n  // then sort by the factor\n  var factor = Math.abs(parseFloat(expFormat[0])); // [1..10)\n  /* istanbul ignore next */\n  if (neg) { // for negative reverse ordering\n    factor = 10 - factor;\n  }\n\n  var factorStr = factor.toFixed(20);\n\n  // strip zeros from the end\n  factorStr = factorStr.replace(/\\.?0+$/, '');\n\n  result += SEP + factorStr;\n\n  return result;\n}\n\n// create a comparator based on the sort object\nfunction createFieldSorter(sort) {\n\n  function getFieldValuesAsArray(doc) {\n    return sort.map(function (sorting) {\n      var fieldName = getKey(sorting);\n      var parsedField = parseField(fieldName);\n      var docFieldValue = getFieldFromDoc(doc, parsedField);\n      return docFieldValue;\n    });\n  }\n\n  return function (aRow, bRow) {\n    var aFieldValues = getFieldValuesAsArray(aRow.doc);\n    var bFieldValues = getFieldValuesAsArray(bRow.doc);\n    var collation = collate(aFieldValues, bFieldValues);\n    if (collation !== 0) {\n      return collation;\n    }\n    // this is what mango seems to do\n    return compare$1(aRow.doc._id, bRow.doc._id);\n  };\n}\n\nfunction filterInMemoryFields(rows, requestDef, inMemoryFields) {\n  rows = rows.filter(function (row) {\n    return rowFilter(row.doc, requestDef.selector, inMemoryFields);\n  });\n\n  if (requestDef.sort) {\n    // in-memory sort\n    var fieldSorter = createFieldSorter(requestDef.sort);\n    rows = rows.sort(fieldSorter);\n    if (typeof requestDef.sort[0] !== 'string' &&\n        getValue(requestDef.sort[0]) === 'desc') {\n      rows = rows.reverse();\n    }\n  }\n\n  if ('limit' in requestDef || 'skip' in requestDef) {\n    // have to do the limit in-memory\n    var skip = requestDef.skip || 0;\n    var limit = ('limit' in requestDef ? requestDef.limit : rows.length) + skip;\n    rows = rows.slice(skip, limit);\n  }\n  return rows;\n}\n\nfunction rowFilter(doc, selector, inMemoryFields) {\n  return inMemoryFields.every(function (field) {\n    var matcher = selector[field];\n    var parsedField = parseField(field);\n    var docFieldValue = getFieldFromDoc(doc, parsedField);\n    if (isCombinationalField(field)) {\n      return matchCominationalSelector(field, matcher, doc);\n    }\n\n    return matchSelector(matcher, doc, parsedField, docFieldValue);\n  });\n}\n\nfunction matchSelector(matcher, doc, parsedField, docFieldValue) {\n  if (!matcher) {\n    // no filtering necessary; this field is just needed for sorting\n    return true;\n  }\n\n  // is matcher an object, if so continue recursion\n  if (typeof matcher === 'object') {\n    return Object.keys(matcher).every(function (userOperator) {\n      var userValue = matcher[userOperator];\n      return match(userOperator, doc, userValue, parsedField, docFieldValue);\n    });\n  }\n\n  // no more depth, No need to recurse further\n  return matcher === docFieldValue;\n}\n\nfunction matchCominationalSelector(field, matcher, doc) {\n\n  if (field === '$or') {\n    return matcher.some(function (orMatchers) {\n      return rowFilter(doc, orMatchers, Object.keys(orMatchers));\n    });\n  }\n\n  if (field === '$not') {\n    return !rowFilter(doc, matcher, Object.keys(matcher));\n  }\n\n  //`$nor`\n  return !matcher.find(function (orMatchers) {\n    return rowFilter(doc, orMatchers, Object.keys(orMatchers));\n  });\n\n}\n\nfunction match(userOperator, doc, userValue, parsedField, docFieldValue) {\n  if (!matchers[userOperator]) {\n    throw new Error('unknown operator \"' + userOperator +\n      '\" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, ' +\n      '$nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');\n  }\n  return matchers[userOperator](doc, userValue, parsedField, docFieldValue);\n}\n\nfunction fieldExists(docFieldValue) {\n  return typeof docFieldValue !== 'undefined' && docFieldValue !== null;\n}\n\nfunction fieldIsNotUndefined(docFieldValue) {\n  return typeof docFieldValue !== 'undefined';\n}\n\nfunction modField(docFieldValue, userValue) {\n  var divisor = userValue[0];\n  var mod = userValue[1];\n  if (divisor === 0) {\n    throw new Error('Bad divisor, cannot divide by zero');\n  }\n\n  if (parseInt(divisor, 10) !== divisor ) {\n    throw new Error('Divisor is not an integer');\n  }\n\n  if (parseInt(mod, 10) !== mod ) {\n    throw new Error('Modulus is not an integer');\n  }\n\n  if (parseInt(docFieldValue, 10) !== docFieldValue) {\n    return false;\n  }\n\n  return docFieldValue % divisor === mod;\n}\n\nfunction arrayContainsValue(docFieldValue, userValue) {\n  return userValue.some(function (val) {\n    if (docFieldValue instanceof Array) {\n      return docFieldValue.indexOf(val) > -1;\n    }\n\n    return docFieldValue === val;\n  });\n}\n\nfunction arrayContainsAllValues(docFieldValue, userValue) {\n  return userValue.every(function (val) {\n    return docFieldValue.indexOf(val) > -1;\n  });\n}\n\nfunction arraySize(docFieldValue, userValue) {\n  return docFieldValue.length === userValue;\n}\n\nfunction regexMatch(docFieldValue, userValue) {\n  var re = new RegExp(userValue);\n\n  return re.test(docFieldValue);\n}\n\nfunction typeMatch(docFieldValue, userValue) {\n\n  switch (userValue) {\n    case 'null':\n      return docFieldValue === null;\n    case 'boolean':\n      return typeof (docFieldValue) === 'boolean';\n    case 'number':\n      return typeof (docFieldValue) === 'number';\n    case 'string':\n      return typeof (docFieldValue) === 'string';\n    case 'array':\n      return docFieldValue instanceof Array;\n    case 'object':\n      return ({}).toString.call(docFieldValue) === '[object Object]';\n  }\n\n  throw new Error(userValue + ' not supported as a type.' +\n                  'Please use one of object, string, array, number, boolean or null.');\n\n}\n\nvar matchers = {\n\n  '$elemMatch': function (doc, userValue, parsedField, docFieldValue) {\n    if (!Array.isArray(docFieldValue)) {\n      return false;\n    }\n\n    if (docFieldValue.length === 0) {\n      return false;\n    }\n\n    if (typeof docFieldValue[0] === 'object') {\n      return docFieldValue.some(function (val) {\n        return rowFilter(val, userValue, Object.keys(userValue));\n      });\n    }\n\n    return docFieldValue.some(function (val) {\n      return matchSelector(userValue, doc, parsedField, val);\n    });\n  },\n\n  '$allMatch': function (doc, userValue, parsedField, docFieldValue) {\n    if (!Array.isArray(docFieldValue)) {\n      return false;\n    }\n\n    /* istanbul ignore next */\n    if (docFieldValue.length === 0) {\n      return false;\n    }\n\n    if (typeof docFieldValue[0] === 'object') {\n      return docFieldValue.every(function (val) {\n        return rowFilter(val, userValue, Object.keys(userValue));\n      });\n    }\n\n    return docFieldValue.every(function (val) {\n      return matchSelector(userValue, doc, parsedField, val);\n    });\n  },\n\n  '$eq': function (doc, userValue, parsedField, docFieldValue) {\n    return fieldIsNotUndefined(docFieldValue) && collate(docFieldValue, userValue) === 0;\n  },\n\n  '$gte': function (doc, userValue, parsedField, docFieldValue) {\n    return fieldIsNotUndefined(docFieldValue) && collate(docFieldValue, userValue) >= 0;\n  },\n\n  '$gt': function (doc, userValue, parsedField, docFieldValue) {\n    return fieldIsNotUndefined(docFieldValue) && collate(docFieldValue, userValue) > 0;\n  },\n\n  '$lte': function (doc, userValue, parsedField, docFieldValue) {\n    return fieldIsNotUndefined(docFieldValue) && collate(docFieldValue, userValue) <= 0;\n  },\n\n  '$lt': function (doc, userValue, parsedField, docFieldValue) {\n    return fieldIsNotUndefined(docFieldValue) && collate(docFieldValue, userValue) < 0;\n  },\n\n  '$exists': function (doc, userValue, parsedField, docFieldValue) {\n    //a field that is null is still considered to exist\n    if (userValue) {\n      return fieldIsNotUndefined(docFieldValue);\n    }\n\n    return !fieldIsNotUndefined(docFieldValue);\n  },\n\n  '$mod': function (doc, userValue, parsedField, docFieldValue) {\n    return fieldExists(docFieldValue) && modField(docFieldValue, userValue);\n  },\n\n  '$ne': function (doc, userValue, parsedField, docFieldValue) {\n    return userValue.every(function (neValue) {\n      return collate(docFieldValue, neValue) !== 0;\n    });\n  },\n  '$in': function (doc, userValue, parsedField, docFieldValue) {\n    return fieldExists(docFieldValue) && arrayContainsValue(docFieldValue, userValue);\n  },\n\n  '$nin': function (doc, userValue, parsedField, docFieldValue) {\n    return fieldExists(docFieldValue) && !arrayContainsValue(docFieldValue, userValue);\n  },\n\n  '$size': function (doc, userValue, parsedField, docFieldValue) {\n    return fieldExists(docFieldValue) && arraySize(docFieldValue, userValue);\n  },\n\n  '$all': function (doc, userValue, parsedField, docFieldValue) {\n    return Array.isArray(docFieldValue) && arrayContainsAllValues(docFieldValue, userValue);\n  },\n\n  '$regex': function (doc, userValue, parsedField, docFieldValue) {\n    return fieldExists(docFieldValue) && regexMatch(docFieldValue, userValue);\n  },\n\n  '$type': function (doc, userValue, parsedField, docFieldValue) {\n    return typeMatch(docFieldValue, userValue);\n  }\n};\n\n// return true if the given doc matches the supplied selector\nfunction matchesSelector(doc, selector) {\n  /* istanbul ignore if */\n  if (typeof selector !== 'object') {\n    // match the CouchDB error message\n    throw new Error('Selector error: expected a JSON object');\n  }\n\n  selector = massageSelector(selector);\n  var row = {\n    'doc': doc\n  };\n\n  var rowsMatched = filterInMemoryFields([row], { 'selector': selector }, Object.keys(selector));\n  return rowsMatched && rowsMatched.length === 1;\n}\n\nfunction evalFilter(input) {\n  return scopeEval('\"use strict\";\\nreturn ' + input + ';', {});\n}\n\nfunction evalView(input) {\n  var code = [\n    'return function(doc) {',\n    '  \"use strict\";',\n    '  var emitted = false;',\n    '  var emit = function (a, b) {',\n    '    emitted = true;',\n    '  };',\n    '  var view = ' + input + ';',\n    '  view(doc);',\n    '  if (emitted) {',\n    '    return true;',\n    '  }',\n    '};'\n  ].join('\\n');\n\n  return scopeEval(code, {});\n}\n\nfunction validate(opts, callback) {\n  if (opts.selector) {\n    if (opts.filter && opts.filter !== '_selector') {\n      var filterName = typeof opts.filter === 'string' ?\n        opts.filter : 'function';\n      return callback(new Error('selector invalid for filter \"' + filterName + '\"'));\n    }\n  }\n  callback();\n}\n\nfunction normalize(opts) {\n  if (opts.view && !opts.filter) {\n    opts.filter = '_view';\n  }\n\n  if (opts.selector && !opts.filter) {\n    opts.filter = '_selector';\n  }\n\n  if (opts.filter && typeof opts.filter === 'string') {\n    if (opts.filter === '_view') {\n      opts.view = normalizeDesignDocFunctionName(opts.view);\n    } else {\n      opts.filter = normalizeDesignDocFunctionName(opts.filter);\n    }\n  }\n}\n\nfunction shouldFilter(changesHandler, opts) {\n  return opts.filter && typeof opts.filter === 'string' &&\n    !opts.doc_ids && !isRemote(changesHandler.db);\n}\n\nfunction filter(changesHandler, opts) {\n  var callback = opts.complete;\n  if (opts.filter === '_view') {\n    if (!opts.view || typeof opts.view !== 'string') {\n      var err = createError(BAD_REQUEST,\n        '`view` filter parameter not found or invalid.');\n      return callback(err);\n    }\n    // fetch a view from a design doc, make it behave like a filter\n    var viewName = parseDesignDocFunctionName(opts.view);\n    changesHandler.db.get('_design/' + viewName[0], function (err, ddoc) {\n      /* istanbul ignore if */\n      if (changesHandler.isCancelled) {\n        return callback(null, {status: 'cancelled'});\n      }\n      /* istanbul ignore next */\n      if (err) {\n        return callback(generateErrorFromResponse(err));\n      }\n      var mapFun = ddoc && ddoc.views && ddoc.views[viewName[1]] &&\n        ddoc.views[viewName[1]].map;\n      if (!mapFun) {\n        return callback(createError(MISSING_DOC,\n          (ddoc.views ? 'missing json key: ' + viewName[1] :\n            'missing json key: views')));\n      }\n      opts.filter = evalView(mapFun);\n      changesHandler.doChanges(opts);\n    });\n  } else if (opts.selector) {\n    opts.filter = function (doc) {\n      return matchesSelector(doc, opts.selector);\n    };\n    changesHandler.doChanges(opts);\n  } else {\n    // fetch a filter from a design doc\n    var filterName = parseDesignDocFunctionName(opts.filter);\n    changesHandler.db.get('_design/' + filterName[0], function (err, ddoc) {\n      /* istanbul ignore if */\n      if (changesHandler.isCancelled) {\n        return callback(null, {status: 'cancelled'});\n      }\n      /* istanbul ignore next */\n      if (err) {\n        return callback(generateErrorFromResponse(err));\n      }\n      var filterFun = ddoc && ddoc.filters && ddoc.filters[filterName[1]];\n      if (!filterFun) {\n        return callback(createError(MISSING_DOC,\n          ((ddoc && ddoc.filters) ? 'missing json key: ' + filterName[1]\n            : 'missing json key: filters')));\n      }\n      opts.filter = evalFilter(filterFun);\n      changesHandler.doChanges(opts);\n    });\n  }\n}\n\nfunction applyChangesFilterPlugin(PouchDB) {\n  PouchDB._changesFilterPlugin = {\n    validate: validate,\n    normalize: normalize,\n    shouldFilter: shouldFilter,\n    filter: filter\n  };\n}\n\n// TODO: remove from pouchdb-core (breaking)\nPouchDB.plugin(applyChangesFilterPlugin);\n\nPouchDB.version = version;\n\nfunction toObject(array) {\n  return array.reduce(function (obj, item) {\n    obj[item] = true;\n    return obj;\n  }, {});\n}\n// List of top level reserved words for doc\nvar reservedWords = toObject([\n  '_id',\n  '_rev',\n  '_attachments',\n  '_deleted',\n  '_revisions',\n  '_revs_info',\n  '_conflicts',\n  '_deleted_conflicts',\n  '_local_seq',\n  '_rev_tree',\n  //replication documents\n  '_replication_id',\n  '_replication_state',\n  '_replication_state_time',\n  '_replication_state_reason',\n  '_replication_stats',\n  // Specific to Couchbase Sync Gateway\n  '_removed'\n]);\n\n// List of reserved words that should end up the document\nvar dataWords = toObject([\n  '_attachments',\n  //replication documents\n  '_replication_id',\n  '_replication_state',\n  '_replication_state_time',\n  '_replication_state_reason',\n  '_replication_stats'\n]);\n\nfunction parseRevisionInfo(rev$$1) {\n  if (!/^\\d+-/.test(rev$$1)) {\n    return createError(INVALID_REV);\n  }\n  var idx = rev$$1.indexOf('-');\n  var left = rev$$1.substring(0, idx);\n  var right = rev$$1.substring(idx + 1);\n  return {\n    prefix: parseInt(left, 10),\n    id: right\n  };\n}\n\nfunction makeRevTreeFromRevisions(revisions, opts) {\n  var pos = revisions.start - revisions.ids.length + 1;\n\n  var revisionIds = revisions.ids;\n  var ids = [revisionIds[0], opts, []];\n\n  for (var i = 1, len = revisionIds.length; i < len; i++) {\n    ids = [revisionIds[i], {status: 'missing'}, [ids]];\n  }\n\n  return [{\n    pos: pos,\n    ids: ids\n  }];\n}\n\n// Preprocess documents, parse their revisions, assign an id and a\n// revision for new writes that are missing them, etc\nfunction parseDoc(doc, newEdits, dbOpts) {\n  if (!dbOpts) {\n    dbOpts = {\n      deterministic_revs: true\n    };\n  }\n\n  var nRevNum;\n  var newRevId;\n  var revInfo;\n  var opts = {status: 'available'};\n  if (doc._deleted) {\n    opts.deleted = true;\n  }\n\n  if (newEdits) {\n    if (!doc._id) {\n      doc._id = uuid();\n    }\n    newRevId = rev(doc, dbOpts.deterministic_revs);\n    if (doc._rev) {\n      revInfo = parseRevisionInfo(doc._rev);\n      if (revInfo.error) {\n        return revInfo;\n      }\n      doc._rev_tree = [{\n        pos: revInfo.prefix,\n        ids: [revInfo.id, {status: 'missing'}, [[newRevId, opts, []]]]\n      }];\n      nRevNum = revInfo.prefix + 1;\n    } else {\n      doc._rev_tree = [{\n        pos: 1,\n        ids : [newRevId, opts, []]\n      }];\n      nRevNum = 1;\n    }\n  } else {\n    if (doc._revisions) {\n      doc._rev_tree = makeRevTreeFromRevisions(doc._revisions, opts);\n      nRevNum = doc._revisions.start;\n      newRevId = doc._revisions.ids[0];\n    }\n    if (!doc._rev_tree) {\n      revInfo = parseRevisionInfo(doc._rev);\n      if (revInfo.error) {\n        return revInfo;\n      }\n      nRevNum = revInfo.prefix;\n      newRevId = revInfo.id;\n      doc._rev_tree = [{\n        pos: nRevNum,\n        ids: [newRevId, opts, []]\n      }];\n    }\n  }\n\n  invalidIdError(doc._id);\n\n  doc._rev = nRevNum + '-' + newRevId;\n\n  var result = {metadata : {}, data : {}};\n  for (var key in doc) {\n    /* istanbul ignore else */\n    if (Object.prototype.hasOwnProperty.call(doc, key)) {\n      var specialKey = key[0] === '_';\n      if (specialKey && !reservedWords[key]) {\n        var error = createError(DOC_VALIDATION, key);\n        error.message = DOC_VALIDATION.message + ': ' + key;\n        throw error;\n      } else if (specialKey && !dataWords[key]) {\n        result.metadata[key.slice(1)] = doc[key];\n      } else {\n        result.data[key] = doc[key];\n      }\n    }\n  }\n  return result;\n}\n\nfunction parseBase64(data) {\n  try {\n    return thisAtob(data);\n  } catch (e) {\n    var err = createError(BAD_ARG,\n      'Attachment is not a valid base64 string');\n    return {error: err};\n  }\n}\n\nfunction preprocessString(att, blobType, callback) {\n  var asBinary = parseBase64(att.data);\n  if (asBinary.error) {\n    return callback(asBinary.error);\n  }\n\n  att.length = asBinary.length;\n  if (blobType === 'blob') {\n    att.data = binStringToBluffer(asBinary, att.content_type);\n  } else if (blobType === 'base64') {\n    att.data = thisBtoa(asBinary);\n  } else { // binary\n    att.data = asBinary;\n  }\n  binaryMd5(asBinary, function (result) {\n    att.digest = 'md5-' + result;\n    callback();\n  });\n}\n\nfunction preprocessBlob(att, blobType, callback) {\n  binaryMd5(att.data, function (md5) {\n    att.digest = 'md5-' + md5;\n    // size is for blobs (browser), length is for buffers (node)\n    att.length = att.data.size || att.data.length || 0;\n    if (blobType === 'binary') {\n      blobToBinaryString(att.data, function (binString) {\n        att.data = binString;\n        callback();\n      });\n    } else if (blobType === 'base64') {\n      blobToBase64(att.data, function (b64) {\n        att.data = b64;\n        callback();\n      });\n    } else {\n      callback();\n    }\n  });\n}\n\nfunction preprocessAttachment(att, blobType, callback) {\n  if (att.stub) {\n    return callback();\n  }\n  if (typeof att.data === 'string') { // input is a base64 string\n    preprocessString(att, blobType, callback);\n  } else { // input is a blob\n    preprocessBlob(att, blobType, callback);\n  }\n}\n\nfunction preprocessAttachments(docInfos, blobType, callback) {\n\n  if (!docInfos.length) {\n    return callback();\n  }\n\n  var docv = 0;\n  var overallErr;\n\n  docInfos.forEach(function (docInfo) {\n    var attachments = docInfo.data && docInfo.data._attachments ?\n      Object.keys(docInfo.data._attachments) : [];\n    var recv = 0;\n\n    if (!attachments.length) {\n      return done();\n    }\n\n    function processedAttachment(err) {\n      overallErr = err;\n      recv++;\n      if (recv === attachments.length) {\n        done();\n      }\n    }\n\n    for (var key in docInfo.data._attachments) {\n      if (docInfo.data._attachments.hasOwnProperty(key)) {\n        preprocessAttachment(docInfo.data._attachments[key],\n          blobType, processedAttachment);\n      }\n    }\n  });\n\n  function done() {\n    docv++;\n    if (docInfos.length === docv) {\n      if (overallErr) {\n        callback(overallErr);\n      } else {\n        callback();\n      }\n    }\n  }\n}\n\nfunction updateDoc(revLimit, prev, docInfo, results,\n                   i, cb, writeDoc, newEdits) {\n\n  if (revExists(prev.rev_tree, docInfo.metadata.rev) && !newEdits) {\n    results[i] = docInfo;\n    return cb();\n  }\n\n  // sometimes this is pre-calculated. historically not always\n  var previousWinningRev = prev.winningRev || winningRev(prev);\n  var previouslyDeleted = 'deleted' in prev ? prev.deleted :\n    isDeleted(prev, previousWinningRev);\n  var deleted = 'deleted' in docInfo.metadata ? docInfo.metadata.deleted :\n    isDeleted(docInfo.metadata);\n  var isRoot = /^1-/.test(docInfo.metadata.rev);\n\n  if (previouslyDeleted && !deleted && newEdits && isRoot) {\n    var newDoc = docInfo.data;\n    newDoc._rev = previousWinningRev;\n    newDoc._id = docInfo.metadata.id;\n    docInfo = parseDoc(newDoc, newEdits);\n  }\n\n  var merged = merge(prev.rev_tree, docInfo.metadata.rev_tree[0], revLimit);\n\n  var inConflict = newEdits && ((\n    (previouslyDeleted && deleted && merged.conflicts !== 'new_leaf') ||\n    (!previouslyDeleted && merged.conflicts !== 'new_leaf') ||\n    (previouslyDeleted && !deleted && merged.conflicts === 'new_branch')));\n\n  if (inConflict) {\n    var err = createError(REV_CONFLICT);\n    results[i] = err;\n    return cb();\n  }\n\n  var newRev = docInfo.metadata.rev;\n  docInfo.metadata.rev_tree = merged.tree;\n  docInfo.stemmedRevs = merged.stemmedRevs || [];\n  /* istanbul ignore else */\n  if (prev.rev_map) {\n    docInfo.metadata.rev_map = prev.rev_map; // used only by leveldb\n  }\n\n  // recalculate\n  var winningRev$$1 = winningRev(docInfo.metadata);\n  var winningRevIsDeleted = isDeleted(docInfo.metadata, winningRev$$1);\n\n  // calculate the total number of documents that were added/removed,\n  // from the perspective of total_rows/doc_count\n  var delta = (previouslyDeleted === winningRevIsDeleted) ? 0 :\n    previouslyDeleted < winningRevIsDeleted ? -1 : 1;\n\n  var newRevIsDeleted;\n  if (newRev === winningRev$$1) {\n    // if the new rev is the same as the winning rev, we can reuse that value\n    newRevIsDeleted = winningRevIsDeleted;\n  } else {\n    // if they're not the same, then we need to recalculate\n    newRevIsDeleted = isDeleted(docInfo.metadata, newRev);\n  }\n\n  writeDoc(docInfo, winningRev$$1, winningRevIsDeleted, newRevIsDeleted,\n    true, delta, i, cb);\n}\n\nfunction rootIsMissing(docInfo) {\n  return docInfo.metadata.rev_tree[0].ids[1].status === 'missing';\n}\n\nfunction processDocs(revLimit, docInfos, api, fetchedDocs, tx, results,\n                     writeDoc, opts, overallCallback) {\n\n  // Default to 1000 locally\n  revLimit = revLimit || 1000;\n\n  function insertDoc(docInfo, resultsIdx, callback) {\n    // Cant insert new deleted documents\n    var winningRev$$1 = winningRev(docInfo.metadata);\n    var deleted = isDeleted(docInfo.metadata, winningRev$$1);\n    if ('was_delete' in opts && deleted) {\n      results[resultsIdx] = createError(MISSING_DOC, 'deleted');\n      return callback();\n    }\n\n    // 4712 - detect whether a new document was inserted with a _rev\n    var inConflict = newEdits && rootIsMissing(docInfo);\n\n    if (inConflict) {\n      var err = createError(REV_CONFLICT);\n      results[resultsIdx] = err;\n      return callback();\n    }\n\n    var delta = deleted ? 0 : 1;\n\n    writeDoc(docInfo, winningRev$$1, deleted, deleted, false,\n      delta, resultsIdx, callback);\n  }\n\n  var newEdits = opts.new_edits;\n  var idsToDocs = new ExportedMap();\n\n  var docsDone = 0;\n  var docsToDo = docInfos.length;\n\n  function checkAllDocsDone() {\n    if (++docsDone === docsToDo && overallCallback) {\n      overallCallback();\n    }\n  }\n\n  docInfos.forEach(function (currentDoc, resultsIdx) {\n\n    if (currentDoc._id && isLocalId(currentDoc._id)) {\n      var fun = currentDoc._deleted ? '_removeLocal' : '_putLocal';\n      api[fun](currentDoc, {ctx: tx}, function (err, res) {\n        results[resultsIdx] = err || res;\n        checkAllDocsDone();\n      });\n      return;\n    }\n\n    var id = currentDoc.metadata.id;\n    if (idsToDocs.has(id)) {\n      docsToDo--; // duplicate\n      idsToDocs.get(id).push([currentDoc, resultsIdx]);\n    } else {\n      idsToDocs.set(id, [[currentDoc, resultsIdx]]);\n    }\n  });\n\n  // in the case of new_edits, the user can provide multiple docs\n  // with the same id. these need to be processed sequentially\n  idsToDocs.forEach(function (docs, id) {\n    var numDone = 0;\n\n    function docWritten() {\n      if (++numDone < docs.length) {\n        nextDoc();\n      } else {\n        checkAllDocsDone();\n      }\n    }\n    function nextDoc() {\n      var value = docs[numDone];\n      var currentDoc = value[0];\n      var resultsIdx = value[1];\n\n      if (fetchedDocs.has(id)) {\n        updateDoc(revLimit, fetchedDocs.get(id), currentDoc, results,\n          resultsIdx, docWritten, writeDoc, newEdits);\n      } else {\n        // Ensure stemming applies to new writes as well\n        var merged = merge([], currentDoc.metadata.rev_tree[0], revLimit);\n        currentDoc.metadata.rev_tree = merged.tree;\n        currentDoc.stemmedRevs = merged.stemmedRevs || [];\n        insertDoc(currentDoc, resultsIdx, docWritten);\n      }\n    }\n    nextDoc();\n  });\n}\n\n// IndexedDB requires a versioned database structure, so we use the\n// version here to manage migrations.\nvar ADAPTER_VERSION = 5;\n\n// The object stores created for each database\n// DOC_STORE stores the document meta data, its revision history and state\n// Keyed by document id\nvar DOC_STORE = 'document-store';\n// BY_SEQ_STORE stores a particular version of a document, keyed by its\n// sequence id\nvar BY_SEQ_STORE = 'by-sequence';\n// Where we store attachments\nvar ATTACH_STORE = 'attach-store';\n// Where we store many-to-many relations\n// between attachment digests and seqs\nvar ATTACH_AND_SEQ_STORE = 'attach-seq-store';\n\n// Where we store database-wide meta data in a single record\n// keyed by id: META_STORE\nvar META_STORE = 'meta-store';\n// Where we store local documents\nvar LOCAL_STORE = 'local-store';\n// Where we detect blob support\nvar DETECT_BLOB_SUPPORT_STORE = 'detect-blob-support';\n\nfunction safeJsonParse(str) {\n  // This try/catch guards against stack overflow errors.\n  // JSON.parse() is faster than vuvuzela.parse() but vuvuzela\n  // cannot overflow.\n  try {\n    return JSON.parse(str);\n  } catch (e) {\n    /* istanbul ignore next */\n    return vuvuzela.parse(str);\n  }\n}\n\nfunction safeJsonStringify(json) {\n  try {\n    return JSON.stringify(json);\n  } catch (e) {\n    /* istanbul ignore next */\n    return vuvuzela.stringify(json);\n  }\n}\n\nfunction idbError(callback) {\n  return function (evt) {\n    var message = 'unknown_error';\n    if (evt.target && evt.target.error) {\n      message = evt.target.error.name || evt.target.error.message;\n    }\n    callback(createError(IDB_ERROR, message, evt.type));\n  };\n}\n\n// Unfortunately, the metadata has to be stringified\n// when it is put into the database, because otherwise\n// IndexedDB can throw errors for deeply-nested objects.\n// Originally we just used JSON.parse/JSON.stringify; now\n// we use this custom vuvuzela library that avoids recursion.\n// If we could do it all over again, we'd probably use a\n// format for the revision trees other than JSON.\nfunction encodeMetadata(metadata, winningRev, deleted) {\n  return {\n    data: safeJsonStringify(metadata),\n    winningRev: winningRev,\n    deletedOrLocal: deleted ? '1' : '0',\n    seq: metadata.seq, // highest seq for this doc\n    id: metadata.id\n  };\n}\n\nfunction decodeMetadata(storedObject) {\n  if (!storedObject) {\n    return null;\n  }\n  var metadata = safeJsonParse(storedObject.data);\n  metadata.winningRev = storedObject.winningRev;\n  metadata.deleted = storedObject.deletedOrLocal === '1';\n  metadata.seq = storedObject.seq;\n  return metadata;\n}\n\n// read the doc back out from the database. we don't store the\n// _id or _rev because we already have _doc_id_rev.\nfunction decodeDoc(doc) {\n  if (!doc) {\n    return doc;\n  }\n  var idx = doc._doc_id_rev.lastIndexOf(':');\n  doc._id = doc._doc_id_rev.substring(0, idx - 1);\n  doc._rev = doc._doc_id_rev.substring(idx + 1);\n  delete doc._doc_id_rev;\n  return doc;\n}\n\n// Read a blob from the database, encoding as necessary\n// and translating from base64 if the IDB doesn't support\n// native Blobs\nfunction readBlobData(body, type, asBlob, callback) {\n  if (asBlob) {\n    if (!body) {\n      callback(createBlob([''], {type: type}));\n    } else if (typeof body !== 'string') { // we have blob support\n      callback(body);\n    } else { // no blob support\n      callback(b64ToBluffer(body, type));\n    }\n  } else { // as base64 string\n    if (!body) {\n      callback('');\n    } else if (typeof body !== 'string') { // we have blob support\n      readAsBinaryString(body, function (binary) {\n        callback(thisBtoa(binary));\n      });\n    } else { // no blob support\n      callback(body);\n    }\n  }\n}\n\nfunction fetchAttachmentsIfNecessary(doc, opts, txn, cb) {\n  var attachments = Object.keys(doc._attachments || {});\n  if (!attachments.length) {\n    return cb && cb();\n  }\n  var numDone = 0;\n\n  function checkDone() {\n    if (++numDone === attachments.length && cb) {\n      cb();\n    }\n  }\n\n  function fetchAttachment(doc, att) {\n    var attObj = doc._attachments[att];\n    var digest = attObj.digest;\n    var req = txn.objectStore(ATTACH_STORE).get(digest);\n    req.onsuccess = function (e) {\n      attObj.body = e.target.result.body;\n      checkDone();\n    };\n  }\n\n  attachments.forEach(function (att) {\n    if (opts.attachments && opts.include_docs) {\n      fetchAttachment(doc, att);\n    } else {\n      doc._attachments[att].stub = true;\n      checkDone();\n    }\n  });\n}\n\n// IDB-specific postprocessing necessary because\n// we don't know whether we stored a true Blob or\n// a base64-encoded string, and if it's a Blob it\n// needs to be read outside of the transaction context\nfunction postProcessAttachments(results, asBlob) {\n  return Promise.all(results.map(function (row) {\n    if (row.doc && row.doc._attachments) {\n      var attNames = Object.keys(row.doc._attachments);\n      return Promise.all(attNames.map(function (att) {\n        var attObj = row.doc._attachments[att];\n        if (!('body' in attObj)) { // already processed\n          return;\n        }\n        var body = attObj.body;\n        var type = attObj.content_type;\n        return new Promise(function (resolve) {\n          readBlobData(body, type, asBlob, function (data) {\n            row.doc._attachments[att] = $inject_Object_assign(\n              pick(attObj, ['digest', 'content_type']),\n              {data: data}\n            );\n            resolve();\n          });\n        });\n      }));\n    }\n  }));\n}\n\nfunction compactRevs(revs, docId, txn) {\n\n  var possiblyOrphanedDigests = [];\n  var seqStore = txn.objectStore(BY_SEQ_STORE);\n  var attStore = txn.objectStore(ATTACH_STORE);\n  var attAndSeqStore = txn.objectStore(ATTACH_AND_SEQ_STORE);\n  var count = revs.length;\n\n  function checkDone() {\n    count--;\n    if (!count) { // done processing all revs\n      deleteOrphanedAttachments();\n    }\n  }\n\n  function deleteOrphanedAttachments() {\n    if (!possiblyOrphanedDigests.length) {\n      return;\n    }\n    possiblyOrphanedDigests.forEach(function (digest) {\n      var countReq = attAndSeqStore.index('digestSeq').count(\n        IDBKeyRange.bound(\n          digest + '::', digest + '::\\uffff', false, false));\n      countReq.onsuccess = function (e) {\n        var count = e.target.result;\n        if (!count) {\n          // orphaned\n          attStore.delete(digest);\n        }\n      };\n    });\n  }\n\n  revs.forEach(function (rev$$1) {\n    var index = seqStore.index('_doc_id_rev');\n    var key = docId + \"::\" + rev$$1;\n    index.getKey(key).onsuccess = function (e) {\n      var seq = e.target.result;\n      if (typeof seq !== 'number') {\n        return checkDone();\n      }\n      seqStore.delete(seq);\n\n      var cursor = attAndSeqStore.index('seq')\n        .openCursor(IDBKeyRange.only(seq));\n\n      cursor.onsuccess = function (event) {\n        var cursor = event.target.result;\n        if (cursor) {\n          var digest = cursor.value.digestSeq.split('::')[0];\n          possiblyOrphanedDigests.push(digest);\n          attAndSeqStore.delete(cursor.primaryKey);\n          cursor.continue();\n        } else { // done\n          checkDone();\n        }\n      };\n    };\n  });\n}\n\nfunction openTransactionSafely(idb, stores, mode) {\n  try {\n    return {\n      txn: idb.transaction(stores, mode)\n    };\n  } catch (err) {\n    return {\n      error: err\n    };\n  }\n}\n\nvar changesHandler = new Changes();\n\nfunction idbBulkDocs(dbOpts, req, opts, api, idb, callback) {\n  var docInfos = req.docs;\n  var txn;\n  var docStore;\n  var bySeqStore;\n  var attachStore;\n  var attachAndSeqStore;\n  var metaStore;\n  var docInfoError;\n  var metaDoc;\n\n  for (var i = 0, len = docInfos.length; i < len; i++) {\n    var doc = docInfos[i];\n    if (doc._id && isLocalId(doc._id)) {\n      continue;\n    }\n    doc = docInfos[i] = parseDoc(doc, opts.new_edits, dbOpts);\n    if (doc.error && !docInfoError) {\n      docInfoError = doc;\n    }\n  }\n\n  if (docInfoError) {\n    return callback(docInfoError);\n  }\n\n  var allDocsProcessed = false;\n  var docCountDelta = 0;\n  var results = new Array(docInfos.length);\n  var fetchedDocs = new ExportedMap();\n  var preconditionErrored = false;\n  var blobType = api._meta.blobSupport ? 'blob' : 'base64';\n\n  preprocessAttachments(docInfos, blobType, function (err) {\n    if (err) {\n      return callback(err);\n    }\n    startTransaction();\n  });\n\n  function startTransaction() {\n\n    var stores = [\n      DOC_STORE, BY_SEQ_STORE,\n      ATTACH_STORE,\n      LOCAL_STORE, ATTACH_AND_SEQ_STORE,\n      META_STORE\n    ];\n    var txnResult = openTransactionSafely(idb, stores, 'readwrite');\n    if (txnResult.error) {\n      return callback(txnResult.error);\n    }\n    txn = txnResult.txn;\n    txn.onabort = idbError(callback);\n    txn.ontimeout = idbError(callback);\n    txn.oncomplete = complete;\n    docStore = txn.objectStore(DOC_STORE);\n    bySeqStore = txn.objectStore(BY_SEQ_STORE);\n    attachStore = txn.objectStore(ATTACH_STORE);\n    attachAndSeqStore = txn.objectStore(ATTACH_AND_SEQ_STORE);\n    metaStore = txn.objectStore(META_STORE);\n\n    metaStore.get(META_STORE).onsuccess = function (e) {\n      metaDoc = e.target.result;\n      updateDocCountIfReady();\n    };\n\n    verifyAttachments(function (err) {\n      if (err) {\n        preconditionErrored = true;\n        return callback(err);\n      }\n      fetchExistingDocs();\n    });\n  }\n\n  function onAllDocsProcessed() {\n    allDocsProcessed = true;\n    updateDocCountIfReady();\n  }\n\n  function idbProcessDocs() {\n    processDocs(dbOpts.revs_limit, docInfos, api, fetchedDocs,\n                txn, results, writeDoc, opts, onAllDocsProcessed);\n  }\n\n  function updateDocCountIfReady() {\n    if (!metaDoc || !allDocsProcessed) {\n      return;\n    }\n    // caching the docCount saves a lot of time in allDocs() and\n    // info(), which is why we go to all the trouble of doing this\n    metaDoc.docCount += docCountDelta;\n    metaStore.put(metaDoc);\n  }\n\n  function fetchExistingDocs() {\n\n    if (!docInfos.length) {\n      return;\n    }\n\n    var numFetched = 0;\n\n    function checkDone() {\n      if (++numFetched === docInfos.length) {\n        idbProcessDocs();\n      }\n    }\n\n    function readMetadata(event) {\n      var metadata = decodeMetadata(event.target.result);\n\n      if (metadata) {\n        fetchedDocs.set(metadata.id, metadata);\n      }\n      checkDone();\n    }\n\n    for (var i = 0, len = docInfos.length; i < len; i++) {\n      var docInfo = docInfos[i];\n      if (docInfo._id && isLocalId(docInfo._id)) {\n        checkDone(); // skip local docs\n        continue;\n      }\n      var req = docStore.get(docInfo.metadata.id);\n      req.onsuccess = readMetadata;\n    }\n  }\n\n  function complete() {\n    if (preconditionErrored) {\n      return;\n    }\n\n    changesHandler.notify(api._meta.name);\n    callback(null, results);\n  }\n\n  function verifyAttachment(digest, callback) {\n\n    var req = attachStore.get(digest);\n    req.onsuccess = function (e) {\n      if (!e.target.result) {\n        var err = createError(MISSING_STUB,\n          'unknown stub attachment with digest ' +\n          digest);\n        err.status = 412;\n        callback(err);\n      } else {\n        callback();\n      }\n    };\n  }\n\n  function verifyAttachments(finish) {\n\n\n    var digests = [];\n    docInfos.forEach(function (docInfo) {\n      if (docInfo.data && docInfo.data._attachments) {\n        Object.keys(docInfo.data._attachments).forEach(function (filename) {\n          var att = docInfo.data._attachments[filename];\n          if (att.stub) {\n            digests.push(att.digest);\n          }\n        });\n      }\n    });\n    if (!digests.length) {\n      return finish();\n    }\n    var numDone = 0;\n    var err;\n\n    function checkDone() {\n      if (++numDone === digests.length) {\n        finish(err);\n      }\n    }\n    digests.forEach(function (digest) {\n      verifyAttachment(digest, function (attErr) {\n        if (attErr && !err) {\n          err = attErr;\n        }\n        checkDone();\n      });\n    });\n  }\n\n  function writeDoc(docInfo, winningRev$$1, winningRevIsDeleted, newRevIsDeleted,\n                    isUpdate, delta, resultsIdx, callback) {\n\n    docInfo.metadata.winningRev = winningRev$$1;\n    docInfo.metadata.deleted = winningRevIsDeleted;\n\n    var doc = docInfo.data;\n    doc._id = docInfo.metadata.id;\n    doc._rev = docInfo.metadata.rev;\n\n    if (newRevIsDeleted) {\n      doc._deleted = true;\n    }\n\n    var hasAttachments = doc._attachments &&\n      Object.keys(doc._attachments).length;\n    if (hasAttachments) {\n      return writeAttachments(docInfo, winningRev$$1, winningRevIsDeleted,\n        isUpdate, resultsIdx, callback);\n    }\n\n    docCountDelta += delta;\n    updateDocCountIfReady();\n\n    finishDoc(docInfo, winningRev$$1, winningRevIsDeleted,\n      isUpdate, resultsIdx, callback);\n  }\n\n  function finishDoc(docInfo, winningRev$$1, winningRevIsDeleted,\n                     isUpdate, resultsIdx, callback) {\n\n    var doc = docInfo.data;\n    var metadata = docInfo.metadata;\n\n    doc._doc_id_rev = metadata.id + '::' + metadata.rev;\n    delete doc._id;\n    delete doc._rev;\n\n    function afterPutDoc(e) {\n      var revsToDelete = docInfo.stemmedRevs || [];\n\n      if (isUpdate && api.auto_compaction) {\n        revsToDelete = revsToDelete.concat(compactTree(docInfo.metadata));\n      }\n\n      if (revsToDelete && revsToDelete.length) {\n        compactRevs(revsToDelete, docInfo.metadata.id, txn);\n      }\n\n      metadata.seq = e.target.result;\n      // Current _rev is calculated from _rev_tree on read\n      // delete metadata.rev;\n      var metadataToStore = encodeMetadata(metadata, winningRev$$1,\n        winningRevIsDeleted);\n      var metaDataReq = docStore.put(metadataToStore);\n      metaDataReq.onsuccess = afterPutMetadata;\n    }\n\n    function afterPutDocError(e) {\n      // ConstraintError, need to update, not put (see #1638 for details)\n      e.preventDefault(); // avoid transaction abort\n      e.stopPropagation(); // avoid transaction onerror\n      var index = bySeqStore.index('_doc_id_rev');\n      var getKeyReq = index.getKey(doc._doc_id_rev);\n      getKeyReq.onsuccess = function (e) {\n        var putReq = bySeqStore.put(doc, e.target.result);\n        putReq.onsuccess = afterPutDoc;\n      };\n    }\n\n    function afterPutMetadata() {\n      results[resultsIdx] = {\n        ok: true,\n        id: metadata.id,\n        rev: metadata.rev\n      };\n      fetchedDocs.set(docInfo.metadata.id, docInfo.metadata);\n      insertAttachmentMappings(docInfo, metadata.seq, callback);\n    }\n\n    var putReq = bySeqStore.put(doc);\n\n    putReq.onsuccess = afterPutDoc;\n    putReq.onerror = afterPutDocError;\n  }\n\n  function writeAttachments(docInfo, winningRev$$1, winningRevIsDeleted,\n                            isUpdate, resultsIdx, callback) {\n\n\n    var doc = docInfo.data;\n\n    var numDone = 0;\n    var attachments = Object.keys(doc._attachments);\n\n    function collectResults() {\n      if (numDone === attachments.length) {\n        finishDoc(docInfo, winningRev$$1, winningRevIsDeleted,\n          isUpdate, resultsIdx, callback);\n      }\n    }\n\n    function attachmentSaved() {\n      numDone++;\n      collectResults();\n    }\n\n    attachments.forEach(function (key) {\n      var att = docInfo.data._attachments[key];\n      if (!att.stub) {\n        var data = att.data;\n        delete att.data;\n        att.revpos = parseInt(winningRev$$1, 10);\n        var digest = att.digest;\n        saveAttachment(digest, data, attachmentSaved);\n      } else {\n        numDone++;\n        collectResults();\n      }\n    });\n  }\n\n  // map seqs to attachment digests, which\n  // we will need later during compaction\n  function insertAttachmentMappings(docInfo, seq, callback) {\n\n    var attsAdded = 0;\n    var attsToAdd = Object.keys(docInfo.data._attachments || {});\n\n    if (!attsToAdd.length) {\n      return callback();\n    }\n\n    function checkDone() {\n      if (++attsAdded === attsToAdd.length) {\n        callback();\n      }\n    }\n\n    function add(att) {\n      var digest = docInfo.data._attachments[att].digest;\n      var req = attachAndSeqStore.put({\n        seq: seq,\n        digestSeq: digest + '::' + seq\n      });\n\n      req.onsuccess = checkDone;\n      req.onerror = function (e) {\n        // this callback is for a constaint error, which we ignore\n        // because this docid/rev has already been associated with\n        // the digest (e.g. when new_edits == false)\n        e.preventDefault(); // avoid transaction abort\n        e.stopPropagation(); // avoid transaction onerror\n        checkDone();\n      };\n    }\n    for (var i = 0; i < attsToAdd.length; i++) {\n      add(attsToAdd[i]); // do in parallel\n    }\n  }\n\n  function saveAttachment(digest, data, callback) {\n\n\n    var getKeyReq = attachStore.count(digest);\n    getKeyReq.onsuccess = function (e) {\n      var count = e.target.result;\n      if (count) {\n        return callback(); // already exists\n      }\n      var newAtt = {\n        digest: digest,\n        body: data\n      };\n      var putReq = attachStore.put(newAtt);\n      putReq.onsuccess = callback;\n    };\n  }\n}\n\n// Abstraction over IDBCursor and getAll()/getAllKeys() that allows us to batch our operations\n// while falling back to a normal IDBCursor operation on browsers that don't support getAll() or\n// getAllKeys(). This allows for a much faster implementation than just straight-up cursors, because\n// we're not processing each document one-at-a-time.\nfunction runBatchedCursor(objectStore, keyRange, descending, batchSize, onBatch) {\n\n  if (batchSize === -1) {\n    batchSize = 1000;\n  }\n\n  // Bail out of getAll()/getAllKeys() in the following cases:\n  // 1) either method is unsupported - we need both\n  // 2) batchSize is 1 (might as well use IDBCursor)\n  // 3) descending  no real way to do this via getAll()/getAllKeys()\n\n  var useGetAll = typeof objectStore.getAll === 'function' &&\n    typeof objectStore.getAllKeys === 'function' &&\n    batchSize > 1 && !descending;\n\n  var keysBatch;\n  var valuesBatch;\n  var pseudoCursor;\n\n  function onGetAll(e) {\n    valuesBatch = e.target.result;\n    if (keysBatch) {\n      onBatch(keysBatch, valuesBatch, pseudoCursor);\n    }\n  }\n\n  function onGetAllKeys(e) {\n    keysBatch = e.target.result;\n    if (valuesBatch) {\n      onBatch(keysBatch, valuesBatch, pseudoCursor);\n    }\n  }\n\n  function continuePseudoCursor() {\n    if (!keysBatch.length) { // no more results\n      return onBatch();\n    }\n    // fetch next batch, exclusive start\n    var lastKey = keysBatch[keysBatch.length - 1];\n    var newKeyRange;\n    if (keyRange && keyRange.upper) {\n      try {\n        newKeyRange = IDBKeyRange.bound(lastKey, keyRange.upper,\n          true, keyRange.upperOpen);\n      } catch (e) {\n        if (e.name === \"DataError\" && e.code === 0) {\n          return onBatch(); // we're done, startkey and endkey are equal\n        }\n      }\n    } else {\n      newKeyRange = IDBKeyRange.lowerBound(lastKey, true);\n    }\n    keyRange = newKeyRange;\n    keysBatch = null;\n    valuesBatch = null;\n    objectStore.getAll(keyRange, batchSize).onsuccess = onGetAll;\n    objectStore.getAllKeys(keyRange, batchSize).onsuccess = onGetAllKeys;\n  }\n\n  function onCursor(e) {\n    var cursor = e.target.result;\n    if (!cursor) { // done\n      return onBatch();\n    }\n    // regular IDBCursor acts like a batch where batch size is always 1\n    onBatch([cursor.key], [cursor.value], cursor);\n  }\n\n  if (useGetAll) {\n    pseudoCursor = {\"continue\": continuePseudoCursor};\n    objectStore.getAll(keyRange, batchSize).onsuccess = onGetAll;\n    objectStore.getAllKeys(keyRange, batchSize).onsuccess = onGetAllKeys;\n  } else if (descending) {\n    objectStore.openCursor(keyRange, 'prev').onsuccess = onCursor;\n  } else {\n    objectStore.openCursor(keyRange).onsuccess = onCursor;\n  }\n}\n\n// simple shim for objectStore.getAll(), falling back to IDBCursor\nfunction getAll(objectStore, keyRange, onSuccess) {\n  if (typeof objectStore.getAll === 'function') {\n    // use native getAll\n    objectStore.getAll(keyRange).onsuccess = onSuccess;\n    return;\n  }\n  // fall back to cursors\n  var values = [];\n\n  function onCursor(e) {\n    var cursor = e.target.result;\n    if (cursor) {\n      values.push(cursor.value);\n      cursor.continue();\n    } else {\n      onSuccess({\n        target: {\n          result: values\n        }\n      });\n    }\n  }\n\n  objectStore.openCursor(keyRange).onsuccess = onCursor;\n}\n\nfunction allDocsKeys(keys, docStore, onBatch) {\n  // It's not guaranted to be returned in right order  \n  var valuesBatch = new Array(keys.length);\n  var count = 0;\n  keys.forEach(function (key, index) {\n    docStore.get(key).onsuccess = function (event) {\n      if (event.target.result) {\n        valuesBatch[index] = event.target.result;\n      } else {\n        valuesBatch[index] = {key: key, error: 'not_found'};\n      }\n      count++;\n      if (count === keys.length) {\n        onBatch(keys, valuesBatch, {});\n      }\n    };\n  });\n}\n\nfunction createKeyRange(start, end, inclusiveEnd, key, descending) {\n  try {\n    if (start && end) {\n      if (descending) {\n        return IDBKeyRange.bound(end, start, !inclusiveEnd, false);\n      } else {\n        return IDBKeyRange.bound(start, end, false, !inclusiveEnd);\n      }\n    } else if (start) {\n      if (descending) {\n        return IDBKeyRange.upperBound(start);\n      } else {\n        return IDBKeyRange.lowerBound(start);\n      }\n    } else if (end) {\n      if (descending) {\n        return IDBKeyRange.lowerBound(end, !inclusiveEnd);\n      } else {\n        return IDBKeyRange.upperBound(end, !inclusiveEnd);\n      }\n    } else if (key) {\n      return IDBKeyRange.only(key);\n    }\n  } catch (e) {\n    return {error: e};\n  }\n  return null;\n}\n\nfunction idbAllDocs(opts, idb, callback) {\n  var start = 'startkey' in opts ? opts.startkey : false;\n  var end = 'endkey' in opts ? opts.endkey : false;\n  var key = 'key' in opts ? opts.key : false;\n  var keys = 'keys' in opts ? opts.keys : false; \n  var skip = opts.skip || 0;\n  var limit = typeof opts.limit === 'number' ? opts.limit : -1;\n  var inclusiveEnd = opts.inclusive_end !== false;\n\n  var keyRange ; \n  var keyRangeError;\n  if (!keys) {\n    keyRange = createKeyRange(start, end, inclusiveEnd, key, opts.descending);\n    keyRangeError = keyRange && keyRange.error;\n    if (keyRangeError && \n      !(keyRangeError.name === \"DataError\" && keyRangeError.code === 0)) {\n      // DataError with error code 0 indicates start is less than end, so\n      // can just do an empty query. Else need to throw\n      return callback(createError(IDB_ERROR,\n        keyRangeError.name, keyRangeError.message));\n    }\n  }\n\n  var stores = [DOC_STORE, BY_SEQ_STORE, META_STORE];\n\n  if (opts.attachments) {\n    stores.push(ATTACH_STORE);\n  }\n  var txnResult = openTransactionSafely(idb, stores, 'readonly');\n  if (txnResult.error) {\n    return callback(txnResult.error);\n  }\n  var txn = txnResult.txn;\n  txn.oncomplete = onTxnComplete;\n  txn.onabort = idbError(callback);\n  var docStore = txn.objectStore(DOC_STORE);\n  var seqStore = txn.objectStore(BY_SEQ_STORE);\n  var metaStore = txn.objectStore(META_STORE);\n  var docIdRevIndex = seqStore.index('_doc_id_rev');\n  var results = [];\n  var docCount;\n  var updateSeq;\n\n  metaStore.get(META_STORE).onsuccess = function (e) {\n    docCount = e.target.result.docCount;\n  };\n\n  /* istanbul ignore if */\n  if (opts.update_seq) {\n    getMaxUpdateSeq(seqStore, function (e) { \n      if (e.target.result && e.target.result.length > 0) {\n        updateSeq = e.target.result[0];\n      }\n    });\n  }\n\n  function getMaxUpdateSeq(objectStore, onSuccess) {\n    function onCursor(e) {\n      var cursor = e.target.result;\n      var maxKey = undefined;\n      if (cursor && cursor.key) {\n        maxKey = cursor.key;\n      } \n      return onSuccess({\n        target: {\n          result: [maxKey]\n        }\n      });\n    }\n    objectStore.openCursor(null, 'prev').onsuccess = onCursor;\n  }\n\n  // if the user specifies include_docs=true, then we don't\n  // want to block the main cursor while we're fetching the doc\n  function fetchDocAsynchronously(metadata, row, winningRev$$1) {\n    var key = metadata.id + \"::\" + winningRev$$1;\n    docIdRevIndex.get(key).onsuccess =  function onGetDoc(e) {\n      row.doc = decodeDoc(e.target.result) || {};\n      if (opts.conflicts) {\n        var conflicts = collectConflicts(metadata);\n        if (conflicts.length) {\n          row.doc._conflicts = conflicts;\n        }\n      }\n      fetchAttachmentsIfNecessary(row.doc, opts, txn);\n    };\n  }\n\n  function allDocsInner(winningRev$$1, metadata) {\n    var row = {\n      id: metadata.id,\n      key: metadata.id,\n      value: {\n        rev: winningRev$$1\n      }\n    };\n    var deleted = metadata.deleted;\n    if (deleted) {\n      if (keys) {\n        results.push(row);\n        // deleted docs are okay with \"keys\" requests\n        row.value.deleted = true;\n        row.doc = null;\n      }\n    } else if (skip-- <= 0) {\n      results.push(row);\n      if (opts.include_docs) {\n        fetchDocAsynchronously(metadata, row, winningRev$$1);\n      }\n    }\n  }\n\n  function processBatch(batchValues) {\n    for (var i = 0, len = batchValues.length; i < len; i++) {\n      if (results.length === limit) {\n        break;\n      }\n      var batchValue = batchValues[i];\n      if (batchValue.error && keys) {\n        // key was not found with \"keys\" requests\n        results.push(batchValue);\n        continue;\n      }\n      var metadata = decodeMetadata(batchValue);\n      var winningRev$$1 = metadata.winningRev;\n      allDocsInner(winningRev$$1, metadata);\n    }\n  }\n\n  function onBatch(batchKeys, batchValues, cursor) {\n    if (!cursor) {\n      return;\n    }\n    processBatch(batchValues);\n    if (results.length < limit) {\n      cursor.continue();\n    }\n  }\n\n  function onGetAll(e) {\n    var values = e.target.result;\n    if (opts.descending) {\n      values = values.reverse();\n    }\n    processBatch(values);\n  }\n\n  function onResultsReady() {\n    var returnVal = {\n      total_rows: docCount,\n      offset: opts.skip,\n      rows: results\n    };\n    \n    /* istanbul ignore if */\n    if (opts.update_seq && updateSeq !== undefined) {\n      returnVal.update_seq = updateSeq;\n    }\n    callback(null, returnVal);\n  }\n\n  function onTxnComplete() {\n    if (opts.attachments) {\n      postProcessAttachments(results, opts.binary).then(onResultsReady);\n    } else {\n      onResultsReady();\n    }\n  }\n\n  // don't bother doing any requests if start > end or limit === 0\n  if (keyRangeError || limit === 0) {\n    return;\n  }\n  if (keys) {\n    return allDocsKeys(opts.keys, docStore, onBatch);\n  }\n  if (limit === -1) { // just fetch everything\n    return getAll(docStore, keyRange, onGetAll);\n  }\n  // else do a cursor\n  // choose a batch size based on the skip, since we'll need to skip that many\n  runBatchedCursor(docStore, keyRange, opts.descending, limit + skip, onBatch);\n}\n\n//\n// Blobs are not supported in all versions of IndexedDB, notably\n// Chrome <37 and Android <5. In those versions, storing a blob will throw.\n//\n// Various other blob bugs exist in Chrome v37-42 (inclusive).\n// Detecting them is expensive and confusing to users, and Chrome 37-42\n// is at very low usage worldwide, so we do a hacky userAgent check instead.\n//\n// content-type bug: https://code.google.com/p/chromium/issues/detail?id=408120\n// 404 bug: https://code.google.com/p/chromium/issues/detail?id=447916\n// FileReader bug: https://code.google.com/p/chromium/issues/detail?id=447836\n//\nfunction checkBlobSupport(txn) {\n  return new Promise(function (resolve) {\n    var blob$$1 = createBlob(['']);\n    var req = txn.objectStore(DETECT_BLOB_SUPPORT_STORE).put(blob$$1, 'key');\n\n    req.onsuccess = function () {\n      var matchedChrome = navigator.userAgent.match(/Chrome\\/(\\d+)/);\n      var matchedEdge = navigator.userAgent.match(/Edge\\//);\n      // MS Edge pretends to be Chrome 42:\n      // https://msdn.microsoft.com/en-us/library/hh869301%28v=vs.85%29.aspx\n      resolve(matchedEdge || !matchedChrome ||\n        parseInt(matchedChrome[1], 10) >= 43);\n    };\n\n    req.onerror = txn.onabort = function (e) {\n      // If the transaction aborts now its due to not being able to\n      // write to the database, likely due to the disk being full\n      e.preventDefault();\n      e.stopPropagation();\n      resolve(false);\n    };\n  }).catch(function () {\n    return false; // error, so assume unsupported\n  });\n}\n\nfunction countDocs(txn, cb) {\n  var index = txn.objectStore(DOC_STORE).index('deletedOrLocal');\n  index.count(IDBKeyRange.only('0')).onsuccess = function (e) {\n    cb(e.target.result);\n  };\n}\n\n// This task queue ensures that IDB open calls are done in their own tick\n\nvar running = false;\nvar queue = [];\n\nfunction tryCode(fun, err, res, PouchDB) {\n  try {\n    fun(err, res);\n  } catch (err) {\n    // Shouldn't happen, but in some odd cases\n    // IndexedDB implementations might throw a sync\n    // error, in which case this will at least log it.\n    PouchDB.emit('error', err);\n  }\n}\n\nfunction applyNext() {\n  if (running || !queue.length) {\n    return;\n  }\n  running = true;\n  queue.shift()();\n}\n\nfunction enqueueTask(action, callback, PouchDB) {\n  queue.push(function runAction() {\n    action(function runCallback(err, res) {\n      tryCode(callback, err, res, PouchDB);\n      running = false;\n      immediate(function runNext() {\n        applyNext(PouchDB);\n      });\n    });\n  });\n  applyNext();\n}\n\nfunction changes(opts, api, dbName, idb) {\n  opts = clone(opts);\n\n  if (opts.continuous) {\n    var id = dbName + ':' + uuid();\n    changesHandler.addListener(dbName, id, api, opts);\n    changesHandler.notify(dbName);\n    return {\n      cancel: function () {\n        changesHandler.removeListener(dbName, id);\n      }\n    };\n  }\n\n  var docIds = opts.doc_ids && new ExportedSet(opts.doc_ids);\n\n  opts.since = opts.since || 0;\n  var lastSeq = opts.since;\n\n  var limit = 'limit' in opts ? opts.limit : -1;\n  if (limit === 0) {\n    limit = 1; // per CouchDB _changes spec\n  }\n\n  var results = [];\n  var numResults = 0;\n  var filter = filterChange(opts);\n  var docIdsToMetadata = new ExportedMap();\n\n  var txn;\n  var bySeqStore;\n  var docStore;\n  var docIdRevIndex;\n\n  function onBatch(batchKeys, batchValues, cursor) {\n    if (!cursor || !batchKeys.length) { // done\n      return;\n    }\n\n    var winningDocs = new Array(batchKeys.length);\n    var metadatas = new Array(batchKeys.length);\n\n    function processMetadataAndWinningDoc(metadata, winningDoc) {\n      var change = opts.processChange(winningDoc, metadata, opts);\n      lastSeq = change.seq = metadata.seq;\n\n      var filtered = filter(change);\n      if (typeof filtered === 'object') { // anything but true/false indicates error\n        return Promise.reject(filtered);\n      }\n\n      if (!filtered) {\n        return Promise.resolve();\n      }\n      numResults++;\n      if (opts.return_docs) {\n        results.push(change);\n      }\n      // process the attachment immediately\n      // for the benefit of live listeners\n      if (opts.attachments && opts.include_docs) {\n        return new Promise(function (resolve) {\n          fetchAttachmentsIfNecessary(winningDoc, opts, txn, function () {\n            postProcessAttachments([change], opts.binary).then(function () {\n              resolve(change);\n            });\n          });\n        });\n      } else {\n        return Promise.resolve(change);\n      }\n    }\n\n    function onBatchDone() {\n      var promises = [];\n      for (var i = 0, len = winningDocs.length; i < len; i++) {\n        if (numResults === limit) {\n          break;\n        }\n        var winningDoc = winningDocs[i];\n        if (!winningDoc) {\n          continue;\n        }\n        var metadata = metadatas[i];\n        promises.push(processMetadataAndWinningDoc(metadata, winningDoc));\n      }\n\n      Promise.all(promises).then(function (changes) {\n        for (var i = 0, len = changes.length; i < len; i++) {\n          if (changes[i]) {\n            opts.onChange(changes[i]);\n          }\n        }\n      }).catch(opts.complete);\n\n      if (numResults !== limit) {\n        cursor.continue();\n      }\n    }\n\n    // Fetch all metadatas/winningdocs from this batch in parallel, then process\n    // them all only once all data has been collected. This is done in parallel\n    // because it's faster than doing it one-at-a-time.\n    var numDone = 0;\n    batchValues.forEach(function (value, i) {\n      var doc = decodeDoc(value);\n      var seq = batchKeys[i];\n      fetchWinningDocAndMetadata(doc, seq, function (metadata, winningDoc) {\n        metadatas[i] = metadata;\n        winningDocs[i] = winningDoc;\n        if (++numDone === batchKeys.length) {\n          onBatchDone();\n        }\n      });\n    });\n  }\n\n  function onGetMetadata(doc, seq, metadata, cb) {\n    if (metadata.seq !== seq) {\n      // some other seq is later\n      return cb();\n    }\n\n    if (metadata.winningRev === doc._rev) {\n      // this is the winning doc\n      return cb(metadata, doc);\n    }\n\n    // fetch winning doc in separate request\n    var docIdRev = doc._id + '::' + metadata.winningRev;\n    var req = docIdRevIndex.get(docIdRev);\n    req.onsuccess = function (e) {\n      cb(metadata, decodeDoc(e.target.result));\n    };\n  }\n\n  function fetchWinningDocAndMetadata(doc, seq, cb) {\n    if (docIds && !docIds.has(doc._id)) {\n      return cb();\n    }\n\n    var metadata = docIdsToMetadata.get(doc._id);\n    if (metadata) { // cached\n      return onGetMetadata(doc, seq, metadata, cb);\n    }\n    // metadata not cached, have to go fetch it\n    docStore.get(doc._id).onsuccess = function (e) {\n      metadata = decodeMetadata(e.target.result);\n      docIdsToMetadata.set(doc._id, metadata);\n      onGetMetadata(doc, seq, metadata, cb);\n    };\n  }\n\n  function finish() {\n    opts.complete(null, {\n      results: results,\n      last_seq: lastSeq\n    });\n  }\n\n  function onTxnComplete() {\n    if (!opts.continuous && opts.attachments) {\n      // cannot guarantee that postProcessing was already done,\n      // so do it again\n      postProcessAttachments(results).then(finish);\n    } else {\n      finish();\n    }\n  }\n\n  var objectStores = [DOC_STORE, BY_SEQ_STORE];\n  if (opts.attachments) {\n    objectStores.push(ATTACH_STORE);\n  }\n  var txnResult = openTransactionSafely(idb, objectStores, 'readonly');\n  if (txnResult.error) {\n    return opts.complete(txnResult.error);\n  }\n  txn = txnResult.txn;\n  txn.onabort = idbError(opts.complete);\n  txn.oncomplete = onTxnComplete;\n\n  bySeqStore = txn.objectStore(BY_SEQ_STORE);\n  docStore = txn.objectStore(DOC_STORE);\n  docIdRevIndex = bySeqStore.index('_doc_id_rev');\n\n  var keyRange = (opts.since && !opts.descending) ?\n    IDBKeyRange.lowerBound(opts.since, true) : null;\n\n  runBatchedCursor(bySeqStore, keyRange, opts.descending, limit, onBatch);\n}\n\nvar cachedDBs = new ExportedMap();\nvar blobSupportPromise;\nvar openReqList = new ExportedMap();\n\nfunction IdbPouch(opts, callback) {\n  var api = this;\n\n  enqueueTask(function (thisCallback) {\n    init(api, opts, thisCallback);\n  }, callback, api.constructor);\n}\n\nfunction init(api, opts, callback) {\n\n  var dbName = opts.name;\n\n  var idb = null;\n  api._meta = null;\n\n  // called when creating a fresh new database\n  function createSchema(db) {\n    var docStore = db.createObjectStore(DOC_STORE, {keyPath : 'id'});\n    db.createObjectStore(BY_SEQ_STORE, {autoIncrement: true})\n      .createIndex('_doc_id_rev', '_doc_id_rev', {unique: true});\n    db.createObjectStore(ATTACH_STORE, {keyPath: 'digest'});\n    db.createObjectStore(META_STORE, {keyPath: 'id', autoIncrement: false});\n    db.createObjectStore(DETECT_BLOB_SUPPORT_STORE);\n\n    // added in v2\n    docStore.createIndex('deletedOrLocal', 'deletedOrLocal', {unique : false});\n\n    // added in v3\n    db.createObjectStore(LOCAL_STORE, {keyPath: '_id'});\n\n    // added in v4\n    var attAndSeqStore = db.createObjectStore(ATTACH_AND_SEQ_STORE,\n      {autoIncrement: true});\n    attAndSeqStore.createIndex('seq', 'seq');\n    attAndSeqStore.createIndex('digestSeq', 'digestSeq', {unique: true});\n  }\n\n  // migration to version 2\n  // unfortunately \"deletedOrLocal\" is a misnomer now that we no longer\n  // store local docs in the main doc-store, but whaddyagonnado\n  function addDeletedOrLocalIndex(txn, callback) {\n    var docStore = txn.objectStore(DOC_STORE);\n    docStore.createIndex('deletedOrLocal', 'deletedOrLocal', {unique : false});\n\n    docStore.openCursor().onsuccess = function (event) {\n      var cursor = event.target.result;\n      if (cursor) {\n        var metadata = cursor.value;\n        var deleted = isDeleted(metadata);\n        metadata.deletedOrLocal = deleted ? \"1\" : \"0\";\n        docStore.put(metadata);\n        cursor.continue();\n      } else {\n        callback();\n      }\n    };\n  }\n\n  // migration to version 3 (part 1)\n  function createLocalStoreSchema(db) {\n    db.createObjectStore(LOCAL_STORE, {keyPath: '_id'})\n      .createIndex('_doc_id_rev', '_doc_id_rev', {unique: true});\n  }\n\n  // migration to version 3 (part 2)\n  function migrateLocalStore(txn, cb) {\n    var localStore = txn.objectStore(LOCAL_STORE);\n    var docStore = txn.objectStore(DOC_STORE);\n    var seqStore = txn.objectStore(BY_SEQ_STORE);\n\n    var cursor = docStore.openCursor();\n    cursor.onsuccess = function (event) {\n      var cursor = event.target.result;\n      if (cursor) {\n        var metadata = cursor.value;\n        var docId = metadata.id;\n        var local = isLocalId(docId);\n        var rev$$1 = winningRev(metadata);\n        if (local) {\n          var docIdRev = docId + \"::\" + rev$$1;\n          // remove all seq entries\n          // associated with this docId\n          var start = docId + \"::\";\n          var end = docId + \"::~\";\n          var index = seqStore.index('_doc_id_rev');\n          var range = IDBKeyRange.bound(start, end, false, false);\n          var seqCursor = index.openCursor(range);\n          seqCursor.onsuccess = function (e) {\n            seqCursor = e.target.result;\n            if (!seqCursor) {\n              // done\n              docStore.delete(cursor.primaryKey);\n              cursor.continue();\n            } else {\n              var data = seqCursor.value;\n              if (data._doc_id_rev === docIdRev) {\n                localStore.put(data);\n              }\n              seqStore.delete(seqCursor.primaryKey);\n              seqCursor.continue();\n            }\n          };\n        } else {\n          cursor.continue();\n        }\n      } else if (cb) {\n        cb();\n      }\n    };\n  }\n\n  // migration to version 4 (part 1)\n  function addAttachAndSeqStore(db) {\n    var attAndSeqStore = db.createObjectStore(ATTACH_AND_SEQ_STORE,\n      {autoIncrement: true});\n    attAndSeqStore.createIndex('seq', 'seq');\n    attAndSeqStore.createIndex('digestSeq', 'digestSeq', {unique: true});\n  }\n\n  // migration to version 4 (part 2)\n  function migrateAttsAndSeqs(txn, callback) {\n    var seqStore = txn.objectStore(BY_SEQ_STORE);\n    var attStore = txn.objectStore(ATTACH_STORE);\n    var attAndSeqStore = txn.objectStore(ATTACH_AND_SEQ_STORE);\n\n    // need to actually populate the table. this is the expensive part,\n    // so as an optimization, check first that this database even\n    // contains attachments\n    var req = attStore.count();\n    req.onsuccess = function (e) {\n      var count = e.target.result;\n      if (!count) {\n        return callback(); // done\n      }\n\n      seqStore.openCursor().onsuccess = function (e) {\n        var cursor = e.target.result;\n        if (!cursor) {\n          return callback(); // done\n        }\n        var doc = cursor.value;\n        var seq = cursor.primaryKey;\n        var atts = Object.keys(doc._attachments || {});\n        var digestMap = {};\n        for (var j = 0; j < atts.length; j++) {\n          var att = doc._attachments[atts[j]];\n          digestMap[att.digest] = true; // uniq digests, just in case\n        }\n        var digests = Object.keys(digestMap);\n        for (j = 0; j < digests.length; j++) {\n          var digest = digests[j];\n          attAndSeqStore.put({\n            seq: seq,\n            digestSeq: digest + '::' + seq\n          });\n        }\n        cursor.continue();\n      };\n    };\n  }\n\n  // migration to version 5\n  // Instead of relying on on-the-fly migration of metadata,\n  // this brings the doc-store to its modern form:\n  // - metadata.winningrev\n  // - metadata.seq\n  // - stringify the metadata when storing it\n  function migrateMetadata(txn) {\n\n    function decodeMetadataCompat(storedObject) {\n      if (!storedObject.data) {\n        // old format, when we didn't store it stringified\n        storedObject.deleted = storedObject.deletedOrLocal === '1';\n        return storedObject;\n      }\n      return decodeMetadata(storedObject);\n    }\n\n    // ensure that every metadata has a winningRev and seq,\n    // which was previously created on-the-fly but better to migrate\n    var bySeqStore = txn.objectStore(BY_SEQ_STORE);\n    var docStore = txn.objectStore(DOC_STORE);\n    var cursor = docStore.openCursor();\n    cursor.onsuccess = function (e) {\n      var cursor = e.target.result;\n      if (!cursor) {\n        return; // done\n      }\n      var metadata = decodeMetadataCompat(cursor.value);\n\n      metadata.winningRev = metadata.winningRev ||\n        winningRev(metadata);\n\n      function fetchMetadataSeq() {\n        // metadata.seq was added post-3.2.0, so if it's missing,\n        // we need to fetch it manually\n        var start = metadata.id + '::';\n        var end = metadata.id + '::\\uffff';\n        var req = bySeqStore.index('_doc_id_rev').openCursor(\n          IDBKeyRange.bound(start, end));\n\n        var metadataSeq = 0;\n        req.onsuccess = function (e) {\n          var cursor = e.target.result;\n          if (!cursor) {\n            metadata.seq = metadataSeq;\n            return onGetMetadataSeq();\n          }\n          var seq = cursor.primaryKey;\n          if (seq > metadataSeq) {\n            metadataSeq = seq;\n          }\n          cursor.continue();\n        };\n      }\n\n      function onGetMetadataSeq() {\n        var metadataToStore = encodeMetadata(metadata,\n          metadata.winningRev, metadata.deleted);\n\n        var req = docStore.put(metadataToStore);\n        req.onsuccess = function () {\n          cursor.continue();\n        };\n      }\n\n      if (metadata.seq) {\n        return onGetMetadataSeq();\n      }\n\n      fetchMetadataSeq();\n    };\n\n  }\n\n  api._remote = false;\n  api.type = function () {\n    return 'idb';\n  };\n\n  api._id = toPromise(function (callback) {\n    callback(null, api._meta.instanceId);\n  });\n\n  api._bulkDocs = function idb_bulkDocs(req, reqOpts, callback) {\n    idbBulkDocs(opts, req, reqOpts, api, idb, callback);\n  };\n\n  // First we look up the metadata in the ids database, then we fetch the\n  // current revision(s) from the by sequence store\n  api._get = function idb_get(id, opts, callback) {\n    var doc;\n    var metadata;\n    var err;\n    var txn = opts.ctx;\n    if (!txn) {\n      var txnResult = openTransactionSafely(idb,\n        [DOC_STORE, BY_SEQ_STORE, ATTACH_STORE], 'readonly');\n      if (txnResult.error) {\n        return callback(txnResult.error);\n      }\n      txn = txnResult.txn;\n    }\n\n    function finish() {\n      callback(err, {doc: doc, metadata: metadata, ctx: txn});\n    }\n\n    txn.objectStore(DOC_STORE).get(id).onsuccess = function (e) {\n      metadata = decodeMetadata(e.target.result);\n      // we can determine the result here if:\n      // 1. there is no such document\n      // 2. the document is deleted and we don't ask about specific rev\n      // When we ask with opts.rev we expect the answer to be either\n      // doc (possibly with _deleted=true) or missing error\n      if (!metadata) {\n        err = createError(MISSING_DOC, 'missing');\n        return finish();\n      }\n\n      var rev$$1;\n      if (!opts.rev) {\n        rev$$1 = metadata.winningRev;\n        var deleted = isDeleted(metadata);\n        if (deleted) {\n          err = createError(MISSING_DOC, \"deleted\");\n          return finish();\n        }\n      } else {\n        rev$$1 = opts.latest ? latest(opts.rev, metadata) : opts.rev;\n      }\n\n      var objectStore = txn.objectStore(BY_SEQ_STORE);\n      var key = metadata.id + '::' + rev$$1;\n\n      objectStore.index('_doc_id_rev').get(key).onsuccess = function (e) {\n        doc = e.target.result;\n        if (doc) {\n          doc = decodeDoc(doc);\n        }\n        if (!doc) {\n          err = createError(MISSING_DOC, 'missing');\n          return finish();\n        }\n        finish();\n      };\n    };\n  };\n\n  api._getAttachment = function (docId, attachId, attachment, opts, callback) {\n    var txn;\n    if (opts.ctx) {\n      txn = opts.ctx;\n    } else {\n      var txnResult = openTransactionSafely(idb,\n        [DOC_STORE, BY_SEQ_STORE, ATTACH_STORE], 'readonly');\n      if (txnResult.error) {\n        return callback(txnResult.error);\n      }\n      txn = txnResult.txn;\n    }\n    var digest = attachment.digest;\n    var type = attachment.content_type;\n\n    txn.objectStore(ATTACH_STORE).get(digest).onsuccess = function (e) {\n      var body = e.target.result.body;\n      readBlobData(body, type, opts.binary, function (blobData) {\n        callback(null, blobData);\n      });\n    };\n  };\n\n  api._info = function idb_info(callback) {\n    var updateSeq;\n    var docCount;\n\n    var txnResult = openTransactionSafely(idb, [META_STORE, BY_SEQ_STORE], 'readonly');\n    if (txnResult.error) {\n      return callback(txnResult.error);\n    }\n    var txn = txnResult.txn;\n    txn.objectStore(META_STORE).get(META_STORE).onsuccess = function (e) {\n      docCount = e.target.result.docCount;\n    };\n    txn.objectStore(BY_SEQ_STORE).openCursor(null, 'prev').onsuccess = function (e) {\n      var cursor = e.target.result;\n      updateSeq = cursor ? cursor.key : 0;\n    };\n\n    txn.oncomplete = function () {\n      callback(null, {\n        doc_count: docCount,\n        update_seq: updateSeq,\n        // for debugging\n        idb_attachment_format: (api._meta.blobSupport ? 'binary' : 'base64')\n      });\n    };\n  };\n\n  api._allDocs = function idb_allDocs(opts, callback) {\n    idbAllDocs(opts, idb, callback);\n  };\n\n  api._changes = function idbChanges(opts) {\n    return changes(opts, api, dbName, idb);\n  };\n\n  api._close = function (callback) {\n    // https://developer.mozilla.org/en-US/docs/IndexedDB/IDBDatabase#close\n    // \"Returns immediately and closes the connection in a separate thread...\"\n    idb.close();\n    cachedDBs.delete(dbName);\n    callback();\n  };\n\n  api._getRevisionTree = function (docId, callback) {\n    var txnResult = openTransactionSafely(idb, [DOC_STORE], 'readonly');\n    if (txnResult.error) {\n      return callback(txnResult.error);\n    }\n    var txn = txnResult.txn;\n    var req = txn.objectStore(DOC_STORE).get(docId);\n    req.onsuccess = function (event) {\n      var doc = decodeMetadata(event.target.result);\n      if (!doc) {\n        callback(createError(MISSING_DOC));\n      } else {\n        callback(null, doc.rev_tree);\n      }\n    };\n  };\n\n  // This function removes revisions of document docId\n  // which are listed in revs and sets this document\n  // revision to to rev_tree\n  api._doCompaction = function (docId, revs, callback) {\n    var stores = [\n      DOC_STORE,\n      BY_SEQ_STORE,\n      ATTACH_STORE,\n      ATTACH_AND_SEQ_STORE\n    ];\n    var txnResult = openTransactionSafely(idb, stores, 'readwrite');\n    if (txnResult.error) {\n      return callback(txnResult.error);\n    }\n    var txn = txnResult.txn;\n\n    var docStore = txn.objectStore(DOC_STORE);\n\n    docStore.get(docId).onsuccess = function (event) {\n      var metadata = decodeMetadata(event.target.result);\n      traverseRevTree(metadata.rev_tree, function (isLeaf, pos,\n                                                         revHash, ctx, opts) {\n        var rev$$1 = pos + '-' + revHash;\n        if (revs.indexOf(rev$$1) !== -1) {\n          opts.status = 'missing';\n        }\n      });\n      compactRevs(revs, docId, txn);\n      var winningRev$$1 = metadata.winningRev;\n      var deleted = metadata.deleted;\n      txn.objectStore(DOC_STORE).put(\n        encodeMetadata(metadata, winningRev$$1, deleted));\n    };\n    txn.onabort = idbError(callback);\n    txn.oncomplete = function () {\n      callback();\n    };\n  };\n\n\n  api._getLocal = function (id, callback) {\n    var txnResult = openTransactionSafely(idb, [LOCAL_STORE], 'readonly');\n    if (txnResult.error) {\n      return callback(txnResult.error);\n    }\n    var tx = txnResult.txn;\n    var req = tx.objectStore(LOCAL_STORE).get(id);\n\n    req.onerror = idbError(callback);\n    req.onsuccess = function (e) {\n      var doc = e.target.result;\n      if (!doc) {\n        callback(createError(MISSING_DOC));\n      } else {\n        delete doc['_doc_id_rev']; // for backwards compat\n        callback(null, doc);\n      }\n    };\n  };\n\n  api._putLocal = function (doc, opts, callback) {\n    if (typeof opts === 'function') {\n      callback = opts;\n      opts = {};\n    }\n    delete doc._revisions; // ignore this, trust the rev\n    var oldRev = doc._rev;\n    var id = doc._id;\n    if (!oldRev) {\n      doc._rev = '0-1';\n    } else {\n      doc._rev = '0-' + (parseInt(oldRev.split('-')[1], 10) + 1);\n    }\n\n    var tx = opts.ctx;\n    var ret;\n    if (!tx) {\n      var txnResult = openTransactionSafely(idb, [LOCAL_STORE], 'readwrite');\n      if (txnResult.error) {\n        return callback(txnResult.error);\n      }\n      tx = txnResult.txn;\n      tx.onerror = idbError(callback);\n      tx.oncomplete = function () {\n        if (ret) {\n          callback(null, ret);\n        }\n      };\n    }\n\n    var oStore = tx.objectStore(LOCAL_STORE);\n    var req;\n    if (oldRev) {\n      req = oStore.get(id);\n      req.onsuccess = function (e) {\n        var oldDoc = e.target.result;\n        if (!oldDoc || oldDoc._rev !== oldRev) {\n          callback(createError(REV_CONFLICT));\n        } else { // update\n          var req = oStore.put(doc);\n          req.onsuccess = function () {\n            ret = {ok: true, id: doc._id, rev: doc._rev};\n            if (opts.ctx) { // return immediately\n              callback(null, ret);\n            }\n          };\n        }\n      };\n    } else { // new doc\n      req = oStore.add(doc);\n      req.onerror = function (e) {\n        // constraint error, already exists\n        callback(createError(REV_CONFLICT));\n        e.preventDefault(); // avoid transaction abort\n        e.stopPropagation(); // avoid transaction onerror\n      };\n      req.onsuccess = function () {\n        ret = {ok: true, id: doc._id, rev: doc._rev};\n        if (opts.ctx) { // return immediately\n          callback(null, ret);\n        }\n      };\n    }\n  };\n\n  api._removeLocal = function (doc, opts, callback) {\n    if (typeof opts === 'function') {\n      callback = opts;\n      opts = {};\n    }\n    var tx = opts.ctx;\n    if (!tx) {\n      var txnResult = openTransactionSafely(idb, [LOCAL_STORE], 'readwrite');\n      if (txnResult.error) {\n        return callback(txnResult.error);\n      }\n      tx = txnResult.txn;\n      tx.oncomplete = function () {\n        if (ret) {\n          callback(null, ret);\n        }\n      };\n    }\n    var ret;\n    var id = doc._id;\n    var oStore = tx.objectStore(LOCAL_STORE);\n    var req = oStore.get(id);\n\n    req.onerror = idbError(callback);\n    req.onsuccess = function (e) {\n      var oldDoc = e.target.result;\n      if (!oldDoc || oldDoc._rev !== doc._rev) {\n        callback(createError(MISSING_DOC));\n      } else {\n        oStore.delete(id);\n        ret = {ok: true, id: id, rev: '0-0'};\n        if (opts.ctx) { // return immediately\n          callback(null, ret);\n        }\n      }\n    };\n  };\n\n  api._destroy = function (opts, callback) {\n    changesHandler.removeAllListeners(dbName);\n\n    //Close open request for \"dbName\" database to fix ie delay.\n    var openReq = openReqList.get(dbName);\n    if (openReq && openReq.result) {\n      openReq.result.close();\n      cachedDBs.delete(dbName);\n    }\n    var req = indexedDB.deleteDatabase(dbName);\n\n    req.onsuccess = function () {\n      //Remove open request from the list.\n      openReqList.delete(dbName);\n      if (hasLocalStorage() && (dbName in localStorage)) {\n        delete localStorage[dbName];\n      }\n      callback(null, { 'ok': true });\n    };\n\n    req.onerror = idbError(callback);\n  };\n\n  var cached = cachedDBs.get(dbName);\n\n  if (cached) {\n    idb = cached.idb;\n    api._meta = cached.global;\n    return immediate(function () {\n      callback(null, api);\n    });\n  }\n\n  var req = indexedDB.open(dbName, ADAPTER_VERSION);\n  openReqList.set(dbName, req);\n\n  req.onupgradeneeded = function (e) {\n    var db = e.target.result;\n    if (e.oldVersion < 1) {\n      return createSchema(db); // new db, initial schema\n    }\n    // do migrations\n\n    var txn = e.currentTarget.transaction;\n    // these migrations have to be done in this function, before\n    // control is returned to the event loop, because IndexedDB\n\n    if (e.oldVersion < 3) {\n      createLocalStoreSchema(db); // v2 -> v3\n    }\n    if (e.oldVersion < 4) {\n      addAttachAndSeqStore(db); // v3 -> v4\n    }\n\n    var migrations = [\n      addDeletedOrLocalIndex, // v1 -> v2\n      migrateLocalStore,      // v2 -> v3\n      migrateAttsAndSeqs,     // v3 -> v4\n      migrateMetadata         // v4 -> v5\n    ];\n\n    var i = e.oldVersion;\n\n    function next() {\n      var migration = migrations[i - 1];\n      i++;\n      if (migration) {\n        migration(txn, next);\n      }\n    }\n\n    next();\n  };\n\n  req.onsuccess = function (e) {\n\n    idb = e.target.result;\n\n    idb.onversionchange = function () {\n      idb.close();\n      cachedDBs.delete(dbName);\n    };\n\n    idb.onabort = function (e) {\n      guardedConsole('error', 'Database has a global failure', e.target.error);\n      idb.close();\n      cachedDBs.delete(dbName);\n    };\n\n    // Do a few setup operations (in parallel as much as possible):\n    // 1. Fetch meta doc\n    // 2. Check blob support\n    // 3. Calculate docCount\n    // 4. Generate an instanceId if necessary\n    // 5. Store docCount and instanceId on meta doc\n\n    var txn = idb.transaction([\n      META_STORE,\n      DETECT_BLOB_SUPPORT_STORE,\n      DOC_STORE\n    ], 'readwrite');\n\n    var storedMetaDoc = false;\n    var metaDoc;\n    var docCount;\n    var blobSupport;\n    var instanceId;\n\n    function completeSetup() {\n      if (typeof blobSupport === 'undefined' || !storedMetaDoc) {\n        return;\n      }\n      api._meta = {\n        name: dbName,\n        instanceId: instanceId,\n        blobSupport: blobSupport\n      };\n\n      cachedDBs.set(dbName, {\n        idb: idb,\n        global: api._meta\n      });\n      callback(null, api);\n    }\n\n    function storeMetaDocIfReady() {\n      if (typeof docCount === 'undefined' || typeof metaDoc === 'undefined') {\n        return;\n      }\n      var instanceKey = dbName + '_id';\n      if (instanceKey in metaDoc) {\n        instanceId = metaDoc[instanceKey];\n      } else {\n        metaDoc[instanceKey] = instanceId = uuid();\n      }\n      metaDoc.docCount = docCount;\n      txn.objectStore(META_STORE).put(metaDoc);\n    }\n\n    //\n    // fetch or generate the instanceId\n    //\n    txn.objectStore(META_STORE).get(META_STORE).onsuccess = function (e) {\n      metaDoc = e.target.result || { id: META_STORE };\n      storeMetaDocIfReady();\n    };\n\n    //\n    // countDocs\n    //\n    countDocs(txn, function (count) {\n      docCount = count;\n      storeMetaDocIfReady();\n    });\n\n    //\n    // check blob support\n    //\n    if (!blobSupportPromise) {\n      // make sure blob support is only checked once\n      blobSupportPromise = checkBlobSupport(txn);\n    }\n\n    blobSupportPromise.then(function (val) {\n      blobSupport = val;\n      completeSetup();\n    });\n\n    // only when the metadata put transaction has completed,\n    // consider the setup done\n    txn.oncomplete = function () {\n      storedMetaDoc = true;\n      completeSetup();\n    };\n    txn.onabort = idbError(callback);\n  };\n\n  req.onerror = function (e) {\n    var msg = e.target.error && e.target.error.message;\n\n    if (!msg) {\n      msg = 'Failed to open indexedDB, are you in private browsing mode?';\n    } else if (msg.indexOf(\"stored database is a higher version\") !== -1) {\n      msg = new Error('This DB was created with the newer \"indexeddb\" adapter, but you are trying to open it with the older \"idb\" adapter');\n    }\n\n    guardedConsole('error', msg);\n    callback(createError(IDB_ERROR, msg));\n  };\n}\n\nIdbPouch.valid = function () {\n  // Following #7085 buggy idb versions (typically Safari < 10.1) are\n  // considered valid.\n\n  // On Firefox SecurityError is thrown while referencing indexedDB if cookies\n  // are not allowed. `typeof indexedDB` also triggers the error.\n  try {\n    // some outdated implementations of IDB that appear on Samsung\n    // and HTC Android devices <4.4 are missing IDBKeyRange\n    return typeof indexedDB !== 'undefined' && typeof IDBKeyRange !== 'undefined';\n  } catch (e) {\n    return false;\n  }\n};\n\nfunction IDBPouch (PouchDB) {\n  PouchDB.adapter('idb', IdbPouch, true);\n}\n\n// dead simple promise pool, inspired by https://github.com/timdp/es6-promise-pool\n// but much smaller in code size. limits the number of concurrent promises that are executed\n\n\nfunction pool(promiseFactories, limit) {\n  return new Promise(function (resolve, reject) {\n    var running = 0;\n    var current = 0;\n    var done = 0;\n    var len = promiseFactories.length;\n    var err;\n\n    function runNext() {\n      running++;\n      promiseFactories[current++]().then(onSuccess, onError);\n    }\n\n    function doNext() {\n      if (++done === len) {\n        /* istanbul ignore if */\n        if (err) {\n          reject(err);\n        } else {\n          resolve();\n        }\n      } else {\n        runNextBatch();\n      }\n    }\n\n    function onSuccess() {\n      running--;\n      doNext();\n    }\n\n    /* istanbul ignore next */\n    function onError(thisErr) {\n      running--;\n      err = err || thisErr;\n      doNext();\n    }\n\n    function runNextBatch() {\n      while (running < limit && current < len) {\n        runNext();\n      }\n    }\n\n    runNextBatch();\n  });\n}\n\nvar CHANGES_BATCH_SIZE = 25;\nvar MAX_SIMULTANEOUS_REVS = 50;\nvar CHANGES_TIMEOUT_BUFFER = 5000;\nvar DEFAULT_HEARTBEAT = 10000;\n\nvar supportsBulkGetMap = {};\n\nfunction readAttachmentsAsBlobOrBuffer(row) {\n  var doc = row.doc || row.ok;\n  var atts = doc && doc._attachments;\n  if (!atts) {\n    return;\n  }\n  Object.keys(atts).forEach(function (filename) {\n    var att = atts[filename];\n    att.data = b64ToBluffer(att.data, att.content_type);\n  });\n}\n\nfunction encodeDocId(id) {\n  if (/^_design/.test(id)) {\n    return '_design/' + encodeURIComponent(id.slice(8));\n  }\n  if (/^_local/.test(id)) {\n    return '_local/' + encodeURIComponent(id.slice(7));\n  }\n  return encodeURIComponent(id);\n}\n\nfunction preprocessAttachments$1(doc) {\n  if (!doc._attachments || !Object.keys(doc._attachments)) {\n    return Promise.resolve();\n  }\n\n  return Promise.all(Object.keys(doc._attachments).map(function (key) {\n    var attachment = doc._attachments[key];\n    if (attachment.data && typeof attachment.data !== 'string') {\n      return new Promise(function (resolve) {\n        blobToBase64(attachment.data, resolve);\n      }).then(function (b64) {\n        attachment.data = b64;\n      });\n    }\n  }));\n}\n\nfunction hasUrlPrefix(opts) {\n  if (!opts.prefix) {\n    return false;\n  }\n  var protocol = parseUri(opts.prefix).protocol;\n  return protocol === 'http' || protocol === 'https';\n}\n\n// Get all the information you possibly can about the URI given by name and\n// return it as a suitable object.\nfunction getHost(name, opts) {\n  // encode db name if opts.prefix is a url (#5574)\n  if (hasUrlPrefix(opts)) {\n    var dbName = opts.name.substr(opts.prefix.length);\n    // Ensure prefix has a trailing slash\n    var prefix = opts.prefix.replace(/\\/?$/, '/');\n    name = prefix + encodeURIComponent(dbName);\n  }\n\n  var uri = parseUri(name);\n  if (uri.user || uri.password) {\n    uri.auth = {username: uri.user, password: uri.password};\n  }\n\n  // Split the path part of the URI into parts using '/' as the delimiter\n  // after removing any leading '/' and any trailing '/'\n  var parts = uri.path.replace(/(^\\/|\\/$)/g, '').split('/');\n\n  uri.db = parts.pop();\n  // Prevent double encoding of URI component\n  if (uri.db.indexOf('%') === -1) {\n    uri.db = encodeURIComponent(uri.db);\n  }\n\n  uri.path = parts.join('/');\n\n  return uri;\n}\n\n// Generate a URL with the host data given by opts and the given path\nfunction genDBUrl(opts, path) {\n  return genUrl(opts, opts.db + '/' + path);\n}\n\n// Generate a URL with the host data given by opts and the given path\nfunction genUrl(opts, path) {\n  // If the host already has a path, then we need to have a path delimiter\n  // Otherwise, the path delimiter is the empty string\n  var pathDel = !opts.path ? '' : '/';\n\n  // If the host already has a path, then we need to have a path delimiter\n  // Otherwise, the path delimiter is the empty string\n  return opts.protocol + '://' + opts.host +\n         (opts.port ? (':' + opts.port) : '') +\n         '/' + opts.path + pathDel + path;\n}\n\nfunction paramsToStr(params) {\n  return '?' + Object.keys(params).map(function (k) {\n    return k + '=' + encodeURIComponent(params[k]);\n  }).join('&');\n}\n\nfunction shouldCacheBust(opts) {\n  var ua = (typeof navigator !== 'undefined' && navigator.userAgent) ?\n      navigator.userAgent.toLowerCase() : '';\n  var isIE = ua.indexOf('msie') !== -1;\n  var isTrident = ua.indexOf('trident') !== -1;\n  var isEdge = ua.indexOf('edge') !== -1;\n  var isGET = !('method' in opts) || opts.method === 'GET';\n  return (isIE || isTrident || isEdge) && isGET;\n}\n\n// Implements the PouchDB API for dealing with CouchDB instances over HTTP\nfunction HttpPouch(opts, callback) {\n\n  // The functions that will be publicly available for HttpPouch\n  var api = this;\n\n  var host = getHost(opts.name, opts);\n  var dbUrl = genDBUrl(host, '');\n\n  opts = clone(opts);\n\n  var ourFetch = function (url, options) {\n\n    options = options || {};\n    options.headers = options.headers || new h();\n\n    options.credentials = 'include';\n\n    if (opts.auth || host.auth) {\n      var nAuth = opts.auth || host.auth;\n      var str = nAuth.username + ':' + nAuth.password;\n      var token = thisBtoa(unescape(encodeURIComponent(str)));\n      options.headers.set('Authorization', 'Basic ' + token);\n    }\n\n    var headers = opts.headers || {};\n    Object.keys(headers).forEach(function (key) {\n      options.headers.append(key, headers[key]);\n    });\n\n    /* istanbul ignore if */\n    if (shouldCacheBust(options)) {\n      url += (url.indexOf('?') === -1 ? '?' : '&') + '_nonce=' + Date.now();\n    }\n\n    var fetchFun = opts.fetch || f$1;\n    return fetchFun(url, options);\n  };\n\n  function adapterFun$$1(name, fun) {\n    return adapterFun(name, getArguments(function (args) {\n      setup().then(function () {\n        return fun.apply(this, args);\n      }).catch(function (e) {\n        var callback = args.pop();\n        callback(e);\n      });\n    })).bind(api);\n  }\n\n  function fetchJSON(url, options, callback) {\n\n    var result = {};\n\n    options = options || {};\n    options.headers = options.headers || new h();\n\n    if (!options.headers.get('Content-Type')) {\n      options.headers.set('Content-Type', 'application/json');\n    }\n    if (!options.headers.get('Accept')) {\n      options.headers.set('Accept', 'application/json');\n    }\n\n    return ourFetch(url, options).then(function (response) {\n      result.ok = response.ok;\n      result.status = response.status;\n      return response.json();\n    }).then(function (json) {\n      result.data = json;\n      if (!result.ok) {\n        result.data.status = result.status;\n        var err = generateErrorFromResponse(result.data);\n        if (callback) {\n          return callback(err);\n        } else {\n          throw err;\n        }\n      }\n\n      if (Array.isArray(result.data)) {\n        result.data = result.data.map(function (v) {\n          if (v.error || v.missing) {\n            return generateErrorFromResponse(v);\n          } else {\n            return v;\n          }\n        });\n      }\n\n      if (callback) {\n        callback(null, result.data);\n      } else {\n        return result;\n      }\n    });\n  }\n\n  var setupPromise;\n\n  function setup() {\n    if (opts.skip_setup) {\n      return Promise.resolve();\n    }\n\n    // If there is a setup in process or previous successful setup\n    // done then we will use that\n    // If previous setups have been rejected we will try again\n    if (setupPromise) {\n      return setupPromise;\n    }\n\n    setupPromise = fetchJSON(dbUrl).catch(function (err) {\n      if (err && err.status && err.status === 404) {\n        // Doesnt exist, create it\n        explainError(404, 'PouchDB is just detecting if the remote exists.');\n        return fetchJSON(dbUrl, {method: 'PUT'});\n      } else {\n        return Promise.reject(err);\n      }\n    }).catch(function (err) {\n      // If we try to create a database that already exists, skipped in\n      // istanbul since its catching a race condition.\n      /* istanbul ignore if */\n      if (err && err.status && err.status === 412) {\n        return true;\n      }\n      return Promise.reject(err);\n    });\n\n    setupPromise.catch(function () {\n      setupPromise = null;\n    });\n\n    return setupPromise;\n  }\n\n  immediate(function () {\n    callback(null, api);\n  });\n\n  api._remote = true;\n\n  /* istanbul ignore next */\n  api.type = function () {\n    return 'http';\n  };\n\n  api.id = adapterFun$$1('id', function (callback) {\n    ourFetch(genUrl(host, '')).then(function (response) {\n      return response.json();\n    }).catch(function () {\n      return {};\n    }).then(function (result) {\n      // Bad response or missing `uuid` should not prevent ID generation.\n      var uuid$$1 = (result && result.uuid) ?\n          (result.uuid + host.db) : genDBUrl(host, '');\n      callback(null, uuid$$1);\n    });\n  });\n\n  // Sends a POST request to the host calling the couchdb _compact function\n  //    version: The version of CouchDB it is running\n  api.compact = adapterFun$$1('compact', function (opts, callback) {\n    if (typeof opts === 'function') {\n      callback = opts;\n      opts = {};\n    }\n    opts = clone(opts);\n\n    fetchJSON(genDBUrl(host, '_compact'), {method: 'POST'}).then(function () {\n      function ping() {\n        api.info(function (err, res) {\n          // CouchDB may send a \"compact_running:true\" if it's\n          // already compacting. PouchDB Server doesn't.\n          /* istanbul ignore else */\n          if (res && !res.compact_running) {\n            callback(null, {ok: true});\n          } else {\n            setTimeout(ping, opts.interval || 200);\n          }\n        });\n      }\n      // Ping the http if it's finished compaction\n      ping();\n    });\n  });\n\n  api.bulkGet = adapterFun('bulkGet', function (opts, callback) {\n    var self = this;\n\n    function doBulkGet(cb) {\n      var params = {};\n      if (opts.revs) {\n        params.revs = true;\n      }\n      if (opts.attachments) {\n        /* istanbul ignore next */\n        params.attachments = true;\n      }\n      if (opts.latest) {\n        params.latest = true;\n      }\n      fetchJSON(genDBUrl(host, '_bulk_get' + paramsToStr(params)), {\n        method: 'POST',\n        body: JSON.stringify({ docs: opts.docs})\n      }).then(function (result) {\n        if (opts.attachments && opts.binary) {\n          result.data.results.forEach(function (res) {\n            res.docs.forEach(readAttachmentsAsBlobOrBuffer);\n          });\n        }\n        cb(null, result.data);\n      }).catch(cb);\n    }\n\n    /* istanbul ignore next */\n    function doBulkGetShim() {\n      // avoid \"url too long error\" by splitting up into multiple requests\n      var batchSize = MAX_SIMULTANEOUS_REVS;\n      var numBatches = Math.ceil(opts.docs.length / batchSize);\n      var numDone = 0;\n      var results = new Array(numBatches);\n\n      function onResult(batchNum) {\n        return function (err, res) {\n          // err is impossible because shim returns a list of errs in that case\n          results[batchNum] = res.results;\n          if (++numDone === numBatches) {\n            callback(null, {results: flatten(results)});\n          }\n        };\n      }\n\n      for (var i = 0; i < numBatches; i++) {\n        var subOpts = pick(opts, ['revs', 'attachments', 'binary', 'latest']);\n        subOpts.docs = opts.docs.slice(i * batchSize,\n          Math.min(opts.docs.length, (i + 1) * batchSize));\n        bulkGet(self, subOpts, onResult(i));\n      }\n    }\n\n    // mark the whole database as either supporting or not supporting _bulk_get\n    var dbUrl = genUrl(host, '');\n    var supportsBulkGet = supportsBulkGetMap[dbUrl];\n\n    /* istanbul ignore next */\n    if (typeof supportsBulkGet !== 'boolean') {\n      // check if this database supports _bulk_get\n      doBulkGet(function (err, res) {\n        if (err) {\n          supportsBulkGetMap[dbUrl] = false;\n          explainError(\n            err.status,\n            'PouchDB is just detecting if the remote ' +\n            'supports the _bulk_get API.'\n          );\n          doBulkGetShim();\n        } else {\n          supportsBulkGetMap[dbUrl] = true;\n          callback(null, res);\n        }\n      });\n    } else if (supportsBulkGet) {\n      doBulkGet(callback);\n    } else {\n      doBulkGetShim();\n    }\n  });\n\n  // Calls GET on the host, which gets back a JSON string containing\n  //    couchdb: A welcome string\n  //    version: The version of CouchDB it is running\n  api._info = function (callback) {\n    setup().then(function () {\n      return ourFetch(genDBUrl(host, ''));\n    }).then(function (response) {\n      return response.json();\n    }).then(function (info) {\n      info.host = genDBUrl(host, '');\n      callback(null, info);\n    }).catch(callback);\n  };\n\n  api.fetch = function (path, options) {\n    return setup().then(function () {\n      var url = path.substring(0, 1) === '/' ?\n        genUrl(host, path.substring(1)) :\n        genDBUrl(host, path);\n      return ourFetch(url, options);\n    });\n  };\n\n  // Get the document with the given id from the database given by host.\n  // The id could be solely the _id in the database, or it may be a\n  // _design/ID or _local/ID path\n  api.get = adapterFun$$1('get', function (id, opts, callback) {\n    // If no options were given, set the callback to the second parameter\n    if (typeof opts === 'function') {\n      callback = opts;\n      opts = {};\n    }\n    opts = clone(opts);\n\n    // List of parameters to add to the GET request\n    var params = {};\n\n    if (opts.revs) {\n      params.revs = true;\n    }\n\n    if (opts.revs_info) {\n      params.revs_info = true;\n    }\n\n    if (opts.latest) {\n      params.latest = true;\n    }\n\n    if (opts.open_revs) {\n      if (opts.open_revs !== \"all\") {\n        opts.open_revs = JSON.stringify(opts.open_revs);\n      }\n      params.open_revs = opts.open_revs;\n    }\n\n    if (opts.rev) {\n      params.rev = opts.rev;\n    }\n\n    if (opts.conflicts) {\n      params.conflicts = opts.conflicts;\n    }\n\n    /* istanbul ignore if */\n    if (opts.update_seq) {\n      params.update_seq = opts.update_seq;\n    }\n\n    id = encodeDocId(id);\n\n    function fetchAttachments(doc) {\n      var atts = doc._attachments;\n      var filenames = atts && Object.keys(atts);\n      if (!atts || !filenames.length) {\n        return;\n      }\n      // we fetch these manually in separate XHRs, because\n      // Sync Gateway would normally send it back as multipart/mixed,\n      // which we cannot parse. Also, this is more efficient than\n      // receiving attachments as base64-encoded strings.\n      function fetchData(filename) {\n        var att = atts[filename];\n        var path = encodeDocId(doc._id) + '/' + encodeAttachmentId(filename) +\n            '?rev=' + doc._rev;\n        return ourFetch(genDBUrl(host, path)).then(function (response) {\n          if ('buffer' in response) {\n            return response.buffer();\n          } else {\n            /* istanbul ignore next */\n            return response.blob();\n          }\n        }).then(function (blob) {\n          if (opts.binary) {\n            var typeFieldDescriptor = Object.getOwnPropertyDescriptor(blob.__proto__, 'type');\n            if (!typeFieldDescriptor || typeFieldDescriptor.set) {\n              blob.type = att.content_type;\n            }\n            return blob;\n          }\n          return new Promise(function (resolve) {\n            blobToBase64(blob, resolve);\n          });\n        }).then(function (data) {\n          delete att.stub;\n          delete att.length;\n          att.data = data;\n        });\n      }\n\n      var promiseFactories = filenames.map(function (filename) {\n        return function () {\n          return fetchData(filename);\n        };\n      });\n\n      // This limits the number of parallel xhr requests to 5 any time\n      // to avoid issues with maximum browser request limits\n      return pool(promiseFactories, 5);\n    }\n\n    function fetchAllAttachments(docOrDocs) {\n      if (Array.isArray(docOrDocs)) {\n        return Promise.all(docOrDocs.map(function (doc) {\n          if (doc.ok) {\n            return fetchAttachments(doc.ok);\n          }\n        }));\n      }\n      return fetchAttachments(docOrDocs);\n    }\n\n    var url = genDBUrl(host, id + paramsToStr(params));\n    fetchJSON(url).then(function (res) {\n      return Promise.resolve().then(function () {\n        if (opts.attachments) {\n          return fetchAllAttachments(res.data);\n        }\n      }).then(function () {\n        callback(null, res.data);\n      });\n    }).catch(function (e) {\n      e.docId = id;\n      callback(e);\n    });\n  });\n\n\n  // Delete the document given by doc from the database given by host.\n  api.remove = adapterFun$$1('remove', function (docOrId, optsOrRev, opts, cb) {\n    var doc;\n    if (typeof optsOrRev === 'string') {\n      // id, rev, opts, callback style\n      doc = {\n        _id: docOrId,\n        _rev: optsOrRev\n      };\n      if (typeof opts === 'function') {\n        cb = opts;\n        opts = {};\n      }\n    } else {\n      // doc, opts, callback style\n      doc = docOrId;\n      if (typeof optsOrRev === 'function') {\n        cb = optsOrRev;\n        opts = {};\n      } else {\n        cb = opts;\n        opts = optsOrRev;\n      }\n    }\n\n    var rev$$1 = (doc._rev || opts.rev);\n    var url = genDBUrl(host, encodeDocId(doc._id)) + '?rev=' + rev$$1;\n\n    fetchJSON(url, {method: 'DELETE'}, cb).catch(cb);\n  });\n\n  function encodeAttachmentId(attachmentId) {\n    return attachmentId.split(\"/\").map(encodeURIComponent).join(\"/\");\n  }\n\n  // Get the attachment\n  api.getAttachment = adapterFun$$1('getAttachment', function (docId, attachmentId,\n                                                            opts, callback) {\n    if (typeof opts === 'function') {\n      callback = opts;\n      opts = {};\n    }\n    var params = opts.rev ? ('?rev=' + opts.rev) : '';\n    var url = genDBUrl(host, encodeDocId(docId)) + '/' +\n        encodeAttachmentId(attachmentId) + params;\n    var contentType;\n    ourFetch(url, {method: 'GET'}).then(function (response) {\n      contentType = response.headers.get('content-type');\n      if (!response.ok) {\n        throw response;\n      } else {\n        if (typeof process !== 'undefined' && !process.browser && typeof response.buffer === 'function') {\n          return response.buffer();\n        } else {\n          /* istanbul ignore next */\n          return response.blob();\n        }\n      }\n    }).then(function (blob) {\n      // TODO: also remove\n      if (typeof process !== 'undefined' && !process.browser) {\n        blob.type = contentType;\n      }\n      callback(null, blob);\n    }).catch(function (err) {\n      callback(err);\n    });\n  });\n\n  // Remove the attachment given by the id and rev\n  api.removeAttachment =  adapterFun$$1('removeAttachment', function (docId,\n                                                                   attachmentId,\n                                                                   rev$$1,\n                                                                   callback) {\n    var url = genDBUrl(host, encodeDocId(docId) + '/' +\n                       encodeAttachmentId(attachmentId)) + '?rev=' + rev$$1;\n    fetchJSON(url, {method: 'DELETE'}, callback).catch(callback);\n  });\n\n  // Add the attachment given by blob and its contentType property\n  // to the document with the given id, the revision given by rev, and\n  // add it to the database given by host.\n  api.putAttachment = adapterFun$$1('putAttachment', function (docId, attachmentId,\n                                                            rev$$1, blob,\n                                                            type, callback) {\n    if (typeof type === 'function') {\n      callback = type;\n      type = blob;\n      blob = rev$$1;\n      rev$$1 = null;\n    }\n    var id = encodeDocId(docId) + '/' + encodeAttachmentId(attachmentId);\n    var url = genDBUrl(host, id);\n    if (rev$$1) {\n      url += '?rev=' + rev$$1;\n    }\n\n    if (typeof blob === 'string') {\n      // input is assumed to be a base64 string\n      var binary;\n      try {\n        binary = thisAtob(blob);\n      } catch (err) {\n        return callback(createError(BAD_ARG,\n                        'Attachment is not a valid base64 string'));\n      }\n      blob = binary ? binStringToBluffer(binary, type) : '';\n    }\n\n    // Add the attachment\n    fetchJSON(url, {\n      headers: new h({'Content-Type': type}),\n      method: 'PUT',\n      body: blob\n    }, callback).catch(callback);\n  });\n\n  // Update/create multiple documents given by req in the database\n  // given by host.\n  api._bulkDocs = function (req, opts, callback) {\n    // If new_edits=false then it prevents the database from creating\n    // new revision numbers for the documents. Instead it just uses\n    // the old ones. This is used in database replication.\n    req.new_edits = opts.new_edits;\n\n    setup().then(function () {\n      return Promise.all(req.docs.map(preprocessAttachments$1));\n    }).then(function () {\n      // Update/create the documents\n      return fetchJSON(genDBUrl(host, '_bulk_docs'), {\n        method: 'POST',\n        body: JSON.stringify(req)\n      }, callback);\n    }).catch(callback);\n  };\n\n\n  // Update/create document\n  api._put = function (doc, opts, callback) {\n    setup().then(function () {\n      return preprocessAttachments$1(doc);\n    }).then(function () {\n      return fetchJSON(genDBUrl(host, encodeDocId(doc._id)), {\n        method: 'PUT',\n        body: JSON.stringify(doc)\n      });\n    }).then(function (result) {\n      callback(null, result.data);\n    }).catch(function (err) {\n      err.docId = doc && doc._id;\n      callback(err);\n    });\n  };\n\n\n  // Get a listing of the documents in the database given\n  // by host and ordered by increasing id.\n  api.allDocs = adapterFun$$1('allDocs', function (opts, callback) {\n    if (typeof opts === 'function') {\n      callback = opts;\n      opts = {};\n    }\n    opts = clone(opts);\n\n    // List of parameters to add to the GET request\n    var params = {};\n    var body;\n    var method = 'GET';\n\n    if (opts.conflicts) {\n      params.conflicts = true;\n    }\n\n    /* istanbul ignore if */\n    if (opts.update_seq) {\n      params.update_seq = true;\n    }\n\n    if (opts.descending) {\n      params.descending = true;\n    }\n\n    if (opts.include_docs) {\n      params.include_docs = true;\n    }\n\n    // added in CouchDB 1.6.0\n    if (opts.attachments) {\n      params.attachments = true;\n    }\n\n    if (opts.key) {\n      params.key = JSON.stringify(opts.key);\n    }\n\n    if (opts.start_key) {\n      opts.startkey = opts.start_key;\n    }\n\n    if (opts.startkey) {\n      params.startkey = JSON.stringify(opts.startkey);\n    }\n\n    if (opts.end_key) {\n      opts.endkey = opts.end_key;\n    }\n\n    if (opts.endkey) {\n      params.endkey = JSON.stringify(opts.endkey);\n    }\n\n    if (typeof opts.inclusive_end !== 'undefined') {\n      params.inclusive_end = !!opts.inclusive_end;\n    }\n\n    if (typeof opts.limit !== 'undefined') {\n      params.limit = opts.limit;\n    }\n\n    if (typeof opts.skip !== 'undefined') {\n      params.skip = opts.skip;\n    }\n\n    var paramStr = paramsToStr(params);\n\n    if (typeof opts.keys !== 'undefined') {\n      method = 'POST';\n      body = {keys: opts.keys};\n    }\n\n    fetchJSON(genDBUrl(host, '_all_docs' + paramStr), {\n       method: method,\n      body: JSON.stringify(body)\n    }).then(function (result) {\n      if (opts.include_docs && opts.attachments && opts.binary) {\n        result.data.rows.forEach(readAttachmentsAsBlobOrBuffer);\n      }\n      callback(null, result.data);\n    }).catch(callback);\n  });\n\n  // Get a list of changes made to documents in the database given by host.\n  // TODO According to the README, there should be two other methods here,\n  // api.changes.addListener and api.changes.removeListener.\n  api._changes = function (opts) {\n\n    // We internally page the results of a changes request, this means\n    // if there is a large set of changes to be returned we can start\n    // processing them quicker instead of waiting on the entire\n    // set of changes to return and attempting to process them at once\n    var batchSize = 'batch_size' in opts ? opts.batch_size : CHANGES_BATCH_SIZE;\n\n    opts = clone(opts);\n\n    if (opts.continuous && !('heartbeat' in opts)) {\n      opts.heartbeat = DEFAULT_HEARTBEAT;\n    }\n\n    var requestTimeout = ('timeout' in opts) ? opts.timeout : 30 * 1000;\n\n    // ensure CHANGES_TIMEOUT_BUFFER applies\n    if ('timeout' in opts && opts.timeout &&\n      (requestTimeout - opts.timeout) < CHANGES_TIMEOUT_BUFFER) {\n        requestTimeout = opts.timeout + CHANGES_TIMEOUT_BUFFER;\n    }\n\n    /* istanbul ignore if */\n    if ('heartbeat' in opts && opts.heartbeat &&\n       (requestTimeout - opts.heartbeat) < CHANGES_TIMEOUT_BUFFER) {\n        requestTimeout = opts.heartbeat + CHANGES_TIMEOUT_BUFFER;\n    }\n\n    var params = {};\n    if ('timeout' in opts && opts.timeout) {\n      params.timeout = opts.timeout;\n    }\n\n    var limit = (typeof opts.limit !== 'undefined') ? opts.limit : false;\n    var leftToFetch = limit;\n\n    if (opts.style) {\n      params.style = opts.style;\n    }\n\n    if (opts.include_docs || opts.filter && typeof opts.filter === 'function') {\n      params.include_docs = true;\n    }\n\n    if (opts.attachments) {\n      params.attachments = true;\n    }\n\n    if (opts.continuous) {\n      params.feed = 'longpoll';\n    }\n\n    if (opts.seq_interval) {\n      params.seq_interval = opts.seq_interval;\n    }\n\n    if (opts.conflicts) {\n      params.conflicts = true;\n    }\n\n    if (opts.descending) {\n      params.descending = true;\n    }\n\n    /* istanbul ignore if */\n    if (opts.update_seq) {\n      params.update_seq = true;\n    }\n\n    if ('heartbeat' in opts) {\n      // If the heartbeat value is false, it disables the default heartbeat\n      if (opts.heartbeat) {\n        params.heartbeat = opts.heartbeat;\n      }\n    }\n\n    if (opts.filter && typeof opts.filter === 'string') {\n      params.filter = opts.filter;\n    }\n\n    if (opts.view && typeof opts.view === 'string') {\n      params.filter = '_view';\n      params.view = opts.view;\n    }\n\n    // If opts.query_params exists, pass it through to the changes request.\n    // These parameters may be used by the filter on the source database.\n    if (opts.query_params && typeof opts.query_params === 'object') {\n      for (var param_name in opts.query_params) {\n        /* istanbul ignore else */\n        if (opts.query_params.hasOwnProperty(param_name)) {\n          params[param_name] = opts.query_params[param_name];\n        }\n      }\n    }\n\n    var method = 'GET';\n    var body;\n\n    if (opts.doc_ids) {\n      // set this automagically for the user; it's annoying that couchdb\n      // requires both a \"filter\" and a \"doc_ids\" param.\n      params.filter = '_doc_ids';\n      method = 'POST';\n      body = {doc_ids: opts.doc_ids };\n    }\n    /* istanbul ignore next */\n    else if (opts.selector) {\n      // set this automagically for the user, similar to above\n      params.filter = '_selector';\n      method = 'POST';\n      body = {selector: opts.selector };\n    }\n\n    var controller = new a();\n    var lastFetchedSeq;\n\n    // Get all the changes starting wtih the one immediately after the\n    // sequence number given by since.\n    var fetchData = function (since, callback) {\n      if (opts.aborted) {\n        return;\n      }\n      params.since = since;\n      // \"since\" can be any kind of json object in Cloudant/CouchDB 2.x\n      /* istanbul ignore next */\n      if (typeof params.since === \"object\") {\n        params.since = JSON.stringify(params.since);\n      }\n\n      if (opts.descending) {\n        if (limit) {\n          params.limit = leftToFetch;\n        }\n      } else {\n        params.limit = (!limit || leftToFetch > batchSize) ?\n          batchSize : leftToFetch;\n      }\n\n      // Set the options for the ajax call\n      var url = genDBUrl(host, '_changes' + paramsToStr(params));\n      var fetchOpts = {\n        signal: controller.signal,\n        method: method,\n        body: JSON.stringify(body)\n      };\n      lastFetchedSeq = since;\n\n      /* istanbul ignore if */\n      if (opts.aborted) {\n        return;\n      }\n\n      // Get the changes\n      setup().then(function () {\n        return fetchJSON(url, fetchOpts, callback);\n      }).catch(callback);\n    };\n\n    // If opts.since exists, get all the changes from the sequence\n    // number given by opts.since. Otherwise, get all the changes\n    // from the sequence number 0.\n    var results = {results: []};\n\n    var fetched = function (err, res) {\n      if (opts.aborted) {\n        return;\n      }\n      var raw_results_length = 0;\n      // If the result of the ajax call (res) contains changes (res.results)\n      if (res && res.results) {\n        raw_results_length = res.results.length;\n        results.last_seq = res.last_seq;\n        var pending = null;\n        var lastSeq = null;\n        // Attach 'pending' property if server supports it (CouchDB 2.0+)\n        /* istanbul ignore if */\n        if (typeof res.pending === 'number') {\n          pending = res.pending;\n        }\n        if (typeof results.last_seq === 'string' || typeof results.last_seq === 'number') {\n          lastSeq = results.last_seq;\n        }\n        // For each change\n        var req = {};\n        req.query = opts.query_params;\n        res.results = res.results.filter(function (c) {\n          leftToFetch--;\n          var ret = filterChange(opts)(c);\n          if (ret) {\n            if (opts.include_docs && opts.attachments && opts.binary) {\n              readAttachmentsAsBlobOrBuffer(c);\n            }\n            if (opts.return_docs) {\n              results.results.push(c);\n            }\n            opts.onChange(c, pending, lastSeq);\n          }\n          return ret;\n        });\n      } else if (err) {\n        // In case of an error, stop listening for changes and call\n        // opts.complete\n        opts.aborted = true;\n        opts.complete(err);\n        return;\n      }\n\n      // The changes feed may have timed out with no results\n      // if so reuse last update sequence\n      if (res && res.last_seq) {\n        lastFetchedSeq = res.last_seq;\n      }\n\n      var finished = (limit && leftToFetch <= 0) ||\n        (res && raw_results_length < batchSize) ||\n        (opts.descending);\n\n      if ((opts.continuous && !(limit && leftToFetch <= 0)) || !finished) {\n        // Queue a call to fetch again with the newest sequence number\n        immediate(function () { fetchData(lastFetchedSeq, fetched); });\n      } else {\n        // We're done, call the callback\n        opts.complete(null, results);\n      }\n    };\n\n    fetchData(opts.since || 0, fetched);\n\n    // Return a method to cancel this method from processing any more\n    return {\n      cancel: function () {\n        opts.aborted = true;\n        controller.abort();\n      }\n    };\n  };\n\n  // Given a set of document/revision IDs (given by req), tets the subset of\n  // those that do NOT correspond to revisions stored in the database.\n  // See http://wiki.apache.org/couchdb/HttpPostRevsDiff\n  api.revsDiff = adapterFun$$1('revsDiff', function (req, opts, callback) {\n    // If no options were given, set the callback to be the second parameter\n    if (typeof opts === 'function') {\n      callback = opts;\n      opts = {};\n    }\n\n    // Get the missing document/revision IDs\n    fetchJSON(genDBUrl(host, '_revs_diff'), {\n      method: 'POST',\n      body: JSON.stringify(req)\n    }, callback).catch(callback);\n  });\n\n  api._close = function (callback) {\n    callback();\n  };\n\n  api._destroy = function (options, callback) {\n    fetchJSON(genDBUrl(host, ''), {method: 'DELETE'}).then(function (json) {\n      callback(null, json);\n    }).catch(function (err) {\n      /* istanbul ignore if */\n      if (err.status === 404) {\n        callback(null, {ok: true});\n      } else {\n        callback(err);\n      }\n    });\n  };\n}\n\n// HttpPouch is a valid adapter.\nHttpPouch.valid = function () {\n  return true;\n};\n\nfunction HttpPouch$1 (PouchDB) {\n  PouchDB.adapter('http', HttpPouch, false);\n  PouchDB.adapter('https', HttpPouch, false);\n}\n\nfunction QueryParseError(message) {\n  this.status = 400;\n  this.name = 'query_parse_error';\n  this.message = message;\n  this.error = true;\n  try {\n    Error.captureStackTrace(this, QueryParseError);\n  } catch (e) {}\n}\n\ninherits(QueryParseError, Error);\n\nfunction NotFoundError(message) {\n  this.status = 404;\n  this.name = 'not_found';\n  this.message = message;\n  this.error = true;\n  try {\n    Error.captureStackTrace(this, NotFoundError);\n  } catch (e) {}\n}\n\ninherits(NotFoundError, Error);\n\nfunction BuiltInError(message) {\n  this.status = 500;\n  this.name = 'invalid_value';\n  this.message = message;\n  this.error = true;\n  try {\n    Error.captureStackTrace(this, BuiltInError);\n  } catch (e) {}\n}\n\ninherits(BuiltInError, Error);\n\nfunction promisedCallback(promise, callback) {\n  if (callback) {\n    promise.then(function (res) {\n      immediate(function () {\n        callback(null, res);\n      });\n    }, function (reason) {\n      immediate(function () {\n        callback(reason);\n      });\n    });\n  }\n  return promise;\n}\n\nfunction callbackify(fun) {\n  return getArguments(function (args) {\n    var cb = args.pop();\n    var promise = fun.apply(this, args);\n    if (typeof cb === 'function') {\n      promisedCallback(promise, cb);\n    }\n    return promise;\n  });\n}\n\n// Promise finally util similar to Q.finally\nfunction fin(promise, finalPromiseFactory) {\n  return promise.then(function (res) {\n    return finalPromiseFactory().then(function () {\n      return res;\n    });\n  }, function (reason) {\n    return finalPromiseFactory().then(function () {\n      throw reason;\n    });\n  });\n}\n\nfunction sequentialize(queue, promiseFactory) {\n  return function () {\n    var args = arguments;\n    var that = this;\n    return queue.add(function () {\n      return promiseFactory.apply(that, args);\n    });\n  };\n}\n\n// uniq an array of strings, order not guaranteed\n// similar to underscore/lodash _.uniq\nfunction uniq(arr) {\n  var theSet = new ExportedSet(arr);\n  var result = new Array(theSet.size);\n  var index = -1;\n  theSet.forEach(function (value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nfunction mapToKeysArray(map) {\n  var result = new Array(map.size);\n  var index = -1;\n  map.forEach(function (value, key) {\n    result[++index] = key;\n  });\n  return result;\n}\n\nfunction createBuiltInError(name) {\n  var message = 'builtin ' + name +\n    ' function requires map values to be numbers' +\n    ' or number arrays';\n  return new BuiltInError(message);\n}\n\nfunction sum(values) {\n  var result = 0;\n  for (var i = 0, len = values.length; i < len; i++) {\n    var num = values[i];\n    if (typeof num !== 'number') {\n      if (Array.isArray(num)) {\n        // lists of numbers are also allowed, sum them separately\n        result = typeof result === 'number' ? [result] : result;\n        for (var j = 0, jLen = num.length; j < jLen; j++) {\n          var jNum = num[j];\n          if (typeof jNum !== 'number') {\n            throw createBuiltInError('_sum');\n          } else if (typeof result[j] === 'undefined') {\n            result.push(jNum);\n          } else {\n            result[j] += jNum;\n          }\n        }\n      } else { // not array/number\n        throw createBuiltInError('_sum');\n      }\n    } else if (typeof result === 'number') {\n      result += num;\n    } else { // add number to array\n      result[0] += num;\n    }\n  }\n  return result;\n}\n\nvar log = guardedConsole.bind(null, 'log');\nvar isArray = Array.isArray;\nvar toJSON = JSON.parse;\n\nfunction evalFunctionWithEval(func, emit) {\n  return scopeEval(\n    \"return (\" + func.replace(/;\\s*$/, \"\") + \");\",\n    {\n      emit: emit,\n      sum: sum,\n      log: log,\n      isArray: isArray,\n      toJSON: toJSON\n    }\n  );\n}\n\n/*\n * Simple task queue to sequentialize actions. Assumes\n * callbacks will eventually fire (once).\n */\n\n\nfunction TaskQueue$1() {\n  this.promise = new Promise(function (fulfill) {fulfill(); });\n}\nTaskQueue$1.prototype.add = function (promiseFactory) {\n  this.promise = this.promise.catch(function () {\n    // just recover\n  }).then(function () {\n    return promiseFactory();\n  });\n  return this.promise;\n};\nTaskQueue$1.prototype.finish = function () {\n  return this.promise;\n};\n\nfunction stringify(input) {\n  if (!input) {\n    return 'undefined'; // backwards compat for empty reduce\n  }\n  // for backwards compat with mapreduce, functions/strings are stringified\n  // as-is. everything else is JSON-stringified.\n  switch (typeof input) {\n    case 'function':\n      // e.g. a mapreduce map\n      return input.toString();\n    case 'string':\n      // e.g. a mapreduce built-in _reduce function\n      return input.toString();\n    default:\n      // e.g. a JSON object in the case of mango queries\n      return JSON.stringify(input);\n  }\n}\n\n/* create a string signature for a view so we can cache it and uniq it */\nfunction createViewSignature(mapFun, reduceFun) {\n  // the \"undefined\" part is for backwards compatibility\n  return stringify(mapFun) + stringify(reduceFun) + 'undefined';\n}\n\nfunction createView(sourceDB, viewName, mapFun, reduceFun, temporary, localDocName) {\n  var viewSignature = createViewSignature(mapFun, reduceFun);\n\n  var cachedViews;\n  if (!temporary) {\n    // cache this to ensure we don't try to update the same view twice\n    cachedViews = sourceDB._cachedViews = sourceDB._cachedViews || {};\n    if (cachedViews[viewSignature]) {\n      return cachedViews[viewSignature];\n    }\n  }\n\n  var promiseForView = sourceDB.info().then(function (info) {\n\n    var depDbName = info.db_name + '-mrview-' +\n      (temporary ? 'temp' : stringMd5(viewSignature));\n\n    // save the view name in the source db so it can be cleaned up if necessary\n    // (e.g. when the _design doc is deleted, remove all associated view data)\n    function diffFunction(doc) {\n      doc.views = doc.views || {};\n      var fullViewName = viewName;\n      if (fullViewName.indexOf('/') === -1) {\n        fullViewName = viewName + '/' + viewName;\n      }\n      var depDbs = doc.views[fullViewName] = doc.views[fullViewName] || {};\n      /* istanbul ignore if */\n      if (depDbs[depDbName]) {\n        return; // no update necessary\n      }\n      depDbs[depDbName] = true;\n      return doc;\n    }\n    return upsert(sourceDB, '_local/' + localDocName, diffFunction).then(function () {\n      return sourceDB.registerDependentDatabase(depDbName).then(function (res) {\n        var db = res.db;\n        db.auto_compaction = true;\n        var view = {\n          name: depDbName,\n          db: db,\n          sourceDB: sourceDB,\n          adapter: sourceDB.adapter,\n          mapFun: mapFun,\n          reduceFun: reduceFun\n        };\n        return view.db.get('_local/lastSeq').catch(function (err) {\n          /* istanbul ignore if */\n          if (err.status !== 404) {\n            throw err;\n          }\n        }).then(function (lastSeqDoc) {\n          view.seq = lastSeqDoc ? lastSeqDoc.seq : 0;\n          if (cachedViews) {\n            view.db.once('destroyed', function () {\n              delete cachedViews[viewSignature];\n            });\n          }\n          return view;\n        });\n      });\n    });\n  });\n\n  if (cachedViews) {\n    cachedViews[viewSignature] = promiseForView;\n  }\n  return promiseForView;\n}\n\nvar persistentQueues = {};\nvar tempViewQueue = new TaskQueue$1();\nvar CHANGES_BATCH_SIZE$1 = 50;\n\nfunction parseViewName(name) {\n  // can be either 'ddocname/viewname' or just 'viewname'\n  // (where the ddoc name is the same)\n  return name.indexOf('/') === -1 ? [name, name] : name.split('/');\n}\n\nfunction isGenOne(changes) {\n  // only return true if the current change is 1-\n  // and there are no other leafs\n  return changes.length === 1 && /^1-/.test(changes[0].rev);\n}\n\nfunction emitError(db, e) {\n  try {\n    db.emit('error', e);\n  } catch (err) {\n    guardedConsole('error',\n      'The user\\'s map/reduce function threw an uncaught error.\\n' +\n      'You can debug this error by doing:\\n' +\n      'myDatabase.on(\\'error\\', function (err) { debugger; });\\n' +\n      'Please double-check your map/reduce function.');\n    guardedConsole('error', e);\n  }\n}\n\n/**\n * Returns an \"abstract\" mapreduce object of the form:\n *\n *   {\n *     query: queryFun,\n *     viewCleanup: viewCleanupFun\n *   }\n *\n * Arguments are:\n *\n * localDoc: string\n *   This is for the local doc that gets saved in order to track the\n *   \"dependent\" DBs and clean them up for viewCleanup. It should be\n *   unique, so that indexer plugins don't collide with each other.\n * mapper: function (mapFunDef, emit)\n *   Returns a map function based on the mapFunDef, which in the case of\n *   normal map/reduce is just the de-stringified function, but may be\n *   something else, such as an object in the case of pouchdb-find.\n * reducer: function (reduceFunDef)\n *   Ditto, but for reducing. Modules don't have to support reducing\n *   (e.g. pouchdb-find).\n * ddocValidator: function (ddoc, viewName)\n *   Throws an error if the ddoc or viewName is not valid.\n *   This could be a way to communicate to the user that the configuration for the\n *   indexer is invalid.\n */\nfunction createAbstractMapReduce(localDocName, mapper, reducer, ddocValidator) {\n\n  function tryMap(db, fun, doc) {\n    // emit an event if there was an error thrown by a map function.\n    // putting try/catches in a single function also avoids deoptimizations.\n    try {\n      fun(doc);\n    } catch (e) {\n      emitError(db, e);\n    }\n  }\n\n  function tryReduce(db, fun, keys, values, rereduce) {\n    // same as above, but returning the result or an error. there are two separate\n    // functions to avoid extra memory allocations since the tryCode() case is used\n    // for custom map functions (common) vs this function, which is only used for\n    // custom reduce functions (rare)\n    try {\n      return {output : fun(keys, values, rereduce)};\n    } catch (e) {\n      emitError(db, e);\n      return {error: e};\n    }\n  }\n\n  function sortByKeyThenValue(x, y) {\n    var keyCompare = collate(x.key, y.key);\n    return keyCompare !== 0 ? keyCompare : collate(x.value, y.value);\n  }\n\n  function sliceResults(results, limit, skip) {\n    skip = skip || 0;\n    if (typeof limit === 'number') {\n      return results.slice(skip, limit + skip);\n    } else if (skip > 0) {\n      return results.slice(skip);\n    }\n    return results;\n  }\n\n  function rowToDocId(row) {\n    var val = row.value;\n    // Users can explicitly specify a joined doc _id, or it\n    // defaults to the doc _id that emitted the key/value.\n    var docId = (val && typeof val === 'object' && val._id) || row.id;\n    return docId;\n  }\n\n  function readAttachmentsAsBlobOrBuffer(res) {\n    res.rows.forEach(function (row) {\n      var atts = row.doc && row.doc._attachments;\n      if (!atts) {\n        return;\n      }\n      Object.keys(atts).forEach(function (filename) {\n        var att = atts[filename];\n        atts[filename].data = b64ToBluffer(att.data, att.content_type);\n      });\n    });\n  }\n\n  function postprocessAttachments(opts) {\n    return function (res) {\n      if (opts.include_docs && opts.attachments && opts.binary) {\n        readAttachmentsAsBlobOrBuffer(res);\n      }\n      return res;\n    };\n  }\n\n  function addHttpParam(paramName, opts, params, asJson) {\n    // add an http param from opts to params, optionally json-encoded\n    var val = opts[paramName];\n    if (typeof val !== 'undefined') {\n      if (asJson) {\n        val = encodeURIComponent(JSON.stringify(val));\n      }\n      params.push(paramName + '=' + val);\n    }\n  }\n\n  function coerceInteger(integerCandidate) {\n    if (typeof integerCandidate !== 'undefined') {\n      var asNumber = Number(integerCandidate);\n      // prevents e.g. '1foo' or '1.1' being coerced to 1\n      if (!isNaN(asNumber) && asNumber === parseInt(integerCandidate, 10)) {\n        return asNumber;\n      } else {\n        return integerCandidate;\n      }\n    }\n  }\n\n  function coerceOptions(opts) {\n    opts.group_level = coerceInteger(opts.group_level);\n    opts.limit = coerceInteger(opts.limit);\n    opts.skip = coerceInteger(opts.skip);\n    return opts;\n  }\n\n  function checkPositiveInteger(number) {\n    if (number) {\n      if (typeof number !== 'number') {\n        return  new QueryParseError('Invalid value for integer: \"' +\n          number + '\"');\n      }\n      if (number < 0) {\n        return new QueryParseError('Invalid value for positive integer: ' +\n          '\"' + number + '\"');\n      }\n    }\n  }\n\n  function checkQueryParseError(options, fun) {\n    var startkeyName = options.descending ? 'endkey' : 'startkey';\n    var endkeyName = options.descending ? 'startkey' : 'endkey';\n\n    if (typeof options[startkeyName] !== 'undefined' &&\n      typeof options[endkeyName] !== 'undefined' &&\n      collate(options[startkeyName], options[endkeyName]) > 0) {\n      throw new QueryParseError('No rows can match your key range, ' +\n        'reverse your start_key and end_key or set {descending : true}');\n    } else if (fun.reduce && options.reduce !== false) {\n      if (options.include_docs) {\n        throw new QueryParseError('{include_docs:true} is invalid for reduce');\n      } else if (options.keys && options.keys.length > 1 &&\n        !options.group && !options.group_level) {\n        throw new QueryParseError('Multi-key fetches for reduce views must use ' +\n          '{group: true}');\n      }\n    }\n    ['group_level', 'limit', 'skip'].forEach(function (optionName) {\n      var error = checkPositiveInteger(options[optionName]);\n      if (error) {\n        throw error;\n      }\n    });\n  }\n\n  function httpQuery(db, fun, opts) {\n    // List of parameters to add to the PUT request\n    var params = [];\n    var body;\n    var method = 'GET';\n    var ok, status;\n\n    // If opts.reduce exists and is defined, then add it to the list\n    // of parameters.\n    // If reduce=false then the results are that of only the map function\n    // not the final result of map and reduce.\n    addHttpParam('reduce', opts, params);\n    addHttpParam('include_docs', opts, params);\n    addHttpParam('attachments', opts, params);\n    addHttpParam('limit', opts, params);\n    addHttpParam('descending', opts, params);\n    addHttpParam('group', opts, params);\n    addHttpParam('group_level', opts, params);\n    addHttpParam('skip', opts, params);\n    addHttpParam('stale', opts, params);\n    addHttpParam('conflicts', opts, params);\n    addHttpParam('startkey', opts, params, true);\n    addHttpParam('start_key', opts, params, true);\n    addHttpParam('endkey', opts, params, true);\n    addHttpParam('end_key', opts, params, true);\n    addHttpParam('inclusive_end', opts, params);\n    addHttpParam('key', opts, params, true);\n    addHttpParam('update_seq', opts, params);\n\n    // Format the list of parameters into a valid URI query string\n    params = params.join('&');\n    params = params === '' ? '' : '?' + params;\n\n    // If keys are supplied, issue a POST to circumvent GET query string limits\n    // see http://wiki.apache.org/couchdb/HTTP_view_API#Querying_Options\n    if (typeof opts.keys !== 'undefined') {\n      var MAX_URL_LENGTH = 2000;\n      // according to http://stackoverflow.com/a/417184/680742,\n      // the de facto URL length limit is 2000 characters\n\n      var keysAsString =\n        'keys=' + encodeURIComponent(JSON.stringify(opts.keys));\n      if (keysAsString.length + params.length + 1 <= MAX_URL_LENGTH) {\n        // If the keys are short enough, do a GET. we do this to work around\n        // Safari not understanding 304s on POSTs (see pouchdb/pouchdb#1239)\n        params += (params[0] === '?' ? '&' : '?') + keysAsString;\n      } else {\n        method = 'POST';\n        if (typeof fun === 'string') {\n          body = {keys: opts.keys};\n        } else { // fun is {map : mapfun}, so append to this\n          fun.keys = opts.keys;\n        }\n      }\n    }\n\n    // We are referencing a query defined in the design doc\n    if (typeof fun === 'string') {\n      var parts = parseViewName(fun);\n      return db.fetch('_design/' + parts[0] + '/_view/' + parts[1] + params, {\n        headers: new h({'Content-Type': 'application/json'}),\n        method: method,\n        body: JSON.stringify(body)\n      }).then(function (response) {\n        ok = response.ok;\n        status = response.status;\n        return response.json();\n      }).then(function (result) {\n        if (!ok) {\n          result.status = status;\n          throw generateErrorFromResponse(result);\n        }\n        // fail the entire request if the result contains an error\n        result.rows.forEach(function (row) {\n          /* istanbul ignore if */\n          if (row.value && row.value.error && row.value.error === \"builtin_reduce_error\") {\n            throw new Error(row.reason);\n          }\n        });\n        return result;\n      }).then(postprocessAttachments(opts));\n    }\n\n    // We are using a temporary view, terrible for performance, good for testing\n    body = body || {};\n    Object.keys(fun).forEach(function (key) {\n      if (Array.isArray(fun[key])) {\n        body[key] = fun[key];\n      } else {\n        body[key] = fun[key].toString();\n      }\n    });\n\n    return db.fetch('_temp_view' + params, {\n      headers: new h({'Content-Type': 'application/json'}),\n      method: 'POST',\n      body: JSON.stringify(body)\n    }).then(function (response) {\n        ok = response.ok;\n        status = response.status;\n      return response.json();\n    }).then(function (result) {\n      if (!ok) {\n        result.status = status;\n        throw generateErrorFromResponse(result);\n      }\n      return result;\n    }).then(postprocessAttachments(opts));\n  }\n\n  // custom adapters can define their own api._query\n  // and override the default behavior\n  /* istanbul ignore next */\n  function customQuery(db, fun, opts) {\n    return new Promise(function (resolve, reject) {\n      db._query(fun, opts, function (err, res) {\n        if (err) {\n          return reject(err);\n        }\n        resolve(res);\n      });\n    });\n  }\n\n  // custom adapters can define their own api._viewCleanup\n  // and override the default behavior\n  /* istanbul ignore next */\n  function customViewCleanup(db) {\n    return new Promise(function (resolve, reject) {\n      db._viewCleanup(function (err, res) {\n        if (err) {\n          return reject(err);\n        }\n        resolve(res);\n      });\n    });\n  }\n\n  function defaultsTo(value) {\n    return function (reason) {\n      /* istanbul ignore else */\n      if (reason.status === 404) {\n        return value;\n      } else {\n        throw reason;\n      }\n    };\n  }\n\n  // returns a promise for a list of docs to update, based on the input docId.\n  // the order doesn't matter, because post-3.2.0, bulkDocs\n  // is an atomic operation in all three adapters.\n  function getDocsToPersist(docId, view, docIdsToChangesAndEmits) {\n    var metaDocId = '_local/doc_' + docId;\n    var defaultMetaDoc = {_id: metaDocId, keys: []};\n    var docData = docIdsToChangesAndEmits.get(docId);\n    var indexableKeysToKeyValues = docData[0];\n    var changes = docData[1];\n\n    function getMetaDoc() {\n      if (isGenOne(changes)) {\n        // generation 1, so we can safely assume initial state\n        // for performance reasons (avoids unnecessary GETs)\n        return Promise.resolve(defaultMetaDoc);\n      }\n      return view.db.get(metaDocId).catch(defaultsTo(defaultMetaDoc));\n    }\n\n    function getKeyValueDocs(metaDoc) {\n      if (!metaDoc.keys.length) {\n        // no keys, no need for a lookup\n        return Promise.resolve({rows: []});\n      }\n      return view.db.allDocs({\n        keys: metaDoc.keys,\n        include_docs: true\n      });\n    }\n\n    function processKeyValueDocs(metaDoc, kvDocsRes) {\n      var kvDocs = [];\n      var oldKeys = new ExportedSet();\n\n      for (var i = 0, len = kvDocsRes.rows.length; i < len; i++) {\n        var row = kvDocsRes.rows[i];\n        var doc = row.doc;\n        if (!doc) { // deleted\n          continue;\n        }\n        kvDocs.push(doc);\n        oldKeys.add(doc._id);\n        doc._deleted = !indexableKeysToKeyValues.has(doc._id);\n        if (!doc._deleted) {\n          var keyValue = indexableKeysToKeyValues.get(doc._id);\n          if ('value' in keyValue) {\n            doc.value = keyValue.value;\n          }\n        }\n      }\n      var newKeys = mapToKeysArray(indexableKeysToKeyValues);\n      newKeys.forEach(function (key) {\n        if (!oldKeys.has(key)) {\n          // new doc\n          var kvDoc = {\n            _id: key\n          };\n          var keyValue = indexableKeysToKeyValues.get(key);\n          if ('value' in keyValue) {\n            kvDoc.value = keyValue.value;\n          }\n          kvDocs.push(kvDoc);\n        }\n      });\n      metaDoc.keys = uniq(newKeys.concat(metaDoc.keys));\n      kvDocs.push(metaDoc);\n\n      return kvDocs;\n    }\n\n    return getMetaDoc().then(function (metaDoc) {\n      return getKeyValueDocs(metaDoc).then(function (kvDocsRes) {\n        return processKeyValueDocs(metaDoc, kvDocsRes);\n      });\n    });\n  }\n\n  // updates all emitted key/value docs and metaDocs in the mrview database\n  // for the given batch of documents from the source database\n  function saveKeyValues(view, docIdsToChangesAndEmits, seq) {\n    var seqDocId = '_local/lastSeq';\n    return view.db.get(seqDocId)\n      .catch(defaultsTo({_id: seqDocId, seq: 0}))\n      .then(function (lastSeqDoc) {\n        var docIds = mapToKeysArray(docIdsToChangesAndEmits);\n        return Promise.all(docIds.map(function (docId) {\n          return getDocsToPersist(docId, view, docIdsToChangesAndEmits);\n        })).then(function (listOfDocsToPersist) {\n          var docsToPersist = flatten(listOfDocsToPersist);\n          lastSeqDoc.seq = seq;\n          docsToPersist.push(lastSeqDoc);\n          // write all docs in a single operation, update the seq once\n          return view.db.bulkDocs({docs : docsToPersist});\n        });\n      });\n  }\n\n  function getQueue(view) {\n    var viewName = typeof view === 'string' ? view : view.name;\n    var queue = persistentQueues[viewName];\n    if (!queue) {\n      queue = persistentQueues[viewName] = new TaskQueue$1();\n    }\n    return queue;\n  }\n\n  function updateView(view) {\n    return sequentialize(getQueue(view), function () {\n      return updateViewInQueue(view);\n    })();\n  }\n\n  function updateViewInQueue(view) {\n    // bind the emit function once\n    var mapResults;\n    var doc;\n\n    function emit(key, value) {\n      var output = {id: doc._id, key: normalizeKey(key)};\n      // Don't explicitly store the value unless it's defined and non-null.\n      // This saves on storage space, because often people don't use it.\n      if (typeof value !== 'undefined' && value !== null) {\n        output.value = normalizeKey(value);\n      }\n      mapResults.push(output);\n    }\n\n    var mapFun = mapper(view.mapFun, emit);\n\n    var currentSeq = view.seq || 0;\n\n    function processChange(docIdsToChangesAndEmits, seq) {\n      return function () {\n        return saveKeyValues(view, docIdsToChangesAndEmits, seq);\n      };\n    }\n\n    var queue = new TaskQueue$1();\n\n    function processNextBatch() {\n      return view.sourceDB.changes({\n        return_docs: true,\n        conflicts: true,\n        include_docs: true,\n        style: 'all_docs',\n        since: currentSeq,\n        limit: CHANGES_BATCH_SIZE$1\n      }).then(processBatch);\n    }\n\n    function processBatch(response) {\n      var results = response.results;\n      if (!results.length) {\n        return;\n      }\n      var docIdsToChangesAndEmits = createDocIdsToChangesAndEmits(results);\n      queue.add(processChange(docIdsToChangesAndEmits, currentSeq));\n      if (results.length < CHANGES_BATCH_SIZE$1) {\n        return;\n      }\n      return processNextBatch();\n    }\n\n    function createDocIdsToChangesAndEmits(results) {\n      var docIdsToChangesAndEmits = new ExportedMap();\n      for (var i = 0, len = results.length; i < len; i++) {\n        var change = results[i];\n        if (change.doc._id[0] !== '_') {\n          mapResults = [];\n          doc = change.doc;\n\n          if (!doc._deleted) {\n            tryMap(view.sourceDB, mapFun, doc);\n          }\n          mapResults.sort(sortByKeyThenValue);\n\n          var indexableKeysToKeyValues = createIndexableKeysToKeyValues(mapResults);\n          docIdsToChangesAndEmits.set(change.doc._id, [\n            indexableKeysToKeyValues,\n            change.changes\n          ]);\n        }\n        currentSeq = change.seq;\n      }\n      return docIdsToChangesAndEmits;\n    }\n\n    function createIndexableKeysToKeyValues(mapResults) {\n      var indexableKeysToKeyValues = new ExportedMap();\n      var lastKey;\n      for (var i = 0, len = mapResults.length; i < len; i++) {\n        var emittedKeyValue = mapResults[i];\n        var complexKey = [emittedKeyValue.key, emittedKeyValue.id];\n        if (i > 0 && collate(emittedKeyValue.key, lastKey) === 0) {\n          complexKey.push(i); // dup key+id, so make it unique\n        }\n        indexableKeysToKeyValues.set(toIndexableString(complexKey), emittedKeyValue);\n        lastKey = emittedKeyValue.key;\n      }\n      return indexableKeysToKeyValues;\n    }\n\n    return processNextBatch().then(function () {\n      return queue.finish();\n    }).then(function () {\n      view.seq = currentSeq;\n    });\n  }\n\n  function reduceView(view, results, options) {\n    if (options.group_level === 0) {\n      delete options.group_level;\n    }\n\n    var shouldGroup = options.group || options.group_level;\n\n    var reduceFun = reducer(view.reduceFun);\n\n    var groups = [];\n    var lvl = isNaN(options.group_level) ? Number.POSITIVE_INFINITY :\n      options.group_level;\n    results.forEach(function (e) {\n      var last = groups[groups.length - 1];\n      var groupKey = shouldGroup ? e.key : null;\n\n      // only set group_level for array keys\n      if (shouldGroup && Array.isArray(groupKey)) {\n        groupKey = groupKey.slice(0, lvl);\n      }\n\n      if (last && collate(last.groupKey, groupKey) === 0) {\n        last.keys.push([e.key, e.id]);\n        last.values.push(e.value);\n        return;\n      }\n      groups.push({\n        keys: [[e.key, e.id]],\n        values: [e.value],\n        groupKey: groupKey\n      });\n    });\n    results = [];\n    for (var i = 0, len = groups.length; i < len; i++) {\n      var e = groups[i];\n      var reduceTry = tryReduce(view.sourceDB, reduceFun, e.keys, e.values, false);\n      if (reduceTry.error && reduceTry.error instanceof BuiltInError) {\n        // CouchDB returns an error if a built-in errors out\n        throw reduceTry.error;\n      }\n      results.push({\n        // CouchDB just sets the value to null if a non-built-in errors out\n        value: reduceTry.error ? null : reduceTry.output,\n        key: e.groupKey\n      });\n    }\n    // no total_rows/offset when reducing\n    return {rows: sliceResults(results, options.limit, options.skip)};\n  }\n\n  function queryView(view, opts) {\n    return sequentialize(getQueue(view), function () {\n      return queryViewInQueue(view, opts);\n    })();\n  }\n\n  function queryViewInQueue(view, opts) {\n    var totalRows;\n    var shouldReduce = view.reduceFun && opts.reduce !== false;\n    var skip = opts.skip || 0;\n    if (typeof opts.keys !== 'undefined' && !opts.keys.length) {\n      // equivalent query\n      opts.limit = 0;\n      delete opts.keys;\n    }\n\n    function fetchFromView(viewOpts) {\n      viewOpts.include_docs = true;\n      return view.db.allDocs(viewOpts).then(function (res) {\n        totalRows = res.total_rows;\n        return res.rows.map(function (result) {\n\n          // implicit migration - in older versions of PouchDB,\n          // we explicitly stored the doc as {id: ..., key: ..., value: ...}\n          // this is tested in a migration test\n          /* istanbul ignore next */\n          if ('value' in result.doc && typeof result.doc.value === 'object' &&\n            result.doc.value !== null) {\n            var keys = Object.keys(result.doc.value).sort();\n            // this detection method is not perfect, but it's unlikely the user\n            // emitted a value which was an object with these 3 exact keys\n            var expectedKeys = ['id', 'key', 'value'];\n            if (!(keys < expectedKeys || keys > expectedKeys)) {\n              return result.doc.value;\n            }\n          }\n\n          var parsedKeyAndDocId = parseIndexableString(result.doc._id);\n          return {\n            key: parsedKeyAndDocId[0],\n            id: parsedKeyAndDocId[1],\n            value: ('value' in result.doc ? result.doc.value : null)\n          };\n        });\n      });\n    }\n\n    function onMapResultsReady(rows) {\n      var finalResults;\n      if (shouldReduce) {\n        finalResults = reduceView(view, rows, opts);\n      } else {\n        finalResults = {\n          total_rows: totalRows,\n          offset: skip,\n          rows: rows\n        };\n      }\n      /* istanbul ignore if */\n      if (opts.update_seq) {\n        finalResults.update_seq = view.seq;\n      }\n      if (opts.include_docs) {\n        var docIds = uniq(rows.map(rowToDocId));\n\n        return view.sourceDB.allDocs({\n          keys: docIds,\n          include_docs: true,\n          conflicts: opts.conflicts,\n          attachments: opts.attachments,\n          binary: opts.binary\n        }).then(function (allDocsRes) {\n          var docIdsToDocs = new ExportedMap();\n          allDocsRes.rows.forEach(function (row) {\n            docIdsToDocs.set(row.id, row.doc);\n          });\n          rows.forEach(function (row) {\n            var docId = rowToDocId(row);\n            var doc = docIdsToDocs.get(docId);\n            if (doc) {\n              row.doc = doc;\n            }\n          });\n          return finalResults;\n        });\n      } else {\n        return finalResults;\n      }\n    }\n\n    if (typeof opts.keys !== 'undefined') {\n      var keys = opts.keys;\n      var fetchPromises = keys.map(function (key) {\n        var viewOpts = {\n          startkey : toIndexableString([key]),\n          endkey   : toIndexableString([key, {}])\n        };\n        /* istanbul ignore if */\n        if (opts.update_seq) {\n          viewOpts.update_seq = true;\n        }\n        return fetchFromView(viewOpts);\n      });\n      return Promise.all(fetchPromises).then(flatten).then(onMapResultsReady);\n    } else { // normal query, no 'keys'\n      var viewOpts = {\n        descending : opts.descending\n      };\n      /* istanbul ignore if */\n      if (opts.update_seq) {\n        viewOpts.update_seq = true;\n      }\n      var startkey;\n      var endkey;\n      if ('start_key' in opts) {\n        startkey = opts.start_key;\n      }\n      if ('startkey' in opts) {\n        startkey = opts.startkey;\n      }\n      if ('end_key' in opts) {\n        endkey = opts.end_key;\n      }\n      if ('endkey' in opts) {\n        endkey = opts.endkey;\n      }\n      if (typeof startkey !== 'undefined') {\n        viewOpts.startkey = opts.descending ?\n          toIndexableString([startkey, {}]) :\n          toIndexableString([startkey]);\n      }\n      if (typeof endkey !== 'undefined') {\n        var inclusiveEnd = opts.inclusive_end !== false;\n        if (opts.descending) {\n          inclusiveEnd = !inclusiveEnd;\n        }\n\n        viewOpts.endkey = toIndexableString(\n          inclusiveEnd ? [endkey, {}] : [endkey]);\n      }\n      if (typeof opts.key !== 'undefined') {\n        var keyStart = toIndexableString([opts.key]);\n        var keyEnd = toIndexableString([opts.key, {}]);\n        if (viewOpts.descending) {\n          viewOpts.endkey = keyStart;\n          viewOpts.startkey = keyEnd;\n        } else {\n          viewOpts.startkey = keyStart;\n          viewOpts.endkey = keyEnd;\n        }\n      }\n      if (!shouldReduce) {\n        if (typeof opts.limit === 'number') {\n          viewOpts.limit = opts.limit;\n        }\n        viewOpts.skip = skip;\n      }\n      return fetchFromView(viewOpts).then(onMapResultsReady);\n    }\n  }\n\n  function httpViewCleanup(db) {\n    return db.fetch('_view_cleanup', {\n      headers: new h({'Content-Type': 'application/json'}),\n      method: 'POST'\n    }).then(function (response) {\n      return response.json();\n    });\n  }\n\n  function localViewCleanup(db) {\n    return db.get('_local/' + localDocName).then(function (metaDoc) {\n      var docsToViews = new ExportedMap();\n      Object.keys(metaDoc.views).forEach(function (fullViewName) {\n        var parts = parseViewName(fullViewName);\n        var designDocName = '_design/' + parts[0];\n        var viewName = parts[1];\n        var views = docsToViews.get(designDocName);\n        if (!views) {\n          views = new ExportedSet();\n          docsToViews.set(designDocName, views);\n        }\n        views.add(viewName);\n      });\n      var opts = {\n        keys : mapToKeysArray(docsToViews),\n        include_docs : true\n      };\n      return db.allDocs(opts).then(function (res) {\n        var viewsToStatus = {};\n        res.rows.forEach(function (row) {\n          var ddocName = row.key.substring(8); // cuts off '_design/'\n          docsToViews.get(row.key).forEach(function (viewName) {\n            var fullViewName = ddocName + '/' + viewName;\n            /* istanbul ignore if */\n            if (!metaDoc.views[fullViewName]) {\n              // new format, without slashes, to support PouchDB 2.2.0\n              // migration test in pouchdb's browser.migration.js verifies this\n              fullViewName = viewName;\n            }\n            var viewDBNames = Object.keys(metaDoc.views[fullViewName]);\n            // design doc deleted, or view function nonexistent\n            var statusIsGood = row.doc && row.doc.views &&\n              row.doc.views[viewName];\n            viewDBNames.forEach(function (viewDBName) {\n              viewsToStatus[viewDBName] =\n                viewsToStatus[viewDBName] || statusIsGood;\n            });\n          });\n        });\n        var dbsToDelete = Object.keys(viewsToStatus).filter(\n          function (viewDBName) { return !viewsToStatus[viewDBName]; });\n        var destroyPromises = dbsToDelete.map(function (viewDBName) {\n          return sequentialize(getQueue(viewDBName), function () {\n            return new db.constructor(viewDBName, db.__opts).destroy();\n          })();\n        });\n        return Promise.all(destroyPromises).then(function () {\n          return {ok: true};\n        });\n      });\n    }, defaultsTo({ok: true}));\n  }\n\n  function queryPromised(db, fun, opts) {\n    /* istanbul ignore next */\n    if (typeof db._query === 'function') {\n      return customQuery(db, fun, opts);\n    }\n    if (isRemote(db)) {\n      return httpQuery(db, fun, opts);\n    }\n\n    if (typeof fun !== 'string') {\n      // temp_view\n      checkQueryParseError(opts, fun);\n\n      tempViewQueue.add(function () {\n        var createViewPromise = createView(\n          /* sourceDB */ db,\n          /* viewName */ 'temp_view/temp_view',\n          /* mapFun */ fun.map,\n          /* reduceFun */ fun.reduce,\n          /* temporary */ true,\n          /* localDocName */ localDocName);\n        return createViewPromise.then(function (view) {\n          return fin(updateView(view).then(function () {\n            return queryView(view, opts);\n          }), function () {\n            return view.db.destroy();\n          });\n        });\n      });\n      return tempViewQueue.finish();\n    } else {\n      // persistent view\n      var fullViewName = fun;\n      var parts = parseViewName(fullViewName);\n      var designDocName = parts[0];\n      var viewName = parts[1];\n      return db.get('_design/' + designDocName).then(function (doc) {\n        var fun = doc.views && doc.views[viewName];\n\n        if (!fun) {\n          // basic validator; it's assumed that every subclass would want this\n          throw new NotFoundError('ddoc ' + doc._id + ' has no view named ' +\n            viewName);\n        }\n\n        ddocValidator(doc, viewName);\n        checkQueryParseError(opts, fun);\n\n        var createViewPromise = createView(\n          /* sourceDB */ db,\n          /* viewName */ fullViewName,\n          /* mapFun */ fun.map,\n          /* reduceFun */ fun.reduce,\n          /* temporary */ false,\n          /* localDocName */ localDocName);\n        return createViewPromise.then(function (view) {\n          if (opts.stale === 'ok' || opts.stale === 'update_after') {\n            if (opts.stale === 'update_after') {\n              immediate(function () {\n                updateView(view);\n              });\n            }\n            return queryView(view, opts);\n          } else { // stale not ok\n            return updateView(view).then(function () {\n              return queryView(view, opts);\n            });\n          }\n        });\n      });\n    }\n  }\n\n  function abstractQuery(fun, opts, callback) {\n    var db = this;\n    if (typeof opts === 'function') {\n      callback = opts;\n      opts = {};\n    }\n    opts = opts ? coerceOptions(opts) : {};\n\n    if (typeof fun === 'function') {\n      fun = {map : fun};\n    }\n\n    var promise = Promise.resolve().then(function () {\n      return queryPromised(db, fun, opts);\n    });\n    promisedCallback(promise, callback);\n    return promise;\n  }\n\n  var abstractViewCleanup = callbackify(function () {\n    var db = this;\n    /* istanbul ignore next */\n    if (typeof db._viewCleanup === 'function') {\n      return customViewCleanup(db);\n    }\n    if (isRemote(db)) {\n      return httpViewCleanup(db);\n    }\n    return localViewCleanup(db);\n  });\n\n  return {\n    query: abstractQuery,\n    viewCleanup: abstractViewCleanup\n  };\n}\n\nvar builtInReduce = {\n  _sum: function (keys, values) {\n    return sum(values);\n  },\n\n  _count: function (keys, values) {\n    return values.length;\n  },\n\n  _stats: function (keys, values) {\n    // no need to implement rereduce=true, because Pouch\n    // will never call it\n    function sumsqr(values) {\n      var _sumsqr = 0;\n      for (var i = 0, len = values.length; i < len; i++) {\n        var num = values[i];\n        _sumsqr += (num * num);\n      }\n      return _sumsqr;\n    }\n    return {\n      sum     : sum(values),\n      min     : Math.min.apply(null, values),\n      max     : Math.max.apply(null, values),\n      count   : values.length,\n      sumsqr : sumsqr(values)\n    };\n  }\n};\n\nfunction getBuiltIn(reduceFunString) {\n  if (/^_sum/.test(reduceFunString)) {\n    return builtInReduce._sum;\n  } else if (/^_count/.test(reduceFunString)) {\n    return builtInReduce._count;\n  } else if (/^_stats/.test(reduceFunString)) {\n    return builtInReduce._stats;\n  } else if (/^_/.test(reduceFunString)) {\n    throw new Error(reduceFunString + ' is not a supported reduce function.');\n  }\n}\n\nfunction mapper(mapFun, emit) {\n  // for temp_views one can use emit(doc, emit), see #38\n  if (typeof mapFun === \"function\" && mapFun.length === 2) {\n    var origMap = mapFun;\n    return function (doc) {\n      return origMap(doc, emit);\n    };\n  } else {\n    return evalFunctionWithEval(mapFun.toString(), emit);\n  }\n}\n\nfunction reducer(reduceFun) {\n  var reduceFunString = reduceFun.toString();\n  var builtIn = getBuiltIn(reduceFunString);\n  if (builtIn) {\n    return builtIn;\n  } else {\n    return evalFunctionWithEval(reduceFunString);\n  }\n}\n\nfunction ddocValidator(ddoc, viewName) {\n  var fun = ddoc.views && ddoc.views[viewName];\n  if (typeof fun.map !== 'string') {\n    throw new NotFoundError('ddoc ' + ddoc._id + ' has no string view named ' +\n      viewName + ', instead found object of type: ' + typeof fun.map);\n  }\n}\n\nvar localDocName = 'mrviews';\nvar abstract = createAbstractMapReduce(localDocName, mapper, reducer, ddocValidator);\n\nfunction query(fun, opts, callback) {\n  return abstract.query.call(this, fun, opts, callback);\n}\n\nfunction viewCleanup(callback) {\n  return abstract.viewCleanup.call(this, callback);\n}\n\nvar mapreduce = {\n  query: query,\n  viewCleanup: viewCleanup\n};\n\nfunction isGenOne$1(rev$$1) {\n  return /^1-/.test(rev$$1);\n}\n\nfunction fileHasChanged(localDoc, remoteDoc, filename) {\n  return !localDoc._attachments ||\n         !localDoc._attachments[filename] ||\n         localDoc._attachments[filename].digest !== remoteDoc._attachments[filename].digest;\n}\n\nfunction getDocAttachments(db, doc) {\n  var filenames = Object.keys(doc._attachments);\n  return Promise.all(filenames.map(function (filename) {\n    return db.getAttachment(doc._id, filename, {rev: doc._rev});\n  }));\n}\n\nfunction getDocAttachmentsFromTargetOrSource(target, src, doc) {\n  var doCheckForLocalAttachments = isRemote(src) && !isRemote(target);\n  var filenames = Object.keys(doc._attachments);\n\n  if (!doCheckForLocalAttachments) {\n    return getDocAttachments(src, doc);\n  }\n\n  return target.get(doc._id).then(function (localDoc) {\n    return Promise.all(filenames.map(function (filename) {\n      if (fileHasChanged(localDoc, doc, filename)) {\n        return src.getAttachment(doc._id, filename);\n      }\n\n      return target.getAttachment(localDoc._id, filename);\n    }));\n  }).catch(function (error) {\n    /* istanbul ignore if */\n    if (error.status !== 404) {\n      throw error;\n    }\n\n    return getDocAttachments(src, doc);\n  });\n}\n\nfunction createBulkGetOpts(diffs) {\n  var requests = [];\n  Object.keys(diffs).forEach(function (id) {\n    var missingRevs = diffs[id].missing;\n    missingRevs.forEach(function (missingRev) {\n      requests.push({\n        id: id,\n        rev: missingRev\n      });\n    });\n  });\n\n  return {\n    docs: requests,\n    revs: true,\n    latest: true\n  };\n}\n\n//\n// Fetch all the documents from the src as described in the \"diffs\",\n// which is a mapping of docs IDs to revisions. If the state ever\n// changes to \"cancelled\", then the returned promise will be rejected.\n// Else it will be resolved with a list of fetched documents.\n//\nfunction getDocs(src, target, diffs, state) {\n  diffs = clone(diffs); // we do not need to modify this\n\n  var resultDocs = [],\n      ok = true;\n\n  function getAllDocs() {\n\n    var bulkGetOpts = createBulkGetOpts(diffs);\n\n    if (!bulkGetOpts.docs.length) { // optimization: skip empty requests\n      return;\n    }\n\n    return src.bulkGet(bulkGetOpts).then(function (bulkGetResponse) {\n      /* istanbul ignore if */\n      if (state.cancelled) {\n        throw new Error('cancelled');\n      }\n      return Promise.all(bulkGetResponse.results.map(function (bulkGetInfo) {\n        return Promise.all(bulkGetInfo.docs.map(function (doc) {\n          var remoteDoc = doc.ok;\n\n          if (doc.error) {\n            // when AUTO_COMPACTION is set, docs can be returned which look\n            // like this: {\"missing\":\"1-7c3ac256b693c462af8442f992b83696\"}\n            ok = false;\n          }\n\n          if (!remoteDoc || !remoteDoc._attachments) {\n            return remoteDoc;\n          }\n\n          return getDocAttachmentsFromTargetOrSource(target, src, remoteDoc)\n                   .then(function (attachments) {\n                           var filenames = Object.keys(remoteDoc._attachments);\n                           attachments\n                             .forEach(function (attachment, i) {\n                                        var att = remoteDoc._attachments[filenames[i]];\n                                        delete att.stub;\n                                        delete att.length;\n                                        att.data = attachment;\n                                      });\n\n                                      return remoteDoc;\n                                    });\n        }));\n      }))\n\n      .then(function (results) {\n        resultDocs = resultDocs.concat(flatten(results).filter(Boolean));\n      });\n    });\n  }\n\n  function hasAttachments(doc) {\n    return doc._attachments && Object.keys(doc._attachments).length > 0;\n  }\n\n  function hasConflicts(doc) {\n    return doc._conflicts && doc._conflicts.length > 0;\n  }\n\n  function fetchRevisionOneDocs(ids) {\n    // Optimization: fetch gen-1 docs and attachments in\n    // a single request using _all_docs\n    return src.allDocs({\n      keys: ids,\n      include_docs: true,\n      conflicts: true\n    }).then(function (res) {\n      if (state.cancelled) {\n        throw new Error('cancelled');\n      }\n      res.rows.forEach(function (row) {\n        if (row.deleted || !row.doc || !isGenOne$1(row.value.rev) ||\n            hasAttachments(row.doc) || hasConflicts(row.doc)) {\n          // if any of these conditions apply, we need to fetch using get()\n          return;\n        }\n\n        // strip _conflicts array to appease CSG (#5793)\n        /* istanbul ignore if */\n        if (row.doc._conflicts) {\n          delete row.doc._conflicts;\n        }\n\n        // the doc we got back from allDocs() is sufficient\n        resultDocs.push(row.doc);\n        delete diffs[row.id];\n      });\n    });\n  }\n\n  function getRevisionOneDocs() {\n    // filter out the generation 1 docs and get them\n    // leaving the non-generation one docs to be got otherwise\n    var ids = Object.keys(diffs).filter(function (id) {\n      var missing = diffs[id].missing;\n      return missing.length === 1 && isGenOne$1(missing[0]);\n    });\n    if (ids.length > 0) {\n      return fetchRevisionOneDocs(ids);\n    }\n  }\n\n  function returnResult() {\n    return { ok:ok, docs:resultDocs };\n  }\n\n  return Promise.resolve()\n    .then(getRevisionOneDocs)\n    .then(getAllDocs)\n    .then(returnResult);\n}\n\nvar CHECKPOINT_VERSION = 1;\nvar REPLICATOR = \"pouchdb\";\n// This is an arbitrary number to limit the\n// amount of replication history we save in the checkpoint.\n// If we save too much, the checkpoing docs will become very big,\n// if we save fewer, we'll run a greater risk of having to\n// read all the changes from 0 when checkpoint PUTs fail\n// CouchDB 2.0 has a more involved history pruning,\n// but let's go for the simple version for now.\nvar CHECKPOINT_HISTORY_SIZE = 5;\nvar LOWEST_SEQ = 0;\n\nfunction updateCheckpoint(db, id, checkpoint, session, returnValue) {\n  return db.get(id).catch(function (err) {\n    if (err.status === 404) {\n      if (db.adapter === 'http' || db.adapter === 'https') {\n        explainError(\n          404, 'PouchDB is just checking if a remote checkpoint exists.'\n        );\n      }\n      return {\n        session_id: session,\n        _id: id,\n        history: [],\n        replicator: REPLICATOR,\n        version: CHECKPOINT_VERSION\n      };\n    }\n    throw err;\n  }).then(function (doc) {\n    if (returnValue.cancelled) {\n      return;\n    }\n\n    // if the checkpoint has not changed, do not update\n    if (doc.last_seq === checkpoint) {\n      return;\n    }\n\n    // Filter out current entry for this replication\n    doc.history = (doc.history || []).filter(function (item) {\n      return item.session_id !== session;\n    });\n\n    // Add the latest checkpoint to history\n    doc.history.unshift({\n      last_seq: checkpoint,\n      session_id: session\n    });\n\n    // Just take the last pieces in history, to\n    // avoid really big checkpoint docs.\n    // see comment on history size above\n    doc.history = doc.history.slice(0, CHECKPOINT_HISTORY_SIZE);\n\n    doc.version = CHECKPOINT_VERSION;\n    doc.replicator = REPLICATOR;\n\n    doc.session_id = session;\n    doc.last_seq = checkpoint;\n\n    return db.put(doc).catch(function (err) {\n      if (err.status === 409) {\n        // retry; someone is trying to write a checkpoint simultaneously\n        return updateCheckpoint(db, id, checkpoint, session, returnValue);\n      }\n      throw err;\n    });\n  });\n}\n\nfunction Checkpointer(src, target, id, returnValue, opts) {\n  this.src = src;\n  this.target = target;\n  this.id = id;\n  this.returnValue = returnValue;\n  this.opts = opts || {};\n}\n\nCheckpointer.prototype.writeCheckpoint = function (checkpoint, session) {\n  var self = this;\n  return this.updateTarget(checkpoint, session).then(function () {\n    return self.updateSource(checkpoint, session);\n  });\n};\n\nCheckpointer.prototype.updateTarget = function (checkpoint, session) {\n  if (this.opts.writeTargetCheckpoint) {\n    return updateCheckpoint(this.target, this.id, checkpoint,\n      session, this.returnValue);\n  } else {\n    return Promise.resolve(true);\n  }\n};\n\nCheckpointer.prototype.updateSource = function (checkpoint, session) {\n  if (this.opts.writeSourceCheckpoint) {\n    var self = this;\n    return updateCheckpoint(this.src, this.id, checkpoint,\n      session, this.returnValue)\n      .catch(function (err) {\n        if (isForbiddenError(err)) {\n          self.opts.writeSourceCheckpoint = false;\n          return true;\n        }\n        throw err;\n      });\n  } else {\n    return Promise.resolve(true);\n  }\n};\n\nvar comparisons = {\n  \"undefined\": function (targetDoc, sourceDoc) {\n    // This is the previous comparison function\n    if (collate(targetDoc.last_seq, sourceDoc.last_seq) === 0) {\n      return sourceDoc.last_seq;\n    }\n    /* istanbul ignore next */\n    return 0;\n  },\n  \"1\": function (targetDoc, sourceDoc) {\n    // This is the comparison function ported from CouchDB\n    return compareReplicationLogs(sourceDoc, targetDoc).last_seq;\n  }\n};\n\nCheckpointer.prototype.getCheckpoint = function () {\n  var self = this;\n\n  if (self.opts && self.opts.writeSourceCheckpoint && !self.opts.writeTargetCheckpoint) {\n    return self.src.get(self.id).then(function (sourceDoc) {\n      return sourceDoc.last_seq || LOWEST_SEQ;\n    }).catch(function (err) {\n      /* istanbul ignore if */\n      if (err.status !== 404) {\n        throw err;\n      }\n      return LOWEST_SEQ;\n    });\n  }\n\n  return self.target.get(self.id).then(function (targetDoc) {\n    if (self.opts && self.opts.writeTargetCheckpoint && !self.opts.writeSourceCheckpoint) {\n      return targetDoc.last_seq || LOWEST_SEQ;\n    }\n\n    return self.src.get(self.id).then(function (sourceDoc) {\n      // Since we can't migrate an old version doc to a new one\n      // (no session id), we just go with the lowest seq in this case\n      /* istanbul ignore if */\n      if (targetDoc.version !== sourceDoc.version) {\n        return LOWEST_SEQ;\n      }\n\n      var version;\n      if (targetDoc.version) {\n        version = targetDoc.version.toString();\n      } else {\n        version = \"undefined\";\n      }\n\n      if (version in comparisons) {\n        return comparisons[version](targetDoc, sourceDoc);\n      }\n      /* istanbul ignore next */\n      return LOWEST_SEQ;\n    }, function (err) {\n      if (err.status === 404 && targetDoc.last_seq) {\n        return self.src.put({\n          _id: self.id,\n          last_seq: LOWEST_SEQ\n        }).then(function () {\n          return LOWEST_SEQ;\n        }, function (err) {\n          if (isForbiddenError(err)) {\n            self.opts.writeSourceCheckpoint = false;\n            return targetDoc.last_seq;\n          }\n          /* istanbul ignore next */\n          return LOWEST_SEQ;\n        });\n      }\n      throw err;\n    });\n  }).catch(function (err) {\n    if (err.status !== 404) {\n      throw err;\n    }\n    return LOWEST_SEQ;\n  });\n};\n// This checkpoint comparison is ported from CouchDBs source\n// they come from here:\n// https://github.com/apache/couchdb-couch-replicator/blob/master/src/couch_replicator.erl#L863-L906\n\nfunction compareReplicationLogs(srcDoc, tgtDoc) {\n  if (srcDoc.session_id === tgtDoc.session_id) {\n    return {\n      last_seq: srcDoc.last_seq,\n      history: srcDoc.history\n    };\n  }\n\n  return compareReplicationHistory(srcDoc.history, tgtDoc.history);\n}\n\nfunction compareReplicationHistory(sourceHistory, targetHistory) {\n  // the erlang loop via function arguments is not so easy to repeat in JS\n  // therefore, doing this as recursion\n  var S = sourceHistory[0];\n  var sourceRest = sourceHistory.slice(1);\n  var T = targetHistory[0];\n  var targetRest = targetHistory.slice(1);\n\n  if (!S || targetHistory.length === 0) {\n    return {\n      last_seq: LOWEST_SEQ,\n      history: []\n    };\n  }\n\n  var sourceId = S.session_id;\n  /* istanbul ignore if */\n  if (hasSessionId(sourceId, targetHistory)) {\n    return {\n      last_seq: S.last_seq,\n      history: sourceHistory\n    };\n  }\n\n  var targetId = T.session_id;\n  if (hasSessionId(targetId, sourceRest)) {\n    return {\n      last_seq: T.last_seq,\n      history: targetRest\n    };\n  }\n\n  return compareReplicationHistory(sourceRest, targetRest);\n}\n\nfunction hasSessionId(sessionId, history) {\n  var props = history[0];\n  var rest = history.slice(1);\n\n  if (!sessionId || history.length === 0) {\n    return false;\n  }\n\n  if (sessionId === props.session_id) {\n    return true;\n  }\n\n  return hasSessionId(sessionId, rest);\n}\n\nfunction isForbiddenError(err) {\n  return typeof err.status === 'number' && Math.floor(err.status / 100) === 4;\n}\n\nvar STARTING_BACK_OFF = 0;\n\nfunction backOff(opts, returnValue, error, callback) {\n  if (opts.retry === false) {\n    returnValue.emit('error', error);\n    returnValue.removeAllListeners();\n    return;\n  }\n  /* istanbul ignore if */\n  if (typeof opts.back_off_function !== 'function') {\n    opts.back_off_function = defaultBackOff;\n  }\n  returnValue.emit('requestError', error);\n  if (returnValue.state === 'active' || returnValue.state === 'pending') {\n    returnValue.emit('paused', error);\n    returnValue.state = 'stopped';\n    var backOffSet = function backoffTimeSet() {\n      opts.current_back_off = STARTING_BACK_OFF;\n    };\n    var removeBackOffSetter = function removeBackOffTimeSet() {\n      returnValue.removeListener('active', backOffSet);\n    };\n    returnValue.once('paused', removeBackOffSetter);\n    returnValue.once('active', backOffSet);\n  }\n\n  opts.current_back_off = opts.current_back_off || STARTING_BACK_OFF;\n  opts.current_back_off = opts.back_off_function(opts.current_back_off);\n  setTimeout(callback, opts.current_back_off);\n}\n\nfunction sortObjectPropertiesByKey(queryParams) {\n  return Object.keys(queryParams).sort(collate).reduce(function (result, key) {\n    result[key] = queryParams[key];\n    return result;\n  }, {});\n}\n\n// Generate a unique id particular to this replication.\n// Not guaranteed to align perfectly with CouchDB's rep ids.\nfunction generateReplicationId(src, target, opts) {\n  var docIds = opts.doc_ids ? opts.doc_ids.sort(collate) : '';\n  var filterFun = opts.filter ? opts.filter.toString() : '';\n  var queryParams = '';\n  var filterViewName =  '';\n  var selector = '';\n\n  // possibility for checkpoints to be lost here as behaviour of\n  // JSON.stringify is not stable (see #6226)\n  /* istanbul ignore if */\n  if (opts.selector) {\n    selector = JSON.stringify(opts.selector);\n  }\n\n  if (opts.filter && opts.query_params) {\n    queryParams = JSON.stringify(sortObjectPropertiesByKey(opts.query_params));\n  }\n\n  if (opts.filter && opts.filter === '_view') {\n    filterViewName = opts.view.toString();\n  }\n\n  return Promise.all([src.id(), target.id()]).then(function (res) {\n    var queryData = res[0] + res[1] + filterFun + filterViewName +\n      queryParams + docIds + selector;\n    return new Promise(function (resolve) {\n      binaryMd5(queryData, resolve);\n    });\n  }).then(function (md5sum) {\n    // can't use straight-up md5 alphabet, because\n    // the char '/' is interpreted as being for attachments,\n    // and + is also not url-safe\n    md5sum = md5sum.replace(/\\//g, '.').replace(/\\+/g, '_');\n    return '_local/' + md5sum;\n  });\n}\n\nfunction replicate(src, target, opts, returnValue, result) {\n  var batches = [];               // list of batches to be processed\n  var currentBatch;               // the batch currently being processed\n  var pendingBatch = {\n    seq: 0,\n    changes: [],\n    docs: []\n  }; // next batch, not yet ready to be processed\n  var writingCheckpoint = false;  // true while checkpoint is being written\n  var changesCompleted = false;   // true when all changes received\n  var replicationCompleted = false; // true when replication has completed\n  var last_seq = 0;\n  var continuous = opts.continuous || opts.live || false;\n  var batch_size = opts.batch_size || 100;\n  var batches_limit = opts.batches_limit || 10;\n  var changesPending = false;     // true while src.changes is running\n  var doc_ids = opts.doc_ids;\n  var selector = opts.selector;\n  var repId;\n  var checkpointer;\n  var changedDocs = [];\n  // Like couchdb, every replication gets a unique session id\n  var session = uuid();\n\n  result = result || {\n    ok: true,\n    start_time: new Date().toISOString(),\n    docs_read: 0,\n    docs_written: 0,\n    doc_write_failures: 0,\n    errors: []\n  };\n\n  var changesOpts = {};\n  returnValue.ready(src, target);\n\n  function initCheckpointer() {\n    if (checkpointer) {\n      return Promise.resolve();\n    }\n    return generateReplicationId(src, target, opts).then(function (res) {\n      repId = res;\n\n      var checkpointOpts = {};\n      if (opts.checkpoint === false) {\n        checkpointOpts = { writeSourceCheckpoint: false, writeTargetCheckpoint: false };\n      } else if (opts.checkpoint === 'source') {\n        checkpointOpts = { writeSourceCheckpoint: true, writeTargetCheckpoint: false };\n      } else if (opts.checkpoint === 'target') {\n        checkpointOpts = { writeSourceCheckpoint: false, writeTargetCheckpoint: true };\n      } else {\n        checkpointOpts = { writeSourceCheckpoint: true, writeTargetCheckpoint: true };\n      }\n\n      checkpointer = new Checkpointer(src, target, repId, returnValue, checkpointOpts);\n    });\n  }\n\n  function writeDocs() {\n    changedDocs = [];\n\n    if (currentBatch.docs.length === 0) {\n      return;\n    }\n    var docs = currentBatch.docs;\n    var bulkOpts = {timeout: opts.timeout};\n    return target.bulkDocs({docs: docs, new_edits: false}, bulkOpts).then(function (res) {\n      /* istanbul ignore if */\n      if (returnValue.cancelled) {\n        completeReplication();\n        throw new Error('cancelled');\n      }\n\n      // `res` doesn't include full documents (which live in `docs`), so we create a map of \n      // (id -> error), and check for errors while iterating over `docs`\n      var errorsById = Object.create(null);\n      res.forEach(function (res) {\n        if (res.error) {\n          errorsById[res.id] = res;\n        }\n      });\n\n      var errorsNo = Object.keys(errorsById).length;\n      result.doc_write_failures += errorsNo;\n      result.docs_written += docs.length - errorsNo;\n\n      docs.forEach(function (doc) {\n        var error = errorsById[doc._id];\n        if (error) {\n          result.errors.push(error);\n          // Normalize error name. i.e. 'Unauthorized' -> 'unauthorized' (eg Sync Gateway)\n          var errorName = (error.name || '').toLowerCase();\n          if (errorName === 'unauthorized' || errorName === 'forbidden') {\n            returnValue.emit('denied', clone(error));\n          } else {\n            throw error;\n          }\n        } else {\n          changedDocs.push(doc);\n        }\n      });\n\n    }, function (err) {\n      result.doc_write_failures += docs.length;\n      throw err;\n    });\n  }\n\n  function finishBatch() {\n    if (currentBatch.error) {\n      throw new Error('There was a problem getting docs.');\n    }\n    result.last_seq = last_seq = currentBatch.seq;\n    var outResult = clone(result);\n    if (changedDocs.length) {\n      outResult.docs = changedDocs;\n      // Attach 'pending' property if server supports it (CouchDB 2.0+)\n      /* istanbul ignore if */\n      if (typeof currentBatch.pending === 'number') {\n        outResult.pending = currentBatch.pending;\n        delete currentBatch.pending;\n      }\n      returnValue.emit('change', outResult);\n    }\n    writingCheckpoint = true;\n    return checkpointer.writeCheckpoint(currentBatch.seq,\n        session).then(function () {\n      writingCheckpoint = false;\n      /* istanbul ignore if */\n      if (returnValue.cancelled) {\n        completeReplication();\n        throw new Error('cancelled');\n      }\n      currentBatch = undefined;\n      getChanges();\n    }).catch(function (err) {\n      onCheckpointError(err);\n      throw err;\n    });\n  }\n\n  function getDiffs() {\n    var diff = {};\n    currentBatch.changes.forEach(function (change) {\n      // Couchbase Sync Gateway emits these, but we can ignore them\n      /* istanbul ignore if */\n      if (change.id === \"_user/\") {\n        return;\n      }\n      diff[change.id] = change.changes.map(function (x) {\n        return x.rev;\n      });\n    });\n    return target.revsDiff(diff).then(function (diffs) {\n      /* istanbul ignore if */\n      if (returnValue.cancelled) {\n        completeReplication();\n        throw new Error('cancelled');\n      }\n      // currentBatch.diffs elements are deleted as the documents are written\n      currentBatch.diffs = diffs;\n    });\n  }\n\n  function getBatchDocs() {\n    return getDocs(src, target, currentBatch.diffs, returnValue).then(function (got) {\n      currentBatch.error = !got.ok;\n      got.docs.forEach(function (doc) {\n        delete currentBatch.diffs[doc._id];\n        result.docs_read++;\n        currentBatch.docs.push(doc);\n      });\n    });\n  }\n\n  function startNextBatch() {\n    if (returnValue.cancelled || currentBatch) {\n      return;\n    }\n    if (batches.length === 0) {\n      processPendingBatch(true);\n      return;\n    }\n    currentBatch = batches.shift();\n    getDiffs()\n      .then(getBatchDocs)\n      .then(writeDocs)\n      .then(finishBatch)\n      .then(startNextBatch)\n      .catch(function (err) {\n        abortReplication('batch processing terminated with error', err);\n      });\n  }\n\n\n  function processPendingBatch(immediate$$1) {\n    if (pendingBatch.changes.length === 0) {\n      if (batches.length === 0 && !currentBatch) {\n        if ((continuous && changesOpts.live) || changesCompleted) {\n          returnValue.state = 'pending';\n          returnValue.emit('paused');\n        }\n        if (changesCompleted) {\n          completeReplication();\n        }\n      }\n      return;\n    }\n    if (\n      immediate$$1 ||\n      changesCompleted ||\n      pendingBatch.changes.length >= batch_size\n    ) {\n      batches.push(pendingBatch);\n      pendingBatch = {\n        seq: 0,\n        changes: [],\n        docs: []\n      };\n      if (returnValue.state === 'pending' || returnValue.state === 'stopped') {\n        returnValue.state = 'active';\n        returnValue.emit('active');\n      }\n      startNextBatch();\n    }\n  }\n\n\n  function abortReplication(reason, err) {\n    if (replicationCompleted) {\n      return;\n    }\n    if (!err.message) {\n      err.message = reason;\n    }\n    result.ok = false;\n    result.status = 'aborting';\n    batches = [];\n    pendingBatch = {\n      seq: 0,\n      changes: [],\n      docs: []\n    };\n    completeReplication(err);\n  }\n\n\n  function completeReplication(fatalError) {\n    if (replicationCompleted) {\n      return;\n    }\n    /* istanbul ignore if */\n    if (returnValue.cancelled) {\n      result.status = 'cancelled';\n      if (writingCheckpoint) {\n        return;\n      }\n    }\n    result.status = result.status || 'complete';\n    result.end_time = new Date().toISOString();\n    result.last_seq = last_seq;\n    replicationCompleted = true;\n\n    if (fatalError) {\n      // need to extend the error because Firefox considers \".result\" read-only\n      fatalError = createError(fatalError);\n      fatalError.result = result;\n\n      // Normalize error name. i.e. 'Unauthorized' -> 'unauthorized' (eg Sync Gateway)\n      var errorName = (fatalError.name || '').toLowerCase();\n      if (errorName === 'unauthorized' || errorName === 'forbidden') {\n        returnValue.emit('error', fatalError);\n        returnValue.removeAllListeners();\n      } else {\n        backOff(opts, returnValue, fatalError, function () {\n          replicate(src, target, opts, returnValue);\n        });\n      }\n    } else {\n      returnValue.emit('complete', result);\n      returnValue.removeAllListeners();\n    }\n  }\n\n\n  function onChange(change, pending, lastSeq) {\n    /* istanbul ignore if */\n    if (returnValue.cancelled) {\n      return completeReplication();\n    }\n    // Attach 'pending' property if server supports it (CouchDB 2.0+)\n    /* istanbul ignore if */\n    if (typeof pending === 'number') {\n      pendingBatch.pending = pending;\n    }\n\n    var filter = filterChange(opts)(change);\n    if (!filter) {\n      return;\n    }\n    pendingBatch.seq = change.seq || lastSeq;\n    pendingBatch.changes.push(change);\n    immediate(function () {\n      processPendingBatch(batches.length === 0 && changesOpts.live);\n    });\n  }\n\n\n  function onChangesComplete(changes) {\n    changesPending = false;\n    /* istanbul ignore if */\n    if (returnValue.cancelled) {\n      return completeReplication();\n    }\n\n    // if no results were returned then we're done,\n    // else fetch more\n    if (changes.results.length > 0) {\n      changesOpts.since = changes.results[changes.results.length - 1].seq;\n      getChanges();\n      processPendingBatch(true);\n    } else {\n\n      var complete = function () {\n        if (continuous) {\n          changesOpts.live = true;\n          getChanges();\n        } else {\n          changesCompleted = true;\n        }\n        processPendingBatch(true);\n      };\n\n      // update the checkpoint so we start from the right seq next time\n      if (!currentBatch && changes.results.length === 0) {\n        writingCheckpoint = true;\n        checkpointer.writeCheckpoint(changes.last_seq,\n            session).then(function () {\n          writingCheckpoint = false;\n          result.last_seq = last_seq = changes.last_seq;\n          complete();\n        })\n        .catch(onCheckpointError);\n      } else {\n        complete();\n      }\n    }\n  }\n\n\n  function onChangesError(err) {\n    changesPending = false;\n    /* istanbul ignore if */\n    if (returnValue.cancelled) {\n      return completeReplication();\n    }\n    abortReplication('changes rejected', err);\n  }\n\n\n  function getChanges() {\n    if (!(\n      !changesPending &&\n      !changesCompleted &&\n      batches.length < batches_limit\n      )) {\n      return;\n    }\n    changesPending = true;\n    function abortChanges() {\n      changes.cancel();\n    }\n    function removeListener() {\n      returnValue.removeListener('cancel', abortChanges);\n    }\n\n    if (returnValue._changes) { // remove old changes() and listeners\n      returnValue.removeListener('cancel', returnValue._abortChanges);\n      returnValue._changes.cancel();\n    }\n    returnValue.once('cancel', abortChanges);\n\n    var changes = src.changes(changesOpts)\n      .on('change', onChange);\n    changes.then(removeListener, removeListener);\n    changes.then(onChangesComplete)\n      .catch(onChangesError);\n\n    if (opts.retry) {\n      // save for later so we can cancel if necessary\n      returnValue._changes = changes;\n      returnValue._abortChanges = abortChanges;\n    }\n  }\n\n\n  function startChanges() {\n    initCheckpointer().then(function () {\n      /* istanbul ignore if */\n      if (returnValue.cancelled) {\n        completeReplication();\n        return;\n      }\n      return checkpointer.getCheckpoint().then(function (checkpoint) {\n        last_seq = checkpoint;\n        changesOpts = {\n          since: last_seq,\n          limit: batch_size,\n          batch_size: batch_size,\n          style: 'all_docs',\n          doc_ids: doc_ids,\n          selector: selector,\n          return_docs: true // required so we know when we're done\n        };\n        if (opts.filter) {\n          if (typeof opts.filter !== 'string') {\n            // required for the client-side filter in onChange\n            changesOpts.include_docs = true;\n          } else { // ddoc filter\n            changesOpts.filter = opts.filter;\n          }\n        }\n        if ('heartbeat' in opts) {\n          changesOpts.heartbeat = opts.heartbeat;\n        }\n        if ('timeout' in opts) {\n          changesOpts.timeout = opts.timeout;\n        }\n        if (opts.query_params) {\n          changesOpts.query_params = opts.query_params;\n        }\n        if (opts.view) {\n          changesOpts.view = opts.view;\n        }\n        getChanges();\n      });\n    }).catch(function (err) {\n      abortReplication('getCheckpoint rejected with ', err);\n    });\n  }\n\n  /* istanbul ignore next */\n  function onCheckpointError(err) {\n    writingCheckpoint = false;\n    abortReplication('writeCheckpoint completed with error', err);\n  }\n\n  /* istanbul ignore if */\n  if (returnValue.cancelled) { // cancelled immediately\n    completeReplication();\n    return;\n  }\n\n  if (!returnValue._addedListeners) {\n    returnValue.once('cancel', completeReplication);\n\n    if (typeof opts.complete === 'function') {\n      returnValue.once('error', opts.complete);\n      returnValue.once('complete', function (result) {\n        opts.complete(null, result);\n      });\n    }\n    returnValue._addedListeners = true;\n  }\n\n  if (typeof opts.since === 'undefined') {\n    startChanges();\n  } else {\n    initCheckpointer().then(function () {\n      writingCheckpoint = true;\n      return checkpointer.writeCheckpoint(opts.since, session);\n    }).then(function () {\n      writingCheckpoint = false;\n      /* istanbul ignore if */\n      if (returnValue.cancelled) {\n        completeReplication();\n        return;\n      }\n      last_seq = opts.since;\n      startChanges();\n    }).catch(onCheckpointError);\n  }\n}\n\n// We create a basic promise so the caller can cancel the replication possibly\n// before we have actually started listening to changes etc\ninherits(Replication, EE);\nfunction Replication() {\n  EE.call(this);\n  this.cancelled = false;\n  this.state = 'pending';\n  var self = this;\n  var promise = new Promise(function (fulfill, reject) {\n    self.once('complete', fulfill);\n    self.once('error', reject);\n  });\n  self.then = function (resolve, reject) {\n    return promise.then(resolve, reject);\n  };\n  self.catch = function (reject) {\n    return promise.catch(reject);\n  };\n  // As we allow error handling via \"error\" event as well,\n  // put a stub in here so that rejecting never throws UnhandledError.\n  self.catch(function () {});\n}\n\nReplication.prototype.cancel = function () {\n  this.cancelled = true;\n  this.state = 'cancelled';\n  this.emit('cancel');\n};\n\nReplication.prototype.ready = function (src, target) {\n  var self = this;\n  if (self._readyCalled) {\n    return;\n  }\n  self._readyCalled = true;\n\n  function onDestroy() {\n    self.cancel();\n  }\n  src.once('destroyed', onDestroy);\n  target.once('destroyed', onDestroy);\n  function cleanup() {\n    src.removeListener('destroyed', onDestroy);\n    target.removeListener('destroyed', onDestroy);\n  }\n  self.once('complete', cleanup);\n};\n\nfunction toPouch(db, opts) {\n  var PouchConstructor = opts.PouchConstructor;\n  if (typeof db === 'string') {\n    return new PouchConstructor(db, opts);\n  } else {\n    return db;\n  }\n}\n\nfunction replicateWrapper(src, target, opts, callback) {\n\n  if (typeof opts === 'function') {\n    callback = opts;\n    opts = {};\n  }\n  if (typeof opts === 'undefined') {\n    opts = {};\n  }\n\n  if (opts.doc_ids && !Array.isArray(opts.doc_ids)) {\n    throw createError(BAD_REQUEST,\n                       \"`doc_ids` filter parameter is not a list.\");\n  }\n\n  opts.complete = callback;\n  opts = clone(opts);\n  opts.continuous = opts.continuous || opts.live;\n  opts.retry = ('retry' in opts) ? opts.retry : false;\n  /*jshint validthis:true */\n  opts.PouchConstructor = opts.PouchConstructor || this;\n  var replicateRet = new Replication(opts);\n  var srcPouch = toPouch(src, opts);\n  var targetPouch = toPouch(target, opts);\n  replicate(srcPouch, targetPouch, opts, replicateRet);\n  return replicateRet;\n}\n\ninherits(Sync, EE);\nfunction sync(src, target, opts, callback) {\n  if (typeof opts === 'function') {\n    callback = opts;\n    opts = {};\n  }\n  if (typeof opts === 'undefined') {\n    opts = {};\n  }\n  opts = clone(opts);\n  /*jshint validthis:true */\n  opts.PouchConstructor = opts.PouchConstructor || this;\n  src = toPouch(src, opts);\n  target = toPouch(target, opts);\n  return new Sync(src, target, opts, callback);\n}\n\nfunction Sync(src, target, opts, callback) {\n  var self = this;\n  this.canceled = false;\n\n  var optsPush = opts.push ? $inject_Object_assign({}, opts, opts.push) : opts;\n  var optsPull = opts.pull ? $inject_Object_assign({}, opts, opts.pull) : opts;\n\n  this.push = replicateWrapper(src, target, optsPush);\n  this.pull = replicateWrapper(target, src, optsPull);\n\n  this.pushPaused = true;\n  this.pullPaused = true;\n\n  function pullChange(change) {\n    self.emit('change', {\n      direction: 'pull',\n      change: change\n    });\n  }\n  function pushChange(change) {\n    self.emit('change', {\n      direction: 'push',\n      change: change\n    });\n  }\n  function pushDenied(doc) {\n    self.emit('denied', {\n      direction: 'push',\n      doc: doc\n    });\n  }\n  function pullDenied(doc) {\n    self.emit('denied', {\n      direction: 'pull',\n      doc: doc\n    });\n  }\n  function pushPaused() {\n    self.pushPaused = true;\n    /* istanbul ignore if */\n    if (self.pullPaused) {\n      self.emit('paused');\n    }\n  }\n  function pullPaused() {\n    self.pullPaused = true;\n    /* istanbul ignore if */\n    if (self.pushPaused) {\n      self.emit('paused');\n    }\n  }\n  function pushActive() {\n    self.pushPaused = false;\n    /* istanbul ignore if */\n    if (self.pullPaused) {\n      self.emit('active', {\n        direction: 'push'\n      });\n    }\n  }\n  function pullActive() {\n    self.pullPaused = false;\n    /* istanbul ignore if */\n    if (self.pushPaused) {\n      self.emit('active', {\n        direction: 'pull'\n      });\n    }\n  }\n\n  var removed = {};\n\n  function removeAll(type) { // type is 'push' or 'pull'\n    return function (event, func) {\n      var isChange = event === 'change' &&\n        (func === pullChange || func === pushChange);\n      var isDenied = event === 'denied' &&\n        (func === pullDenied || func === pushDenied);\n      var isPaused = event === 'paused' &&\n        (func === pullPaused || func === pushPaused);\n      var isActive = event === 'active' &&\n        (func === pullActive || func === pushActive);\n\n      if (isChange || isDenied || isPaused || isActive) {\n        if (!(event in removed)) {\n          removed[event] = {};\n        }\n        removed[event][type] = true;\n        if (Object.keys(removed[event]).length === 2) {\n          // both push and pull have asked to be removed\n          self.removeAllListeners(event);\n        }\n      }\n    };\n  }\n\n  if (opts.live) {\n    this.push.on('complete', self.pull.cancel.bind(self.pull));\n    this.pull.on('complete', self.push.cancel.bind(self.push));\n  }\n\n  function addOneListener(ee, event, listener) {\n    if (ee.listeners(event).indexOf(listener) == -1) {\n      ee.on(event, listener);\n    }\n  }\n\n  this.on('newListener', function (event) {\n    if (event === 'change') {\n      addOneListener(self.pull, 'change', pullChange);\n      addOneListener(self.push, 'change', pushChange);\n    } else if (event === 'denied') {\n      addOneListener(self.pull, 'denied', pullDenied);\n      addOneListener(self.push, 'denied', pushDenied);\n    } else if (event === 'active') {\n      addOneListener(self.pull, 'active', pullActive);\n      addOneListener(self.push, 'active', pushActive);\n    } else if (event === 'paused') {\n      addOneListener(self.pull, 'paused', pullPaused);\n      addOneListener(self.push, 'paused', pushPaused);\n    }\n  });\n\n  this.on('removeListener', function (event) {\n    if (event === 'change') {\n      self.pull.removeListener('change', pullChange);\n      self.push.removeListener('change', pushChange);\n    } else if (event === 'denied') {\n      self.pull.removeListener('denied', pullDenied);\n      self.push.removeListener('denied', pushDenied);\n    } else if (event === 'active') {\n      self.pull.removeListener('active', pullActive);\n      self.push.removeListener('active', pushActive);\n    } else if (event === 'paused') {\n      self.pull.removeListener('paused', pullPaused);\n      self.push.removeListener('paused', pushPaused);\n    }\n  });\n\n  this.pull.on('removeListener', removeAll('pull'));\n  this.push.on('removeListener', removeAll('push'));\n\n  var promise = Promise.all([\n    this.push,\n    this.pull\n  ]).then(function (resp) {\n    var out = {\n      push: resp[0],\n      pull: resp[1]\n    };\n    self.emit('complete', out);\n    if (callback) {\n      callback(null, out);\n    }\n    self.removeAllListeners();\n    return out;\n  }, function (err) {\n    self.cancel();\n    if (callback) {\n      // if there's a callback, then the callback can receive\n      // the error event\n      callback(err);\n    } else {\n      // if there's no callback, then we're safe to emit an error\n      // event, which would otherwise throw an unhandled error\n      // due to 'error' being a special event in EventEmitters\n      self.emit('error', err);\n    }\n    self.removeAllListeners();\n    if (callback) {\n      // no sense throwing if we're already emitting an 'error' event\n      throw err;\n    }\n  });\n\n  this.then = function (success, err) {\n    return promise.then(success, err);\n  };\n\n  this.catch = function (err) {\n    return promise.catch(err);\n  };\n}\n\nSync.prototype.cancel = function () {\n  if (!this.canceled) {\n    this.canceled = true;\n    this.push.cancel();\n    this.pull.cancel();\n  }\n};\n\nfunction replication(PouchDB) {\n  PouchDB.replicate = replicateWrapper;\n  PouchDB.sync = sync;\n\n  Object.defineProperty(PouchDB.prototype, 'replicate', {\n    get: function () {\n      var self = this;\n      if (typeof this.replicateMethods === 'undefined') {\n        this.replicateMethods = {\n          from: function (other, opts, callback) {\n            return self.constructor.replicate(other, self, opts, callback);\n          },\n          to: function (other, opts, callback) {\n            return self.constructor.replicate(self, other, opts, callback);\n          }\n        };\n      }\n      return this.replicateMethods;\n    }\n  });\n\n  PouchDB.prototype.sync = function (dbName, opts, callback) {\n    return this.constructor.sync(this, dbName, opts, callback);\n  };\n}\n\nPouchDB.plugin(IDBPouch)\n  .plugin(HttpPouch$1)\n  .plugin(mapreduce)\n  .plugin(replication);\n\n// Pull from src because pouchdb-node/pouchdb-browser themselves\n\nexport default PouchDB;\n","'use strict';\nexports.test = function () {\n  return typeof global.queueMicrotask === 'function';\n};\n\nexports.install = function (func) {\n  return function () {\n    global.queueMicrotask(func);\n  };\n};\n","'use strict';\n//based off rsvp https://github.com/tildeio/rsvp.js\n//license https://github.com/tildeio/rsvp.js/blob/master/LICENSE\n//https://github.com/tildeio/rsvp.js/blob/master/lib/rsvp/asap.js\n\nvar Mutation = global.MutationObserver || global.WebKitMutationObserver;\n\nexports.test = function () {\n  return Mutation;\n};\n\nexports.install = function (handle) {\n  var called = 0;\n  var observer = new Mutation(handle);\n  var element = global.document.createTextNode('');\n  observer.observe(element, {\n    characterData: true\n  });\n  return function () {\n    element.data = (called = ++called % 2);\n  };\n};","'use strict';\n\nexports.test = function () {\n  if (global.setImmediate) {\n    // we can only get here in IE10\n    // which doesn't handel postMessage well\n    return false;\n  }\n  return typeof global.MessageChannel !== 'undefined';\n};\n\nexports.install = function (func) {\n  var channel = new global.MessageChannel();\n  channel.port1.onmessage = func;\n  return function () {\n    channel.port2.postMessage(0);\n  };\n};","'use strict';\n\nexports.test = function () {\n  return 'document' in global && 'onreadystatechange' in global.document.createElement('script');\n};\n\nexports.install = function (handle) {\n  return function () {\n\n    // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n    // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n    var scriptEl = global.document.createElement('script');\n    scriptEl.onreadystatechange = function () {\n      handle();\n\n      scriptEl.onreadystatechange = null;\n      scriptEl.parentNode.removeChild(scriptEl);\n      scriptEl = null;\n    };\n    global.document.documentElement.appendChild(scriptEl);\n\n    return handle;\n  };\n};","'use strict';\nexports.test = function () {\n  return true;\n};\n\nexports.install = function (t) {\n  return function () {\n    setTimeout(t, 0);\n  };\n};","/*!@license\n * UAParser.js v0.7.28\n * Lightweight JavaScript-based User-Agent string parser\n * https://github.com/faisalman/ua-parser-js\n *\n * Copyright  2012-2021 Faisal Salman <f@faisalman.com>\n * Licensed under MIT License\n */\n\n(function (window, undefined) {\n\n    'use strict';\n\n    //////////////\n    // Constants\n    /////////////\n\n\n    var LIBVERSION  = '0.7.28',\n        EMPTY       = '',\n        UNKNOWN     = '?',\n        FUNC_TYPE   = 'function',\n        UNDEF_TYPE  = 'undefined',\n        OBJ_TYPE    = 'object',\n        STR_TYPE    = 'string',\n        MAJOR       = 'major', // deprecated\n        MODEL       = 'model',\n        NAME        = 'name',\n        TYPE        = 'type',\n        VENDOR      = 'vendor',\n        VERSION     = 'version',\n        ARCHITECTURE= 'architecture',\n        CONSOLE     = 'console',\n        MOBILE      = 'mobile',\n        TABLET      = 'tablet',\n        SMARTTV     = 'smarttv',\n        WEARABLE    = 'wearable',\n        EMBEDDED    = 'embedded',\n        UA_MAX_LENGTH = 255;\n\n\n    ///////////\n    // Helper\n    //////////\n\n\n    var util = {\n        extend : function (regexes, extensions) {\n            var mergedRegexes = {};\n            for (var i in regexes) {\n                if (extensions[i] && extensions[i].length % 2 === 0) {\n                    mergedRegexes[i] = extensions[i].concat(regexes[i]);\n                } else {\n                    mergedRegexes[i] = regexes[i];\n                }\n            }\n            return mergedRegexes;\n        },\n        has : function (str1, str2) {\n            return typeof str1 === STR_TYPE ? str2.toLowerCase().indexOf(str1.toLowerCase()) !== -1 : false;\n        },\n        lowerize : function (str) {\n            return str.toLowerCase();\n        },\n        major : function (version) {\n            return typeof(version) === STR_TYPE ? version.replace(/[^\\d\\.]/g,'').split(\".\")[0] : undefined;\n        },\n        trim : function (str, len) {\n            str = str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n            return typeof(len) === UNDEF_TYPE ? str : str.substring(0, UA_MAX_LENGTH);\n        }\n    };\n\n\n    ///////////////\n    // Map helper\n    //////////////\n\n\n    var mapper = {\n\n        rgx : function (ua, arrays) {\n\n            var i = 0, j, k, p, q, matches, match;\n\n            // loop through all regexes maps\n            while (i < arrays.length && !matches) {\n\n                var regex = arrays[i],       // even sequence (0,2,4,..)\n                    props = arrays[i + 1];   // odd sequence (1,3,5,..)\n                j = k = 0;\n\n                // try matching uastring with regexes\n                while (j < regex.length && !matches) {\n\n                    matches = regex[j++].exec(ua);\n\n                    if (!!matches) {\n                        for (p = 0; p < props.length; p++) {\n                            match = matches[++k];\n                            q = props[p];\n                            // check if given property is actually array\n                            if (typeof q === OBJ_TYPE && q.length > 0) {\n                                if (q.length == 2) {\n                                    if (typeof q[1] == FUNC_TYPE) {\n                                        // assign modified match\n                                        this[q[0]] = q[1].call(this, match);\n                                    } else {\n                                        // assign given value, ignore regex match\n                                        this[q[0]] = q[1];\n                                    }\n                                } else if (q.length == 3) {\n                                    // check whether function or regex\n                                    if (typeof q[1] === FUNC_TYPE && !(q[1].exec && q[1].test)) {\n                                        // call function (usually string mapper)\n                                        this[q[0]] = match ? q[1].call(this, match, q[2]) : undefined;\n                                    } else {\n                                        // sanitize match using given regex\n                                        this[q[0]] = match ? match.replace(q[1], q[2]) : undefined;\n                                    }\n                                } else if (q.length == 4) {\n                                        this[q[0]] = match ? q[3].call(this, match.replace(q[1], q[2])) : undefined;\n                                }\n                            } else {\n                                this[q] = match ? match : undefined;\n                            }\n                        }\n                    }\n                }\n                i += 2;\n            }\n        },\n\n        str : function (str, map) {\n\n            for (var i in map) {\n                // check if array\n                if (typeof map[i] === OBJ_TYPE && map[i].length > 0) {\n                    for (var j = 0; j < map[i].length; j++) {\n                        if (util.has(map[i][j], str)) {\n                            return (i === UNKNOWN) ? undefined : i;\n                        }\n                    }\n                } else if (util.has(map[i], str)) {\n                    return (i === UNKNOWN) ? undefined : i;\n                }\n            }\n            return str;\n        }\n    };\n\n\n    ///////////////\n    // String map\n    //////////////\n\n\n    var maps = {\n\n        browser : {\n            // Safari < 3.0\n            oldSafari : {\n                version : {\n                    '1.0'   : '/8',\n                    '1.2'   : '/1',\n                    '1.3'   : '/3',\n                    '2.0'   : '/412',\n                    '2.0.2' : '/416',\n                    '2.0.3' : '/417',\n                    '2.0.4' : '/419',\n                    '?'     : '/'\n                }\n            },\n            oldEdge : {\n                version : {\n                    '0.1'   : '12.',\n                    '21'    : '13.',\n                    '31'    : '14.',\n                    '39'    : '15.',\n                    '41'    : '16.',\n                    '42'    : '17.',\n                    '44'    : '18.'\n                }\n            }\n        },\n\n        os : {\n            windows : {\n                version : {\n                    'ME'        : '4.90',\n                    'NT 3.11'   : 'NT3.51',\n                    'NT 4.0'    : 'NT4.0',\n                    '2000'      : 'NT 5.0',\n                    'XP'        : ['NT 5.1', 'NT 5.2'],\n                    'Vista'     : 'NT 6.0',\n                    '7'         : 'NT 6.1',\n                    '8'         : 'NT 6.2',\n                    '8.1'       : 'NT 6.3',\n                    '10'        : ['NT 6.4', 'NT 10.0'],\n                    'RT'        : 'ARM'\n                }\n            }\n        }\n    };\n\n\n    //////////////\n    // Regex map\n    /////////////\n\n\n    var regexes = {\n\n        browser : [[\n\n            /\\b(?:crmo|crios)\\/([\\w\\.]+)/i                                      // Chrome for Android/iOS\n            ], [VERSION, [NAME, 'Chrome']], [\n            /edg(?:e|ios|a)?\\/([\\w\\.]+)/i                                       // Microsoft Edge\n            ], [VERSION, [NAME, 'Edge']], [\n            // breaking change (reserved for next major release):\n            ///edge\\/([\\w\\.]+)/i                                                  // Old Edge (Trident)\n            //], [[VERSION, mapper.str, maps.browser.oldEdge.version], [NAME, 'Edge']], [\n\n            // Presto based\n            /(opera\\smini)\\/([\\w\\.-]+)/i,                                       // Opera Mini\n            /(opera\\s[mobiletab]{3,6})\\b.+version\\/([\\w\\.-]+)/i,                // Opera Mobi/Tablet\n            /(opera)(?:.+version\\/|[\\/\\s]+)([\\w\\.]+)/i,                         // Opera\n            ], [NAME, VERSION], [\n            /opios[\\/\\s]+([\\w\\.]+)/i                                            // Opera mini on iphone >= 8.0\n            ], [VERSION, [NAME, 'Opera Mini']], [\n            /\\sopr\\/([\\w\\.]+)/i                                                 // Opera Webkit\n            ], [VERSION, [NAME, 'Opera']], [\n\n            // Mixed\n            /(kindle)\\/([\\w\\.]+)/i,                                             // Kindle\n            /(lunascape|maxthon|netfront|jasmine|blazer)[\\/\\s]?([\\w\\.]*)/i,     // Lunascape/Maxthon/Netfront/Jasmine/Blazer\n            // Trident based\n            /(avant\\s|iemobile|slim)(?:browser)?[\\/\\s]?([\\w\\.]*)/i,             // Avant/IEMobile/SlimBrowser\n            /(ba?idubrowser)[\\/\\s]?([\\w\\.]+)/i,                                 // Baidu Browser\n            /(?:ms|\\()(ie)\\s([\\w\\.]+)/i,                                        // Internet Explorer\n\n            // Webkit/KHTML based\n            /(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\\/([\\w\\.-]+)/i,\n                                                                                // Flock/RockMelt/Midori/Epiphany/Silk/Skyfire/Bolt/Iron/Iridium/PhantomJS/Bowser/QupZilla/Falkon\n            /(rekonq|puffin|brave|whale|qqbrowserlite|qq)\\/([\\w\\.]+)/i,         // Rekonq/Puffin/Brave/Whale/QQBrowserLite/QQ, aka ShouQ\n            /(weibo)__([\\d\\.]+)/i                                               // Weibo\n            ], [NAME, VERSION], [\n            /(?:[\\s\\/]uc?\\s?browser|(?:juc.+)ucweb)[\\/\\s]?([\\w\\.]+)/i           // UCBrowser\n            ], [VERSION, [NAME, 'UCBrowser']], [\n            /(?:windowswechat)?\\sqbcore\\/([\\w\\.]+)\\b.*(?:windowswechat)?/i      // WeChat Desktop for Windows Built-in Browser\n            ], [VERSION, [NAME, 'WeChat(Win) Desktop']], [\n            /micromessenger\\/([\\w\\.]+)/i                                        // WeChat\n            ], [VERSION, [NAME, 'WeChat']], [\n            /konqueror\\/([\\w\\.]+)/i                                             // Konqueror\n            ], [VERSION, [NAME, 'Konqueror']], [\n            /trident.+rv[:\\s]([\\w\\.]{1,9})\\b.+like\\sgecko/i                     // IE11\n            ], [VERSION, [NAME, 'IE']], [\n            /yabrowser\\/([\\w\\.]+)/i                                             // Yandex\n            ], [VERSION, [NAME, 'Yandex']], [\n            /(avast|avg)\\/([\\w\\.]+)/i                                           // Avast/AVG Secure Browser\n            ], [[NAME, /(.+)/, '$1 Secure Browser'], VERSION], [\n            /focus\\/([\\w\\.]+)/i                                                 // Firefox Focus\n            ], [VERSION, [NAME, 'Firefox Focus']], [\n            /opt\\/([\\w\\.]+)/i                                                   // Opera Touch\n            ], [VERSION, [NAME, 'Opera Touch']], [\n            /coc_coc_browser\\/([\\w\\.]+)/i                                       // Coc Coc Browser\n            ], [VERSION, [NAME, 'Coc Coc']], [\n            /dolfin\\/([\\w\\.]+)/i                                                // Dolphin\n            ], [VERSION, [NAME, 'Dolphin']], [\n            /coast\\/([\\w\\.]+)/i                                                 // Opera Coast\n            ], [VERSION, [NAME, 'Opera Coast']],\n            [/xiaomi\\/miuibrowser\\/([\\w\\.]+)/i                                  // MIUI Browser\n            ], [VERSION, [NAME, 'MIUI Browser']], [\n            /fxios\\/([\\w\\.-]+)/i                                                // Firefox for iOS\n            ], [VERSION, [NAME, 'Firefox']], [\n            /(qihu|qhbrowser|qihoobrowser|360browser)/i                         // 360\n            ], [[NAME, '360 Browser']], [\n            /(oculus|samsung|sailfish)browser\\/([\\w\\.]+)/i\n            ], [[NAME, /(.+)/, '$1 Browser'], VERSION], [                       // Oculus/Samsung/Sailfish Browser\n            /(comodo_dragon)\\/([\\w\\.]+)/i                                       // Comodo Dragon\n            ], [[NAME, /_/g, ' '], VERSION], [\n            /\\s(electron)\\/([\\w\\.]+)\\ssafari/i,                                 // Electron-based App\n            /(tesla)(?:\\sqtcarbrowser|\\/(20[12]\\d\\.[\\w\\.-]+))/i,                // Tesla\n            /m?(qqbrowser|baiduboxapp|2345Explorer)[\\/\\s]?([\\w\\.]+)/i           // QQBrowser/Baidu App/2345 Browser\n            ], [NAME, VERSION], [\n            /(MetaSr)[\\/\\s]?([\\w\\.]+)/i,                                        // SouGouBrowser\n            /(LBBROWSER)/i                                                      // LieBao Browser\n            ], [NAME], [\n\n            // WebView\n            /;fbav\\/([\\w\\.]+);/i                                                // Facebook App for iOS & Android with version\n            ], [VERSION, [NAME, 'Facebook']], [\n            /FBAN\\/FBIOS|FB_IAB\\/FB4A/i                                         // Facebook App for iOS & Android without version\n            ], [[NAME, 'Facebook']], [\n            /safari\\s(line)\\/([\\w\\.]+)/i,                                       // Line App for iOS\n            /\\b(line)\\/([\\w\\.]+)\\/iab/i,                                        // Line App for Android\n            /(chromium|instagram)[\\/\\s]([\\w\\.-]+)/i                             // Chromium/Instagram\n            ], [NAME, VERSION], [\n            /\\bgsa\\/([\\w\\.]+)\\s.*safari\\//i                                     // Google Search Appliance on iOS\n            ], [VERSION, [NAME, 'GSA']], [\n\n            /headlesschrome(?:\\/([\\w\\.]+)|\\s)/i                                 // Chrome Headless\n            ], [VERSION, [NAME, 'Chrome Headless']], [\n\n            /\\swv\\).+(chrome)\\/([\\w\\.]+)/i                                      // Chrome WebView\n            ], [[NAME, 'Chrome WebView'], VERSION], [\n\n            /droid.+\\sversion\\/([\\w\\.]+)\\b.+(?:mobile\\ssafari|safari)/i         // Android Browser\n            ], [VERSION, [NAME, 'Android Browser']], [\n\n            /(chrome|omniweb|arora|[tizenoka]{5}\\s?browser)\\/v?([\\w\\.]+)/i      // Chrome/OmniWeb/Arora/Tizen/Nokia\n            ], [NAME, VERSION], [\n\n            /version\\/([\\w\\.]+)\\s.*mobile\\/\\w+\\s(safari)/i                      // Mobile Safari\n            ], [VERSION, [NAME, 'Mobile Safari']], [\n            /version\\/([\\w\\.]+)\\s.*(mobile\\s?safari|safari)/i                   // Safari & Safari Mobile\n            ], [VERSION, NAME], [\n            /webkit.+?(mobile\\s?safari|safari)(\\/[\\w\\.]+)/i                     // Safari < 3.0\n            ], [NAME, [VERSION, mapper.str, maps.browser.oldSafari.version]], [\n\n            /(webkit|khtml)\\/([\\w\\.]+)/i\n            ], [NAME, VERSION], [\n\n            // Gecko based\n            /(navigator|netscape)\\/([\\w\\.-]+)/i                                 // Netscape\n            ], [[NAME, 'Netscape'], VERSION], [\n            /ile\\svr;\\srv:([\\w\\.]+)\\).+firefox/i                                // Firefox Reality\n            ], [VERSION, [NAME, 'Firefox Reality']], [\n            /ekiohf.+(flow)\\/([\\w\\.]+)/i,                                       // Flow\n            /(swiftfox)/i,                                                      // Swiftfox\n            /(icedragon|iceweasel|camino|chimera|fennec|maemo\\sbrowser|minimo|conkeror)[\\/\\s]?([\\w\\.\\+]+)/i,\n                                                                                // IceDragon/Iceweasel/Camino/Chimera/Fennec/Maemo/Minimo/Conkeror\n            /(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\\/([\\w\\.-]+)$/i,\n                                                                                // Firefox/SeaMonkey/K-Meleon/IceCat/IceApe/Firebird/Phoenix\n            /(firefox)\\/([\\w\\.]+)\\s[\\w\\s\\-]+\\/[\\w\\.]+$/i,                       // Other Firefox-based\n            /(mozilla)\\/([\\w\\.]+)\\s.+rv\\:.+gecko\\/\\d+/i,                        // Mozilla\n\n            // Other\n            /(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\\/\\s]?([\\w\\.]+)/i,\n                                                                                // Polaris/Lynx/Dillo/iCab/Doris/Amaya/w3m/NetSurf/Sleipnir\n            /(links)\\s\\(([\\w\\.]+)/i,                                            // Links\n            /(gobrowser)\\/?([\\w\\.]*)/i,                                         // GoBrowser\n            /(ice\\s?browser)\\/v?([\\w\\._]+)/i,                                   // ICE Browser\n            /(mosaic)[\\/\\s]([\\w\\.]+)/i                                          // Mosaic\n            ], [NAME, VERSION]\n        ],\n\n        cpu : [[\n\n            /(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\\)]/i                     // AMD64 (x64)\n            ], [[ARCHITECTURE, 'amd64']], [\n\n            /(ia32(?=;))/i                                                      // IA32 (quicktime)\n            ], [[ARCHITECTURE, util.lowerize]], [\n\n            /((?:i[346]|x)86)[;\\)]/i                                            // IA32 (x86)\n            ], [[ARCHITECTURE, 'ia32']], [\n\n            /\\b(aarch64|armv?8e?l?)\\b/i                                         // ARM64\n            ], [[ARCHITECTURE, 'arm64']], [\n\n            /\\b(arm(?:v[67])?ht?n?[fl]p?)\\b/i                                   // ARMHF\n            ], [[ARCHITECTURE, 'armhf']], [\n\n            // PocketPC mistakenly identified as PowerPC\n            /windows\\s(ce|mobile);\\sppc;/i\n            ], [[ARCHITECTURE, 'arm']], [\n\n            /((?:ppc|powerpc)(?:64)?)(?:\\smac|;|\\))/i                           // PowerPC\n            ], [[ARCHITECTURE, /ower/, '', util.lowerize]], [\n\n            /(sun4\\w)[;\\)]/i                                                    // SPARC\n            ], [[ARCHITECTURE, 'sparc']], [\n\n            /((?:avr32|ia64(?=;))|68k(?=\\))|\\barm(?:64|(?=v(?:[1-7]|[5-7]1)l?|;|eabi))|(?=atmel\\s)avr|(?:irix|mips|sparc)(?:64)?\\b|pa-risc)/i\n                                                                                // IA64, 68K, ARM/64, AVR/32, IRIX/64, MIPS/64, SPARC/64, PA-RISC\n            ], [[ARCHITECTURE, util.lowerize]]\n        ],\n\n        device : [[\n\n            //////////////////////////\n            // MOBILES & TABLETS\n            // Ordered by popularity\n            /////////////////////////\n\n            // Samsung\n            /\\b(sch-i[89]0\\d|shw-m380s|sm-[pt]\\w{2,4}|gt-[pn]\\d{2,4}|sgh-t8[56]9|nexus\\s10)/i\n            ], [MODEL, [VENDOR, 'Samsung'], [TYPE, TABLET]], [\n            /\\b((?:s[cgp]h|gt|sm)-\\w+|galaxy\\snexus)/i,\n            /\\ssamsung[\\s-]([\\w-]+)/i,\n            /sec-(sgh\\w+)/i\n            ], [MODEL, [VENDOR, 'Samsung'], [TYPE, MOBILE]], [\n\n            // Apple\n            /\\((ip(?:hone|od)[\\s\\w]*);/i                                        // iPod/iPhone\n            ], [MODEL, [VENDOR, 'Apple'], [TYPE, MOBILE]], [\n            /\\((ipad);[\\w\\s\\),;-]+apple/i,                                      // iPad\n            /applecoremedia\\/[\\w\\.]+\\s\\((ipad)/i,\n            /\\b(ipad)\\d\\d?,\\d\\d?[;\\]].+ios/i\n            ], [MODEL, [VENDOR, 'Apple'], [TYPE, TABLET]], [\n\n            // Huawei\n            /\\b((?:agr|ags[23]|bah2?|sht?)-a?[lw]\\d{2})/i,\n            ], [MODEL, [VENDOR, 'Huawei'], [TYPE, TABLET]], [\n            /d\\/huawei([\\w\\s-]+)[;\\)]/i,\n            /\\b(nexus\\s6p|vog-[at]?l\\d\\d|ane-[at]?l[x\\d]\\d|eml-a?l\\d\\da?|lya-[at]?l\\d[\\dc]|clt-a?l\\d\\di?|ele-l\\d\\d)/i,\n            /\\b(\\w{2,4}-[atu][ln][01259][019])[;\\)\\s]/i\n            ], [MODEL, [VENDOR, 'Huawei'], [TYPE, MOBILE]], [\n\n            // Xiaomi\n            /\\b(poco[\\s\\w]+)(?:\\sbuild|\\))/i,                                   // Xiaomi POCO\n            /\\b;\\s(\\w+)\\sbuild\\/hm\\1/i,                                         // Xiaomi Hongmi 'numeric' models\n            /\\b(hm[\\s\\-_]?note?[\\s_]?(?:\\d\\w)?)\\sbuild/i,                       // Xiaomi Hongmi\n            /\\b(redmi[\\s\\-_]?(?:note|k)?[\\w\\s_]+)(?:\\sbuild|\\))/i,              // Xiaomi Redmi\n            /\\b(mi[\\s\\-_]?(?:a\\d|one|one[\\s_]plus|note lte)?[\\s_]?(?:\\d?\\w?)[\\s_]?(?:plus)?)\\sbuild/i  // Xiaomi Mi\n            ], [[MODEL, /_/g, ' '], [VENDOR, 'Xiaomi'], [TYPE, MOBILE]], [\n            /\\b(mi[\\s\\-_]?(?:pad)(?:[\\w\\s_]+))(?:\\sbuild|\\))/i                  // Mi Pad tablets\n            ],[[MODEL, /_/g, ' '], [VENDOR, 'Xiaomi'], [TYPE, TABLET]], [\n\n            // OPPO\n            /;\\s(\\w+)\\sbuild.+\\soppo/i,\n            /\\s(cph[12]\\d{3}|p(?:af|c[al]|d\\w|e[ar])[mt]\\d0|x9007)\\b/i\n            ], [MODEL, [VENDOR, 'OPPO'], [TYPE, MOBILE]], [\n\n            // Vivo\n            /\\svivo\\s(\\w+)(?:\\sbuild|\\))/i,\n            /\\s(v[12]\\d{3}\\w?[at])(?:\\sbuild|;)/i\n            ], [MODEL, [VENDOR, 'Vivo'], [TYPE, MOBILE]], [\n\n            // Realme\n            /\\s(rmx[12]\\d{3})(?:\\sbuild|;)/i\n            ], [MODEL, [VENDOR, 'Realme'], [TYPE, MOBILE]], [\n\n            // Motorola\n            /\\s(milestone|droid(?:[2-4x]|\\s(?:bionic|x2|pro|razr))?:?(\\s4g)?)\\b[\\w\\s]+build\\//i,\n            /\\smot(?:orola)?[\\s-](\\w*)/i,\n            /((?:moto[\\s\\w\\(\\)]+|xt\\d{3,4}|nexus\\s6)(?=\\sbuild|\\)))/i\n            ], [MODEL, [VENDOR, 'Motorola'], [TYPE, MOBILE]], [\n            /\\s(mz60\\d|xoom[\\s2]{0,2})\\sbuild\\//i\n            ], [MODEL, [VENDOR, 'Motorola'], [TYPE, TABLET]], [\n\n            // LG\n            /((?=lg)?[vl]k\\-?\\d{3})\\sbuild|\\s3\\.[\\s\\w;-]{10}lg?-([06cv9]{3,4})/i\n            ], [MODEL, [VENDOR, 'LG'], [TYPE, TABLET]], [\n            /(lm-?f100[nv]?|nexus\\s[45])/i,\n            /lg[e;\\s\\/-]+((?!browser|netcast)\\w+)/i,\n            /\\blg(\\-?[\\d\\w]+)\\sbuild/i\n            ], [MODEL, [VENDOR, 'LG'], [TYPE, MOBILE]], [\n\n            // Lenovo\n            /(ideatab[\\w\\-\\s]+)/i,\n            /lenovo\\s?(s(?:5000|6000)(?:[\\w-]+)|tab(?:[\\s\\w]+)|yt[\\d\\w-]{6}|tb[\\d\\w-]{6})/i        // Lenovo tablets\n            ], [MODEL, [VENDOR, 'Lenovo'], [TYPE, TABLET]], [\n\n            // Nokia\n            /(?:maemo|nokia).*(n900|lumia\\s\\d+)/i,\n            /nokia[\\s_-]?([\\w\\.-]*)/i\n            ], [[MODEL, /_/g, ' '], [VENDOR, 'Nokia'], [TYPE, MOBILE]], [\n\n            // Google\n            /droid.+;\\s(pixel\\sc)[\\s)]/i                                        // Google Pixel C\n            ], [MODEL, [VENDOR, 'Google'], [TYPE, TABLET]], [\n            /droid.+;\\s(pixel[\\s\\daxl]{0,6})(?:\\sbuild|\\))/i                    // Google Pixel\n            ], [MODEL, [VENDOR, 'Google'], [TYPE, MOBILE]], [\n\n            // Sony\n            /droid.+\\s([c-g]\\d{4}|so[-l]\\w+|xq-a\\w[4-7][12])(?=\\sbuild\\/|\\).+chrome\\/(?![1-6]{0,1}\\d\\.))/i\n            ], [MODEL, [VENDOR, 'Sony'], [TYPE, MOBILE]], [\n            /sony\\stablet\\s[ps]\\sbuild\\//i,\n            /(?:sony)?sgp\\w+(?:\\sbuild\\/|\\))/i\n            ], [[MODEL, 'Xperia Tablet'], [VENDOR, 'Sony'], [TYPE, TABLET]], [\n\n            // OnePlus\n            /\\s(kb2005|in20[12]5|be20[12][59])\\b/i,\n            /\\ba000(1)\\sbuild/i,                                                // OnePlus\n            /\\boneplus\\s(a\\d{4})[\\s)]/i\n            ], [MODEL, [VENDOR, 'OnePlus'], [TYPE, MOBILE]], [\n\n            // Amazon\n            /(alexa)webm/i,\n            /(kf[a-z]{2}wi)(\\sbuild\\/|\\))/i,                                    // Kindle Fire without Silk\n            /(kf[a-z]+)(\\sbuild\\/|\\)).+silk\\//i                                 // Kindle Fire HD\n            ], [MODEL, [VENDOR, 'Amazon'], [TYPE, TABLET]], [\n            /(sd|kf)[0349hijorstuw]+(\\sbuild\\/|\\)).+silk\\//i                    // Fire Phone\n            ], [[MODEL, 'Fire Phone'], [VENDOR, 'Amazon'], [TYPE, MOBILE]], [\n\n            // BlackBerry\n            /\\((playbook);[\\w\\s\\),;-]+(rim)/i                                   // BlackBerry PlayBook\n            ], [MODEL, VENDOR, [TYPE, TABLET]], [\n            /((?:bb[a-f]|st[hv])100-\\d)/i,\n            /\\(bb10;\\s(\\w+)/i                                                   // BlackBerry 10\n            ], [MODEL, [VENDOR, 'BlackBerry'], [TYPE, MOBILE]], [\n\n            // Asus\n            /(?:\\b|asus_)(transfo[prime\\s]{4,10}\\s\\w+|eeepc|slider\\s\\w+|nexus\\s7|padfone|p00[cj])/i\n            ], [MODEL, [VENDOR, 'ASUS'], [TYPE, TABLET]], [\n            /\\s(z[es]6[027][01][km][ls]|zenfone\\s\\d\\w?)\\b/i\n            ], [MODEL, [VENDOR, 'ASUS'], [TYPE, MOBILE]], [\n\n            // HTC\n            /(nexus\\s9)/i                                                       // HTC Nexus 9\n            ], [MODEL, [VENDOR, 'HTC'], [TYPE, TABLET]], [\n            /(htc)[;_\\s-]{1,2}([\\w\\s]+(?=\\)|\\sbuild)|\\w+)/i,                    // HTC\n\n            // ZTE\n            /(zte)-(\\w*)/i,\n            /(alcatel|geeksphone|nexian|panasonic|(?=;\\s)sony)[_\\s-]?([\\w-]*)/i // Alcatel/GeeksPhone/Nexian/Panasonic/Sony\n            ], [VENDOR, [MODEL, /_/g, ' '], [TYPE, MOBILE]], [\n\n            // Acer\n            /droid[x\\d\\.\\s;]+\\s([ab][1-7]\\-?[0178a]\\d\\d?)/i\n            ], [MODEL, [VENDOR, 'Acer'], [TYPE, TABLET]], [\n\n            // Meizu\n            /droid.+;\\s(m[1-5]\\snote)\\sbuild/i,\n            /\\bmz-([\\w-]{2,})/i\n            ], [MODEL, [VENDOR, 'Meizu'], [TYPE, MOBILE]], [\n\n            // MIXED\n            /(blackberry|benq|palm(?=\\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\\s_-]?([\\w-]*)/i,\n                                                                                // BlackBerry/BenQ/Palm/Sony-Ericsson/Acer/Asus/Dell/Meizu/Motorola/Polytron\n            /(hp)\\s([\\w\\s]+\\w)/i,                                               // HP iPAQ\n            /(asus)-?(\\w+)/i,                                                   // Asus\n            /(microsoft);\\s(lumia[\\s\\w]+)/i,                                    // Microsoft Lumia\n            /(lenovo)[_\\s-]?([\\w-]+)/i,                                         // Lenovo\n            /linux;.+(jolla);/i,                                                // Jolla\n            /droid.+;\\s(oppo)\\s?([\\w\\s]+)\\sbuild/i                              // OPPO\n            ], [VENDOR, MODEL, [TYPE, MOBILE]], [\n\n            /(archos)\\s(gamepad2?)/i,                                           // Archos\n            /(hp).+(touchpad(?!.+tablet)|tablet)/i,                             // HP TouchPad\n            /(kindle)\\/([\\w\\.]+)/i,                                             // Kindle\n            /\\s(nook)[\\w\\s]+build\\/(\\w+)/i,                                     // Nook\n            /(dell)\\s(strea[kpr\\s\\d]*[\\dko])/i,                                 // Dell Streak\n            /[;\\/]\\s?(le[\\s\\-]+pan)[\\s\\-]+(\\w{1,9})\\sbuild/i,                   // Le Pan Tablets\n            /[;\\/]\\s?(trinity)[\\-\\s]*(t\\d{3})\\sbuild/i,                         // Trinity Tablets\n            /\\b(gigaset)[\\s\\-]+(q\\w{1,9})\\sbuild/i,                             // Gigaset Tablets\n            /\\b(vodafone)\\s([\\w\\s]+)(?:\\)|\\sbuild)/i                            // Vodafone\n            ], [VENDOR, MODEL, [TYPE, TABLET]], [\n\n            /\\s(surface\\sduo)\\s/i                                               // Surface Duo\n            ], [MODEL, [VENDOR, 'Microsoft'], [TYPE, TABLET]], [\n            /droid\\s[\\d\\.]+;\\s(fp\\du?)\\sbuild/i\n            ], [MODEL, [VENDOR, 'Fairphone'], [TYPE, MOBILE]], [\n            /\\s(u304aa)\\sbuild/i                                                // AT&T\n            ], [MODEL, [VENDOR, 'AT&T'], [TYPE, MOBILE]], [\n            /sie-(\\w*)/i                                                        // Siemens\n            ], [MODEL, [VENDOR, 'Siemens'], [TYPE, MOBILE]], [\n            /[;\\/]\\s?(rct\\w+)\\sbuild/i                                          // RCA Tablets\n            ], [MODEL, [VENDOR, 'RCA'], [TYPE, TABLET]], [\n            /[;\\/\\s](venue[\\d\\s]{2,7})\\sbuild/i                                 // Dell Venue Tablets\n            ], [MODEL, [VENDOR, 'Dell'], [TYPE, TABLET]], [\n            /[;\\/]\\s?(q(?:mv|ta)\\w+)\\sbuild/i                                   // Verizon Tablet\n            ], [MODEL, [VENDOR, 'Verizon'], [TYPE, TABLET]], [\n            /[;\\/]\\s(?:barnes[&\\s]+noble\\s|bn[rt])([\\w\\s\\+]*)\\sbuild/i          // Barnes & Noble Tablet\n            ], [MODEL, [VENDOR, 'Barnes & Noble'], [TYPE, TABLET]], [\n            /[;\\/]\\s(tm\\d{3}\\w+)\\sbuild/i\n            ], [MODEL, [VENDOR, 'NuVision'], [TYPE, TABLET]], [\n            /;\\s(k88)\\sbuild/i                                                  // ZTE K Series Tablet\n            ], [MODEL, [VENDOR, 'ZTE'], [TYPE, TABLET]], [\n            /;\\s(nx\\d{3}j)\\sbuild/i                                             // ZTE Nubia\n            ], [MODEL, [VENDOR, 'ZTE'], [TYPE, MOBILE]], [\n            /[;\\/]\\s?(gen\\d{3})\\sbuild.*49h/i                                   // Swiss GEN Mobile\n            ], [MODEL, [VENDOR, 'Swiss'], [TYPE, MOBILE]], [\n            /[;\\/]\\s?(zur\\d{3})\\sbuild/i                                        // Swiss ZUR Tablet\n            ], [MODEL, [VENDOR, 'Swiss'], [TYPE, TABLET]], [\n            /[;\\/]\\s?((zeki)?tb.*\\b)\\sbuild/i                                   // Zeki Tablets\n            ], [MODEL, [VENDOR, 'Zeki'], [TYPE, TABLET]], [\n            /[;\\/]\\s([yr]\\d{2})\\sbuild/i,\n            /[;\\/]\\s(dragon[\\-\\s]+touch\\s|dt)(\\w{5})\\sbuild/i                   // Dragon Touch Tablet\n            ], [[VENDOR, 'Dragon Touch'], MODEL, [TYPE, TABLET]], [\n            /[;\\/]\\s?(ns-?\\w{0,9})\\sbuild/i                                     // Insignia Tablets\n            ], [MODEL, [VENDOR, 'Insignia'], [TYPE, TABLET]], [\n            /[;\\/]\\s?((nxa|Next)-?\\w{0,9})\\sbuild/i                             // NextBook Tablets\n            ], [MODEL, [VENDOR, 'NextBook'], [TYPE, TABLET]], [\n            /[;\\/]\\s?(xtreme\\_)?(v(1[045]|2[015]|[3469]0|7[05]))\\sbuild/i\n            ], [[VENDOR, 'Voice'], MODEL, [TYPE, MOBILE]], [                    // Voice Xtreme Phones\n            /[;\\/]\\s?(lvtel\\-)?(v1[12])\\sbuild/i                                // LvTel Phones\n            ], [[VENDOR, 'LvTel'], MODEL, [TYPE, MOBILE]], [\n            /;\\s(ph-1)\\s/i\n            ], [MODEL, [VENDOR, 'Essential'], [TYPE, MOBILE]], [                // Essential PH-1\n            /[;\\/]\\s?(v(100md|700na|7011|917g).*\\b)\\sbuild/i                    // Envizen Tablets\n            ], [MODEL, [VENDOR, 'Envizen'], [TYPE, TABLET]], [\n            /[;\\/]\\s?(trio[\\s\\w\\-\\.]+)\\sbuild/i                                 // MachSpeed Tablets\n            ], [MODEL, [VENDOR, 'MachSpeed'], [TYPE, TABLET]], [\n            /[;\\/]\\s?tu_(1491)\\sbuild/i                                         // Rotor Tablets\n            ], [MODEL, [VENDOR, 'Rotor'], [TYPE, TABLET]], [\n            /(shield[\\w\\s]+)\\sbuild/i                                           // Nvidia Shield Tablets\n            ], [MODEL, [VENDOR, 'Nvidia'], [TYPE, TABLET]], [\n            /(sprint)\\s(\\w+)/i                                                  // Sprint Phones\n            ], [VENDOR, MODEL, [TYPE, MOBILE]], [\n            /(kin\\.[onetw]{3})/i                                                // Microsoft Kin\n            ], [[MODEL, /\\./g, ' '], [VENDOR, 'Microsoft'], [TYPE, MOBILE]], [\n            /droid\\s[\\d\\.]+;\\s(cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\\)/i     // Zebra\n            ], [MODEL, [VENDOR, 'Zebra'], [TYPE, TABLET]], [\n            /droid\\s[\\d\\.]+;\\s(ec30|ps20|tc[2-8]\\d[kx])\\)/i\n            ], [MODEL, [VENDOR, 'Zebra'], [TYPE, MOBILE]], [\n\n            ///////////////////\n            // CONSOLES\n            ///////////////////\n\n            /\\s(ouya)\\s/i,                                                      // Ouya\n            /(nintendo)\\s([wids3utch]+)/i                                       // Nintendo\n            ], [VENDOR, MODEL, [TYPE, CONSOLE]], [\n            /droid.+;\\s(shield)\\sbuild/i                                        // Nvidia\n            ], [MODEL, [VENDOR, 'Nvidia'], [TYPE, CONSOLE]], [\n            /(playstation\\s[345portablevi]+)/i                                  // Playstation\n            ], [MODEL, [VENDOR, 'Sony'], [TYPE, CONSOLE]], [\n            /[\\s\\(;](xbox(?:\\sone)?(?!;\\sxbox))[\\s\\);]/i                        // Microsoft Xbox\n            ], [MODEL, [VENDOR, 'Microsoft'], [TYPE, CONSOLE]], [\n\n            ///////////////////\n            // SMARTTVS\n            ///////////////////\n\n            /smart-tv.+(samsung)/i                                              // Samsung\n            ], [VENDOR, [TYPE, SMARTTV]], [\n            /hbbtv.+maple;(\\d+)/i\n            ], [[MODEL, /^/, 'SmartTV'], [VENDOR, 'Samsung'], [TYPE, SMARTTV]], [\n            /(?:linux;\\snetcast.+smarttv|lg\\snetcast\\.tv-201\\d)/i,              // LG SmartTV\n            ], [[VENDOR, 'LG'], [TYPE, SMARTTV]], [\n            /(apple)\\s?tv/i                                                     // Apple TV\n            ], [VENDOR, [MODEL, 'Apple TV'], [TYPE, SMARTTV]], [\n            /crkey/i                                                            // Google Chromecast\n            ], [[MODEL, 'Chromecast'], [VENDOR, 'Google'], [TYPE, SMARTTV]], [\n            /droid.+aft([\\w])(\\sbuild\\/|\\))/i                                   // Fire TV\n            ], [MODEL, [VENDOR, 'Amazon'], [TYPE, SMARTTV]], [\n            /\\(dtv[\\);].+(aquos)/i                                              // Sharp\n            ], [MODEL, [VENDOR, 'Sharp'], [TYPE, SMARTTV]], [\n            /hbbtv\\/\\d+\\.\\d+\\.\\d+\\s+\\([\\w\\s]*;\\s*(\\w[^;]*);([^;]*)/i            // HbbTV devices\n            ], [[VENDOR, util.trim], [MODEL, util.trim], [TYPE, SMARTTV]], [\n            /[\\s\\/\\(](android\\s|smart[-\\s]?|opera\\s)tv[;\\)\\s]/i                 // SmartTV from Unidentified Vendors\n            ], [[TYPE, SMARTTV]], [\n\n            ///////////////////\n            // WEARABLES\n            ///////////////////\n\n            /((pebble))app\\/[\\d\\.]+\\s/i                                         // Pebble\n            ], [VENDOR, MODEL, [TYPE, WEARABLE]], [\n            /droid.+;\\s(glass)\\s\\d/i                                            // Google Glass\n            ], [MODEL, [VENDOR, 'Google'], [TYPE, WEARABLE]], [\n            /droid\\s[\\d\\.]+;\\s(wt63?0{2,3})\\)/i\n            ], [MODEL, [VENDOR, 'Zebra'], [TYPE, WEARABLE]], [\n\n            ///////////////////\n            // EMBEDDED\n            ///////////////////\n\n            /(tesla)(?:\\sqtcarbrowser|\\/20[12]\\d\\.[\\w\\.-]+)/i                   // Tesla\n            ], [VENDOR, [TYPE, EMBEDDED]], [\n\n            ////////////////////\n            // MIXED (GENERIC)\n            ///////////////////\n\n            /droid .+?; ([^;]+?)(?: build|\\) applewebkit).+? mobile safari/i    // Android Phones from Unidentified Vendors\n            ], [MODEL, [TYPE, MOBILE]], [\n            /droid .+?;\\s([^;]+?)(?: build|\\) applewebkit).+?(?! mobile) safari/i  // Android Tablets from Unidentified Vendors\n            ], [MODEL, [TYPE, TABLET]], [\n            /\\s(tablet|tab)[;\\/]/i,                                             // Unidentifiable Tablet\n            /\\s(mobile)(?:[;\\/]|\\ssafari)/i                                     // Unidentifiable Mobile\n            ], [[TYPE, util.lowerize]], [\n            /(android[\\w\\.\\s\\-]{0,9});.+build/i                                 // Generic Android Device\n            ], [MODEL, [VENDOR, 'Generic']], [\n            /(phone)/i\n            ], [[TYPE, MOBILE]]\n        ],\n\n        engine : [[\n\n            /windows.+\\sedge\\/([\\w\\.]+)/i                                       // EdgeHTML\n            ], [VERSION, [NAME, 'EdgeHTML']], [\n\n            /webkit\\/537\\.36.+chrome\\/(?!27)([\\w\\.]+)/i                         // Blink\n            ], [VERSION, [NAME, 'Blink']], [\n\n            /(presto)\\/([\\w\\.]+)/i,                                             // Presto\n            /(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\\/([\\w\\.]+)/i, // WebKit/Trident/NetFront/NetSurf/Amaya/Lynx/w3m/Goanna\n            /ekioh(flow)\\/([\\w\\.]+)/i,                                          // Flow\n            /(khtml|tasman|links)[\\/\\s]\\(?([\\w\\.]+)/i,                          // KHTML/Tasman/Links\n            /(icab)[\\/\\s]([23]\\.[\\d\\.]+)/i                                      // iCab\n            ], [NAME, VERSION], [\n\n            /rv\\:([\\w\\.]{1,9})\\b.+(gecko)/i                                     // Gecko\n            ], [VERSION, NAME]\n        ],\n\n        os : [[\n\n            // Windows\n            /microsoft\\s(windows)\\s(vista|xp)/i                                 // Windows (iTunes)\n            ], [NAME, VERSION], [\n            /(windows)\\snt\\s6\\.2;\\s(arm)/i,                                     // Windows RT\n            /(windows\\sphone(?:\\sos)*)[\\s\\/]?([\\d\\.\\s\\w]*)/i,                   // Windows Phone\n            /(windows\\smobile|windows)[\\s\\/]?([ntce\\d\\.\\s]+\\w)(?!.+xbox)/i\n            ], [NAME, [VERSION, mapper.str, maps.os.windows.version]], [\n            /(win(?=3|9|n)|win\\s9x\\s)([nt\\d\\.]+)/i\n            ], [[NAME, 'Windows'], [VERSION, mapper.str, maps.os.windows.version]], [\n\n            // iOS/macOS\n            /ip[honead]{2,4}\\b(?:.*os\\s([\\w]+)\\slike\\smac|;\\sopera)/i,          // iOS\n            /cfnetwork\\/.+darwin/i\n            ], [[VERSION, /_/g, '.'], [NAME, 'iOS']], [\n            /(mac\\sos\\sx)\\s?([\\w\\s\\.]*)/i,\n            /(macintosh|mac(?=_powerpc)\\s)(?!.+haiku)/i                         // Mac OS\n            ], [[NAME, 'Mac OS'], [VERSION, /_/g, '.']], [\n\n            // Mobile OSes                                                      // Android/WebOS/Palm/QNX/Bada/RIM/MeeGo/Contiki/Sailfish OS\n            /(android|webos|palm\\sos|qnx|bada|rim\\stablet\\sos|meego|sailfish|contiki)[\\/\\s-]?([\\w\\.]*)/i,\n            /(blackberry)\\w*\\/([\\w\\.]*)/i,                                      // Blackberry\n            /(tizen|kaios)[\\/\\s]([\\w\\.]+)/i,                                    // Tizen/KaiOS\n            /\\((series40);/i                                                    // Series 40\n            ], [NAME, VERSION], [\n            /\\(bb(10);/i                                                        // BlackBerry 10\n            ], [VERSION, [NAME, 'BlackBerry']], [\n            /(?:symbian\\s?os|symbos|s60(?=;)|series60)[\\/\\s-]?([\\w\\.]*)/i       // Symbian\n            ], [VERSION, [NAME, 'Symbian']], [\n            /mozilla.+\\(mobile;.+gecko.+firefox/i                               // Firefox OS\n            ], [[NAME, 'Firefox OS']], [\n            /web0s;.+rt(tv)/i,\n            /\\b(?:hp)?wos(?:browser)?\\/([\\w\\.]+)/i                              // WebOS\n            ], [VERSION, [NAME, 'webOS']], [\n\n            // Google Chromecast\n            /crkey\\/([\\d\\.]+)/i                                                 // Google Chromecast\n            ], [VERSION, [NAME, 'Chromecast']], [\n            /(cros)\\s[\\w]+\\s([\\w\\.]+\\w)/i                                       // Chromium OS\n            ], [[NAME, 'Chromium OS'], VERSION],[\n\n            // Console\n            /(nintendo|playstation)\\s([wids345portablevuch]+)/i,                // Nintendo/Playstation\n            /(xbox);\\s+xbox\\s([^\\);]+)/i,                                       // Microsoft Xbox (360, One, X, S, Series X, Series S)\n\n            // GNU/Linux based\n            /(mint)[\\/\\s\\(\\)]?(\\w*)/i,                                          // Mint\n            /(mageia|vectorlinux)[;\\s]/i,                                       // Mageia/VectorLinux\n            /(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?=\\slinux)|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus|raspbian)(?:\\sgnu\\/linux)?(?:\\slinux)?[\\/\\s-]?(?!chrom|package)([\\w\\.-]*)/i,\n                                                                                // Joli/Ubuntu/Debian/SUSE/Gentoo/Arch/Slackware\n                                                                                // Fedora/Mandriva/CentOS/PCLinuxOS/RedHat/Zenwalk/Linpus\n            /(hurd|linux)\\s?([\\w\\.]*)/i,                                        // Hurd/Linux\n            /(gnu)\\s?([\\w\\.]*)/i,                                               // GNU\n\n            // BSD based\n            /\\s([frentopc-]{0,4}bsd|dragonfly)\\s?(?!amd|[ix346]{1,2}86)([\\w\\.]*)/i,  // FreeBSD/NetBSD/OpenBSD/PC-BSD/DragonFly\n            /(haiku)\\s(\\w+)/i                                                   // Haiku\n            ], [NAME, VERSION], [\n\n            // Other\n            /(sunos)\\s?([\\w\\.\\d]*)/i                                            // Solaris\n            ], [[NAME, 'Solaris'], VERSION], [\n            /((?:open)?solaris)[\\/\\s-]?([\\w\\.]*)/i,                             // Solaris\n            /(aix)\\s((\\d)(?=\\.|\\)|\\s)[\\w\\.])*/i,                                // AIX\n            /(plan\\s9|minix|beos|os\\/2|amigaos|morphos|risc\\sos|openvms|fuchsia)/i,  // Plan9/Minix/BeOS/OS2/AmigaOS/MorphOS/RISCOS/OpenVMS/Fuchsia\n            /(unix)\\s?([\\w\\.]*)/i                                               // UNIX\n            ], [NAME, VERSION]\n        ]\n    };\n\n\n    /////////////////\n    // Constructor\n    ////////////////\n    var UAParser = function (ua, extensions) {\n\n        if (typeof ua === 'object') {\n            extensions = ua;\n            ua = undefined;\n        }\n\n        if (!(this instanceof UAParser)) {\n            return new UAParser(ua, extensions).getResult();\n        }\n\n        var _ua = ua || ((typeof window !== 'undefined' && window.navigator && window.navigator.userAgent) ? window.navigator.userAgent : EMPTY);\n        var _rgxmap = extensions ? util.extend(regexes, extensions) : regexes;\n\n        this.getBrowser = function () {\n            var _browser = { name: undefined, version: undefined };\n            mapper.rgx.call(_browser, _ua, _rgxmap.browser);\n            _browser.major = util.major(_browser.version); // deprecated\n            return _browser;\n        };\n        this.getCPU = function () {\n            var _cpu = { architecture: undefined };\n            mapper.rgx.call(_cpu, _ua, _rgxmap.cpu);\n            return _cpu;\n        };\n        this.getDevice = function () {\n            var _device = { vendor: undefined, model: undefined, type: undefined };\n            mapper.rgx.call(_device, _ua, _rgxmap.device);\n            return _device;\n        };\n        this.getEngine = function () {\n            var _engine = { name: undefined, version: undefined };\n            mapper.rgx.call(_engine, _ua, _rgxmap.engine);\n            return _engine;\n        };\n        this.getOS = function () {\n            var _os = { name: undefined, version: undefined };\n            mapper.rgx.call(_os, _ua, _rgxmap.os);\n            return _os;\n        };\n        this.getResult = function () {\n            return {\n                ua      : this.getUA(),\n                browser : this.getBrowser(),\n                engine  : this.getEngine(),\n                os      : this.getOS(),\n                device  : this.getDevice(),\n                cpu     : this.getCPU()\n            };\n        };\n        this.getUA = function () {\n            return _ua;\n        };\n        this.setUA = function (ua) {\n            _ua = (typeof ua === STR_TYPE && ua.length > UA_MAX_LENGTH) ? util.trim(ua, UA_MAX_LENGTH) : ua;\n            return this;\n        };\n        this.setUA(_ua);\n        return this;\n    };\n\n    UAParser.VERSION = LIBVERSION;\n    UAParser.BROWSER = {\n        NAME    : NAME,\n        MAJOR   : MAJOR, // deprecated\n        VERSION : VERSION\n    };\n    UAParser.CPU = {\n        ARCHITECTURE : ARCHITECTURE\n    };\n    UAParser.DEVICE = {\n        MODEL   : MODEL,\n        VENDOR  : VENDOR,\n        TYPE    : TYPE,\n        CONSOLE : CONSOLE,\n        MOBILE  : MOBILE,\n        SMARTTV : SMARTTV,\n        TABLET  : TABLET,\n        WEARABLE: WEARABLE,\n        EMBEDDED: EMBEDDED\n    };\n    UAParser.ENGINE = {\n        NAME    : NAME,\n        VERSION : VERSION\n    };\n    UAParser.OS = {\n        NAME    : NAME,\n        VERSION : VERSION\n    };\n\n    ///////////\n    // Export\n    //////////\n\n\n    // check js environment\n    if (typeof(exports) !== UNDEF_TYPE) {\n        // nodejs env\n        if (typeof module !== UNDEF_TYPE && module.exports) {\n            exports = module.exports = UAParser;\n        }\n        exports.UAParser = UAParser;\n    } else {\n        // requirejs env (optional)\n        if (typeof(define) === 'function' && define.amd) {\n            define(function () {\n                return UAParser;\n            });\n        } else if (typeof window !== 'undefined') {\n            // browser env\n            window.UAParser = UAParser;\n        }\n    }\n\n    // jQuery/Zepto specific (optional)\n    // Note:\n    //   In AMD env the global scope should be kept clean, but jQuery is an exception.\n    //   jQuery always exports to global scope, unless jQuery.noConflict(true) is used,\n    //   and we should catch that.\n    var $ = typeof window !== 'undefined' && (window.jQuery || window.Zepto);\n    if ($ && !$.ua) {\n        var parser = new UAParser();\n        $.ua = parser.getResult();\n        $.ua.get = function () {\n            return parser.getUA();\n        };\n        $.ua.set = function (uastring) {\n            parser.setUA(uastring);\n            var result = parser.getResult();\n            for (var prop in result) {\n                $.ua[prop] = result[prop];\n            }\n        };\n    }\n\n})(typeof window === 'object' ? window : this);\n","L.Control.Dialog = L.Control.extend({\n  options: {\n    size: [ 300, 300 ],\n    minSize: [ 100, 100 ],\n    maxSize: [ 350, 350 ],\n    anchor: [ 250, 250 ],\n    position: \"topleft\",\n    initOpen: true\n  },\n\n  initialize: function(options) {\n    this.options = JSON.parse(JSON.stringify(this.options));\n    L.setOptions(this, options);\n\n    this._attributions = {};\n  },\n\n  onAdd: function(map) {\n    this._initLayout();\n    this._map = map;\n\n    this.update();\n\n    if (!this.options.initOpen) {\n      this.close();\n    }\n\n    return this._container;\n  },\n\n  open: function() {\n    if (!this._map) {\n      return;\n    }\n    this._container.style.visibility = \"\";\n\n    this._map.fire(\"dialog:opened\", this);\n\n    return this;\n  },\n\n  close: function() {\n    this._container.style.visibility = \"hidden\";\n\n    this._map.fire(\"dialog:closed\", this);\n    return this;\n  },\n\n  destroy: function() {\n    if (!this._map) {\n      return this;\n    }\n\n    this._map.fire(\"dialog:destroyed\", this);\n    this.remove();\n\n    if (this.onRemove) {\n      this.onRemove(this._map);\n    }\n\n    return this;\n  },\n\n  setLocation: function(location) {\n    location = location || [ 250, 250 ];\n\n    this.options.anchor[0] = 0;\n    this.options.anchor[1] = 0;\n    this._oldMousePos.x = 0;\n    this._oldMousePos.y = 0;\n\n    this._move(location[1], location[0]);\n\n    return this;\n  },\n\n  setSize: function(size) {\n    size = size || [ 300, 300 ];\n\n    this.options.size[0] = 0;\n    this.options.size[1] = 0;\n    this._oldMousePos.x = 0;\n    this._oldMousePos.y = 0;\n\n    this._resize(size[0], size[1]);\n\n    return this;\n  },\n\n  lock: function() {\n    this._resizerNode.style.visibility = \"hidden\";\n    this._grabberNode.style.visibility = \"hidden\";\n    this._closeNode.style.visibility = \"hidden\";\n\n    this._map.fire(\"dialog:locked\", this);\n    return this;\n  },\n\n  unlock: function() {\n    this._resizerNode.style.visibility = \"\";\n    this._grabberNode.style.visibility = \"\";\n    this._closeNode.style.visibility = \"\";\n\n    this._map.fire(\"dialog:unlocked\", this);\n    return this;\n  },\n\n  freeze: function() {\n    this._resizerNode.style.visibility = \"hidden\";\n    this._grabberNode.style.visibility = \"hidden\";\n\n    this._map.fire(\"dialog:frozen\", this);\n    return this;\n  },\n\n  unfreeze: function() {\n    this._resizerNode.style.visibility = \"\";\n    this._grabberNode.style.visibility = \"\";\n\n    this._map.fire(\"dialog:unfrozen\", this);\n    return this;\n  },\n\n  hideClose: function() {\n    this._closeNode.style.visibility = \"hidden\";\n\n    this._map.fire(\"dialog:closehidden\", this);\n    return this;\n  },\n\n  showClose: function() {\n    this._closeNode.style.visibility = \"\";\n\n    this._map.fire(\"dialog:closeshown\", this);\n    return this;\n  },\n\n  hideResize: function() {\n    this._resizerNode.style.visibility = \"hidden\";\n\n    this._map.fire(\"dialog:resizehidden\", this);\n    return this;\n  },\n\n  showResize: function() {\n    this._resizerNode.style.visibility = \"\";\n\n    this._map.fire(\"dialog:resizeshown\", this);\n    return this;\n  },\n\n  setContent: function(content) {\n    this._content = content;\n    this.update();\n    return this;\n  },\n\n  getContent: function() {\n    return this._content;\n  },\n\n  getElement: function() {\n    return this._container;\n  },\n\n  update: function() {\n    if (!this._map) {\n      return;\n    }\n\n    this._container.style.visibility = \"hidden\";\n\n    this._updateContent();\n    this._updateLayout();\n\n    this._container.style.visibility = \"\";\n    this._map.fire(\"dialog:updated\", this);\n  },\n\n  _initLayout: function() {\n    var className = \"leaflet-control-dialog\",\n      container = (this._container = L.DomUtil.create(\"div\", className));\n\n    container.style.width = this.options.size[0] + \"px\";\n    container.style.height = this.options.size[1] + \"px\";\n\n    container.style.top = this.options.anchor[0] + \"px\";\n    container.style.left = this.options.anchor[1] + \"px\";\n\n    var stop = L.DomEvent.stopPropagation;\n    L.DomEvent.on(container, \"click\", stop)\n      .on(container, \"mousedown\", stop)\n      .on(container, \"touchstart\", stop)\n      .on(container, \"dblclick\", stop)\n      .on(container, \"mousewheel\", stop)\n      .on(container, \"contextmenu\", stop)\n      .on(container, \"MozMousePixelScroll\", stop);\n\n    var innerContainer = (this._innerContainer = L.DomUtil.create(\n      \"div\",\n      className + \"-inner\"\n    ));\n\n    var grabberNode = (this._grabberNode = L.DomUtil.create(\n      \"div\",\n      className + \"-grabber\"\n    ));\n    var grabberIcon = L.DomUtil.create(\"i\", \"fa fa-arrows\");\n    grabberNode.appendChild(grabberIcon);\n\n    L.DomEvent.on(grabberNode, \"mousedown\", this._handleMoveStart, this);\n\n    var closeNode = (this._closeNode = L.DomUtil.create(\n      \"div\",\n      className + \"-close\"\n    ));\n    var closeIcon = L.DomUtil.create(\"i\", \"fa fa-times\");\n    closeNode.appendChild(closeIcon);\n    L.DomEvent.on(closeNode, \"click\", this._handleClose, this);\n\n    var resizerNode = (this._resizerNode = L.DomUtil.create(\n      \"div\",\n      className + \"-resizer\"\n    ));\n    var resizeIcon = L.DomUtil.create(\"i\", \"fa fa-arrows-h fa-rotate-45\");\n    resizerNode.appendChild(resizeIcon);\n\n    L.DomEvent.on(resizerNode, \"mousedown\", this._handleResizeStart, this);\n\n    var contentNode = (this._contentNode = L.DomUtil.create(\n      \"div\",\n      className + \"-contents\"\n    ));\n\n    container.appendChild(innerContainer);\n\n    innerContainer.appendChild(contentNode);\n    innerContainer.appendChild(grabberNode);\n    innerContainer.appendChild(closeNode);\n    innerContainer.appendChild(resizerNode);\n\n    this._oldMousePos = { x: 0, y: 0 };\n  },\n\n  _handleClose: function() {\n    this.close();\n  },\n\n  _handleResizeStart: function(e) {\n    this._oldMousePos.x = e.clientX;\n    this._oldMousePos.y = e.clientY;\n\n    L.DomEvent.on(this._map, \"mousemove\", this._handleMouseMove, this);\n    L.DomEvent.on(this._map, \"mouseup\", this._handleMouseUp, this);\n\n    this._map.fire(\"dialog:resizestart\", this);\n    this._resizing = true;\n  },\n\n  _handleMoveStart: function(e) {\n    this._oldMousePos.x = e.clientX;\n    this._oldMousePos.y = e.clientY;\n\n    L.DomEvent.on(this._map, \"mousemove\", this._handleMouseMove, this);\n    L.DomEvent.on(this._map, \"mouseup\", this._handleMouseUp, this);\n\n    this._map.fire(\"dialog:movestart\", this);\n    this._moving = true;\n  },\n\n  _handleMouseMove: function(e) {\n    var diffX = e.originalEvent.clientX - this._oldMousePos.x,\n      diffY = e.originalEvent.clientY - this._oldMousePos.y;\n\n    // this helps prevent accidental highlighting on drag:\n    if (e.originalEvent.stopPropagation) {\n      e.originalEvent.stopPropagation();\n    }\n    if (e.originalEvent.preventDefault) {\n      e.originalEvent.preventDefault();\n    }\n\n    if (this._resizing) {\n      this._resize(diffX, diffY);\n    }\n\n    if (this._moving) {\n      this._move(diffX, diffY);\n    }\n  },\n\n  _handleMouseUp: function() {\n    L.DomEvent.off(this._map, \"mousemove\", this._handleMouseMove, this);\n    L.DomEvent.off(this._map, \"mouseup\", this._handleMouseUp, this);\n\n    if (this._resizing) {\n      this._resizing = false;\n      this._map.fire(\"dialog:resizeend\", this);\n    }\n\n    if (this._moving) {\n      this._moving = false;\n      this._map.fire(\"dialog:moveend\", this);\n    }\n  },\n\n  _move: function(diffX, diffY) {\n    var newY = this.options.anchor[0] + diffY;\n    var newX = this.options.anchor[1] + diffX;\n\n    this.options.anchor[0] = newY;\n    this.options.anchor[1] = newX;\n\n    this._container.style.top = this.options.anchor[0] + \"px\";\n    this._container.style.left = this.options.anchor[1] + \"px\";\n\n    this._map.fire(\"dialog:moving\", this);\n\n    this._oldMousePos.y += diffY;\n    this._oldMousePos.x += diffX;\n  },\n\n  _resize: function(diffX, diffY) {\n    var newX = this.options.size[0] + diffX;\n    var newY = this.options.size[1] + diffY;\n\n    if (newX <= this.options.maxSize[0] && newX >= this.options.minSize[0]) {\n      this.options.size[0] = newX;\n      this._container.style.width = this.options.size[0] + \"px\";\n      this._oldMousePos.x += diffX;\n    }\n\n    if (newY <= this.options.maxSize[1] && newY >= this.options.minSize[1]) {\n      this.options.size[1] = newY;\n      this._container.style.height = this.options.size[1] + \"px\";\n      this._oldMousePos.y += diffY;\n    }\n\n    this._map.fire(\"dialog:resizing\", this);\n  },\n\n  _updateContent: function() {\n    if (!this._content) {\n      return;\n    }\n\n    var node = this._contentNode;\n    var content =\n      typeof this._content === \"function\" ? this._content(this) : this._content;\n\n    if (typeof content === \"string\") {\n      node.innerHTML = content;\n    } else {\n      while (node.hasChildNodes()) {\n        node.removeChild(node.firstChild);\n      }\n      node.appendChild(content);\n    }\n  },\n\n  _updateLayout: function() {\n    this._container.style.width = this.options.size[0] + \"px\";\n    this._container.style.height = this.options.size[1] + \"px\";\n\n    this._container.style.top = this.options.anchor[0] + \"px\";\n    this._container.style.left = this.options.anchor[1] + \"px\";\n  }\n});\n\nL.control.dialog = function(options) {\n  return new L.Control.Dialog(options);\n};\n","/*\n Leaflet.draw 1.0.4, a plugin that adds drawing and editing tools to Leaflet powered maps.\n (c) 2012-2017, Jacob Toye, Jon West, Smartrak, Leaflet\n\n https://github.com/Leaflet/Leaflet.draw\n http://leafletjs.com\n */\n!function(t,e,i){function o(t,e){for(;(t=t.parentElement)&&!t.classList.contains(e););return t}L.drawVersion=\"1.0.4\",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:\"Cancel drawing\",text:\"Cancel\"},finish:{title:\"Finish drawing\",text:\"Finish\"},undo:{title:\"Delete last point drawn\",text:\"Delete last point\"},buttons:{polyline:\"Draw a polyline\",polygon:\"Draw a polygon\",rectangle:\"Draw a rectangle\",circle:\"Draw a circle\",marker:\"Draw a marker\",circlemarker:\"Draw a circlemarker\"}},handlers:{circle:{tooltip:{start:\"Click and drag to draw circle.\"},radius:\"Radius\"},circlemarker:{tooltip:{start:\"Click map to place circle marker.\"}},marker:{tooltip:{start:\"Click map to place marker.\"}},polygon:{tooltip:{start:\"Click to start drawing shape.\",cont:\"Click to continue drawing shape.\",end:\"Click first point to close this shape.\"}},polyline:{error:\"<strong>Error:</strong> shape edges cannot cross!\",tooltip:{start:\"Click to start drawing line.\",cont:\"Click to continue drawing line.\",end:\"Click last point to finish line.\"}},rectangle:{tooltip:{start:\"Click and drag to draw rectangle.\"}},simpleshape:{tooltip:{end:\"Release mouse to finish drawing.\"}}}},edit:{toolbar:{actions:{save:{title:\"Save changes\",text:\"Save\"},cancel:{title:\"Cancel editing, discards all changes\",text:\"Cancel\"},clearAll:{title:\"Clear all layers\",text:\"Clear All\"}},buttons:{edit:\"Edit layers\",editDisabled:\"No layers to edit\",remove:\"Delete layers\",removeDisabled:\"No layers to delete\"}},handlers:{edit:{tooltip:{text:\"Drag handles or markers to edit features.\",subtext:\"Click cancel to undo changes.\"}},remove:{tooltip:{text:\"Click on a feature to remove.\"}}}}},L.Draw.Event={},L.Draw.Event.CREATED=\"draw:created\",L.Draw.Event.EDITED=\"draw:edited\",L.Draw.Event.DELETED=\"draw:deleted\",L.Draw.Event.DRAWSTART=\"draw:drawstart\",L.Draw.Event.DRAWSTOP=\"draw:drawstop\",L.Draw.Event.DRAWVERTEX=\"draw:drawvertex\",L.Draw.Event.EDITSTART=\"draw:editstart\",L.Draw.Event.EDITMOVE=\"draw:editmove\",L.Draw.Event.EDITRESIZE=\"draw:editresize\",L.Draw.Event.EDITVERTEX=\"draw:editvertex\",L.Draw.Event.EDITSTOP=\"draw:editstop\",L.Draw.Event.DELETESTART=\"draw:deletestart\",L.Draw.Event.DELETESTOP=\"draw:deletestop\",L.Draw.Event.TOOLBAROPENED=\"draw:toolbaropened\",L.Draw.Event.TOOLBARCLOSED=\"draw:toolbarclosed\",L.Draw.Event.MARKERCONTEXT=\"draw:markercontext\",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(t,e){this._map=t,this._container=t._container,this._overlayPane=t._panes.overlayPane,this._popupPane=t._panes.popupPane,e&&e.shapeOptions&&(e.shapeOptions=L.Util.extend({},this.options.shapeOptions,e.shapeOptions)),L.setOptions(this,e);var i=L.version.split(\".\");1===parseInt(i[0],10)&&parseInt(i[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire(\"enabled\",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire(\"disabled\",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(L.DomUtil.disableTextSelection(),t.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,\"keyup\",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,\"keyup\",this._cancelDrawing,this))},setOptions:function(t){L.setOptions(this,t)},_fireCreatedEvent:function(t){this._map.fire(L.Draw.Event.CREATED,{layer:t,layerType:this.type})},_cancelDrawing:function(t){27===t.keyCode&&(this._map.fire(\"draw:canceled\",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:\"polyline\"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:\"#b00b00\",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:\"leaflet-div-icon leaflet-editing-icon\"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:\"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon\"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:\"#3388ff\",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(t,e){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,e&&e.drawError&&(e.drawError=L.Util.extend({},this.options.drawError,e.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:\"leaflet-mouse-marker\",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on(\"mouseout\",this._onMouseOut,this).on(\"mousemove\",this._onMouseMove,this).on(\"mousedown\",this._onMouseDown,this).on(\"mouseup\",this._onMouseUp,this).addTo(this._map),this._map.on(\"mouseup\",this._onMouseUp,this).on(\"mousemove\",this._onMouseMove,this).on(\"zoomlevelschange\",this._onZoomEnd,this).on(\"touchstart\",this._onTouch,this).on(\"zoomend\",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off(\"mousedown\",this._onMouseDown,this).off(\"mouseout\",this._onMouseOut,this).off(\"mouseup\",this._onMouseUp,this).off(\"mousemove\",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off(\"mouseup\",this._onMouseUp,this).off(\"mousemove\",this._onMouseMove,this).off(\"zoomlevelschange\",this._onZoomEnd,this).off(\"zoomend\",this._onZoomEnd,this).off(\"touchstart\",this._onTouch,this).off(\"click\",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var t=this._markers.pop(),e=this._poly,i=e.getLatLngs(),o=i.splice(-1,1)[0];this._poly.setLatLngs(i),this._markerGroup.removeLayer(t),e.getLatLngs().length<2&&this._map.removeLayer(e),this._vertexChanged(o,!1)}},addVertex:function(t){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(t))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(t)),this._poly.addLatLng(t),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),this._vertexChanged(t,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var t=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),e=this._poly.newLatLngIntersects(t[t.length-1]);if(!this.options.allowIntersection&&e||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){null!==this._markers&&this._updateGuide()},_onMouseMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent),i=this._map.layerPointToLatLng(e);this._currentLatLng=i,this._updateTooltip(i),this._updateGuide(e),this._mouseMarker.setLatLng(i),L.DomEvent.preventDefault(t.originalEvent)},_vertexChanged:function(t,e){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(t,e),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(t){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(t),this._clickHandled=!0,this._disableNewMarkers();var e=t.originalEvent,i=e.clientX,o=e.clientY;this._startPoint.call(this,i,o)}},_startPoint:function(t,e){this._mouseDownOrigin=L.point(t,e)},_onMouseUp:function(t){var e=t.originalEvent,i=e.clientX,o=e.clientY;this._endPoint.call(this,i,o,t),this._clickHandled=null},_endPoint:function(e,i,o){if(this._mouseDownOrigin){var a=L.point(e,i).distanceTo(this._mouseDownOrigin),n=this._calculateFinishDistance(o.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(o.latlng),this._finishShape()):n<10&&L.Browser.touch?this._finishShape():Math.abs(a)<9*(t.devicePixelRatio||1)&&this.addVertex(o.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(t){var e,i,o=t.originalEvent;!o.touches||!o.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(e=o.touches[0].clientX,i=o.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,e,i),this._endPoint.call(this,e,i,t),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(t){var e;if(this._markers.length>0){var i;if(this.type===L.Draw.Polyline.TYPE)i=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;i=this._markers[0]}var o=this._map.latLngToContainerPoint(i.getLatLng()),a=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),n=this._map.latLngToContainerPoint(a.getLatLng());e=o.distanceTo(n)}else e=1/0;return e},_updateFinishHandler:function(){var t=this._markers.length;t>1&&this._markers[t-1].on(\"click\",this._finishShape,this),t>2&&this._markers[t-2].off(\"click\",this._finishShape,this)},_createMarker:function(t){var e=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(e),e},_updateGuide:function(t){var e=this._markers?this._markers.length:0;e>0&&(t=t||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[e-1].getLatLng()),t))},_updateTooltip:function(t){var e=this._getTooltipText();t&&this._tooltip.updatePosition(t),this._errorShown||this._tooltip.updateContent(e)},_drawGuide:function(t,e){var i,o,a,n=Math.floor(Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))),s=this.options.guidelineDistance,r=this.options.maxGuideLineLength,l=n>r?n-r:s;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create(\"div\",\"leaflet-draw-guides\",this._overlayPane));l<n;l+=this.options.guidelineDistance)i=l/n,o={x:Math.floor(t.x*(1-i)+i*e.x),y:Math.floor(t.y*(1-i)+i*e.y)},a=L.DomUtil.create(\"div\",\"leaflet-draw-guide-dash\",this._guidesContainer),a.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(a,o)},_updateGuideColor:function(t){if(this._guidesContainer)for(var e=0,i=this._guidesContainer.childNodes.length;e<i;e++)this._guidesContainer.childNodes[e].style.backgroundColor=t},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var t,e,i=this.options.showLength;return 0===this._markers.length?t={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(e=i?this._getMeasurementString():\"\",t=1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:e}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:e}),t},_updateRunningMeasure:function(t,e){var i,o,a=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(i=a-(e?2:1),o=L.GeometryUtil.isVersion07x()?t.distanceTo(this._markers[i].getLatLng())*(this.options.factor||1):this._map.distance(t,this._markers[i].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=o*(e?1:-1))},_getMeasurementString:function(){var t,e=this._currentLatLng,i=this._markers[this._markers.length-1].getLatLng();return t=L.GeometryUtil.isVersion07x()?i&&e&&e.distanceTo?this._measurementRunningTotal+e.distanceTo(i)*(this.options.factor||1):this._measurementRunningTotal||0:i&&e?this._measurementRunningTotal+this._map.distance(e,i)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(t,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout(function(){this._disableMarkers=!1}.bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off(\"click\",this._finishShape,this)},_fireCreatedEvent:function(){var t=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:\"polygon\"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:\"#3388ff\",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(t,e){L.Draw.Polyline.prototype.initialize.call(this,t,e),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var t=this._markers.length;1===t&&this._markers[0].on(\"click\",this._finishShape,this),t>2&&(this._markers[t-1].on(\"dblclick\",this._finishShape,this),t>3&&this._markers[t-2].off(\"dblclick\",this._finishShape,this))},_getTooltipText:function(){var t,e;return 0===this._markers.length?t=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(t=L.drawLocal.draw.handlers.polygon.tooltip.cont,e=this._getMeasurementString()):(t=L.drawLocal.draw.handlers.polygon.tooltip.end,e=this._getMeasurementString()),{text:t,subtext:e}},_getMeasurementString:function(){var t=this._area,e=\"\";return t||this.options.showLength?(this.options.showLength&&(e=L.Draw.Polyline.prototype._getMeasurementString.call(this)),t&&(e+=\"<br>\"+L.GeometryUtil.readableArea(t,this.options.metric,this.options.precision)),e):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(t,e){var i;!this.options.allowIntersection&&this.options.showArea&&(i=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(i)),L.Draw.Polyline.prototype._vertexChanged.call(this,t,e)},_cleanUpShape:function(){var t=this._markers.length;t>0&&(this._markers[0].off(\"click\",this._finishShape,this),t>2&&this._markers[t-1].off(\"dblclick\",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(t,e){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor=\"crosshair\",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on(\"mousedown\",this._onMouseDown,this).on(\"mousemove\",this._onMouseMove,this).on(\"touchstart\",this._onMouseDown,this).on(\"touchmove\",this._onMouseMove,this),e.addEventListener(\"touchstart\",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor=\"\",this._map.off(\"mousedown\",this._onMouseDown,this).off(\"mousemove\",this._onMouseMove,this).off(\"touchstart\",this._onMouseDown,this).off(\"touchmove\",this._onMouseMove,this),L.DomEvent.off(e,\"mouseup\",this._onMouseUp,this),L.DomEvent.off(e,\"touchend\",this._onMouseUp,this),e.removeEventListener(\"touchstart\",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(t){this._isDrawing=!0,this._startLatLng=t.latlng,L.DomEvent.on(e,\"mouseup\",this._onMouseUp,this).on(e,\"touchend\",this._onMouseUp,this).preventDefault(t.originalEvent)},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(e))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:\"rectangle\"},options:{shapeOptions:{stroke:!0,color:\"#3388ff\",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(t,e){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(t){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!o(t.target,\"leaflet-pane\")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(t){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,t)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,t),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_getTooltipText:function(){var t,e,i,o=L.Draw.SimpleShape.prototype._getTooltipText.call(this),a=this._shape,n=this.options.showArea;return a&&(t=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),e=L.GeometryUtil.geodesicArea(t),i=n?L.GeometryUtil.readableArea(e,this.options.metric):\"\"),{text:o.text,subtext:i}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:\"marker\"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:\"leaflet-mouse-marker\",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on(\"click\",this._onClick,this).addTo(this._map),this._map.on(\"mousemove\",this._onMouseMove,this),this._map.on(\"click\",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off(\"click\",this._onClick,this).off(\"click\",this._onTouch,this),this._marker&&(this._marker.off(\"click\",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off(\"click\",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off(\"mousemove\",this._onMouseMove,this))},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._mouseMarker.setLatLng(e),this._marker?(e=this._mouseMarker.getLatLng(),this._marker.setLatLng(e)):(this._marker=this._createMarker(e),this._marker.on(\"click\",this._onClick,this),this._map.on(\"click\",this._onClick,this).addLayer(this._marker))},_createMarker:function(t){return new L.Marker(t,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(t){this._onMouseMove(t),this._onClick()},_fireCreatedEvent:function(){var t=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:\"circlemarker\"},options:{stroke:!0,color:\"#3388ff\",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,t,e)},_fireCreatedEvent:function(){var t=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)},_createMarker:function(t){return new L.CircleMarker(t,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:\"circle\"},options:{shapeOptions:{stroke:!0,color:\"#3388ff\",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(t,e){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},_drawShape:function(t){if(L.GeometryUtil.isVersion07x())var e=this._startLatLng.distanceTo(t);else var e=this._map.distance(this._startLatLng,t);this._shape?this._shape.setRadius(e):(this._shape=new L.Circle(this._startLatLng,e,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_onMouseMove:function(t){var e,i=t.latlng,o=this.options.showRadius,a=this.options.metric;if(this._tooltip.updatePosition(i),this._isDrawing){this._drawShape(i),e=this._shape.getRadius().toFixed(1);var n=\"\";o&&(n=L.drawLocal.draw.handlers.circle.radius+\": \"+L.GeometryUtil.readableDistance(e,a,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:n})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(t,e){this._marker=t,L.setOptions(this,e)},addHooks:function(){var t=this._marker;t.dragging.enable(),t.on(\"dragend\",this._onDragEnd,t),this._toggleMarkerHighlight()},removeHooks:function(){var t=this._marker;t.dragging.disable(),t.off(\"dragend\",this._onDragEnd,t),this._toggleMarkerHighlight()},_onDragEnd:function(t){var e=t.target;e.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:e})},_toggleMarkerHighlight:function(){var t=this._marker._icon;t&&(t.style.display=\"none\",L.DomUtil.hasClass(t,\"leaflet-edit-marker-selected\")?(L.DomUtil.removeClass(t,\"leaflet-edit-marker-selected\"),this._offsetMarker(t,-4)):(L.DomUtil.addClass(t,\"leaflet-edit-marker-selected\"),this._offsetMarker(t,4)),t.style.display=\"\")},_offsetMarker:function(t,e){var i=parseInt(t.style.marginTop,10)-e,o=parseInt(t.style.marginLeft,10)-e;t.style.marginTop=i+\"px\",t.style.marginLeft=o+\"px\"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(t){this.latlngs=[t._latlngs],t._holes&&(this.latlngs=this.latlngs.concat(t._holes)),this._poly=t,this._poly.on(\"revert-edited\",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(t){for(var e=0;e<this._verticesHandlers.length;e++)t(this._verticesHandlers[e])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(t){t.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(t){t.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(t){t.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var t=0;t<this.latlngs.length;t++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[t],this._poly.options.poly))},_updateLatLngs:function(t){this.latlngs=[t.layer._latlngs],t.layer._holes&&(this.latlngs=this.latlngs.concat(t.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:\"leaflet-div-icon leaflet-editing-icon\"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:\"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon\"}),drawError:{color:\"#b00b00\",timeout:1e3}},initialize:function(t,e,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=t,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this._latlngs=e,L.setOptions(this,i)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var t=this._poly,e=t._path;t instanceof L.Polygon||(t.options.fill=!1,t.options.editing&&(t.options.editing.fill=!1)),e&&t.options.editing&&t.options.editing.className&&(t.options.original.className&&t.options.original.className.split(\" \").forEach(function(t){L.DomUtil.removeClass(e,t)}),t.options.editing.className.split(\" \").forEach(function(t){L.DomUtil.addClass(e,t)})),t.setStyle(t.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var t=this._poly,e=t._path;e&&t.options.editing&&t.options.editing.className&&(t.options.editing.className.split(\" \").forEach(function(t){L.DomUtil.removeClass(e,t)}),t.options.original.className&&t.options.original.className.split(\" \").forEach(function(t){L.DomUtil.addClass(e,t)})),t.setStyle(t.options.original),t._map&&(t._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var t,e,i,o,a=this._defaultShape();for(t=0,i=a.length;t<i;t++)o=this._createMarker(a[t],t),o.on(\"click\",this._onMarkerClick,this),o.on(\"contextmenu\",this._onContextMenu,this),this._markers.push(o);var n,s;for(t=0,e=i-1;t<i;e=t++)(0!==t||L.Polygon&&this._poly instanceof L.Polygon)&&(n=this._markers[e],s=this._markers[t],this._createMiddleMarker(n,s),this._updatePrevNext(n,s))},_createMarker:function(t,e){var i=new L.Marker.Touch(t,{draggable:!0,icon:this.options.icon});return i._origLatLng=t,i._index=e,i.on(\"dragstart\",this._onMarkerDragStart,this).on(\"drag\",this._onMarkerDrag,this).on(\"dragend\",this._fireEdit,this).on(\"touchmove\",this._onTouchMove,this).on(\"touchend\",this._fireEdit,this).on(\"MSPointerMove\",this._onTouchMove,this).on(\"MSPointerUp\",this._fireEdit,this),this._markerGroup.addLayer(i),i},_onMarkerDragStart:function(){this._poly.fire(\"editstart\")},_spliceLatLngs:function(){var t=this._defaultShape(),e=[].splice.apply(t,arguments);return this._poly._convertLatLngs(t,!0),this._poly.redraw(),e},_removeMarker:function(t){var e=t._index;this._markerGroup.removeLayer(t),this._markers.splice(e,1),this._spliceLatLngs(e,1),this._updateIndexes(e,-1),t.off(\"dragstart\",this._onMarkerDragStart,this).off(\"drag\",this._onMarkerDrag,this).off(\"dragend\",this._fireEdit,this).off(\"touchmove\",this._onMarkerDrag,this).off(\"touchend\",this._fireEdit,this).off(\"click\",this._onMarkerClick,this).off(\"MSPointerMove\",this._onTouchMove,this).off(\"MSPointerUp\",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire(\"edit\"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(t){var e=t.target,i=this._poly,o=L.LatLngUtil.cloneLatLng(e._origLatLng);if(L.extend(e._origLatLng,e._latlng),i.options.poly){var a=i._map._editTooltip;if(!i.options.poly.allowIntersection&&i.intersects()){L.extend(e._origLatLng,o),e.setLatLng(o);var n=i.options.color;i.setStyle({color:this.options.drawError.color}),a&&a.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){i.setStyle({color:n}),a&&a.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}e._middleLeft&&e._middleLeft.setLatLng(this._getMiddleLatLng(e._prev,e)),e._middleRight&&e._middleRight.setLatLng(this._getMiddleLatLng(e,e._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var s=this._poly.getLatLngs();this._poly._convertLatLngs(s,!0),this._poly.redraw(),this._poly.fire(\"editdrag\")},_onMarkerClick:function(t){var e=L.Polygon&&this._poly instanceof L.Polygon?4:3,i=t.target;this._defaultShape().length<e||(this._removeMarker(i),this._updatePrevNext(i._prev,i._next),i._middleLeft&&this._markerGroup.removeLayer(i._middleLeft),i._middleRight&&this._markerGroup.removeLayer(i._middleRight),i._prev&&i._next?this._createMiddleMarker(i._prev,i._next):i._prev?i._next||(i._prev._middleRight=null):i._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(t){var e=t.target;this._poly;this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:e,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),i=this._map.layerPointToLatLng(e),o=t.target;L.extend(o._origLatLng,i),o._middleLeft&&o._middleLeft.setLatLng(this._getMiddleLatLng(o._prev,o)),o._middleRight&&o._middleRight.setLatLng(this._getMiddleLatLng(o,o._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(t,e){this._markerGroup.eachLayer(function(i){i._index>t&&(i._index+=e)})},_createMiddleMarker:function(t,e){var i,o,a,n=this._getMiddleLatLng(t,e),s=this._createMarker(n);s.setOpacity(.6),t._middleRight=e._middleLeft=s,o=function(){s.off(\"touchmove\",o,this);var a=e._index;s._index=a,s.off(\"click\",i,this).on(\"click\",this._onMarkerClick,this),n.lat=s.getLatLng().lat,n.lng=s.getLatLng().lng,this._spliceLatLngs(a,0,n),this._markers.splice(a,0,s),s.setOpacity(1),this._updateIndexes(a,1),e._index++,this._updatePrevNext(t,s),this._updatePrevNext(s,e),this._poly.fire(\"editstart\")},a=function(){s.off(\"dragstart\",o,this),s.off(\"dragend\",a,this),s.off(\"touchmove\",o,this),this._createMiddleMarker(t,s),this._createMiddleMarker(s,e)},i=function(){o.call(this),a.call(this),this._fireEdit()},s.on(\"click\",i,this).on(\"dragstart\",o,this).on(\"dragend\",a,this).on(\"touchmove\",o,this),this._markerGroup.addLayer(s)},_updatePrevNext:function(t,e){t&&(t._next=e),e&&(e._prev=t)},_getMiddleLatLng:function(t,e){var i=this._poly._map,o=i.project(t.getLatLng()),a=i.project(e.getLatLng());return i.unproject(o._add(a)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on(\"add\",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on(\"remove\",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:\"leaflet-div-icon leaflet-editing-icon leaflet-edit-move\"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),\nclassName:\"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize\"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:\"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon\"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:\"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon\"})},initialize:function(t,e){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=t,L.Util.setOptions(this,e)},addHooks:function(){var t=this._shape;this._shape._map&&(this._map=this._shape._map,t.setStyle(t.options.editing),t._map&&(this._map=t._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var t=this._shape;if(t.setStyle(t.options.original),t._map){this._unbindMarker(this._moveMarker);for(var e=0,i=this._resizeMarkers.length;e<i;e++)this._unbindMarker(this._resizeMarkers[e]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(t,e){var i=new L.Marker.Touch(t,{draggable:!0,icon:e,zIndexOffset:10});return this._bindMarker(i),this._markerGroup.addLayer(i),i},_bindMarker:function(t){t.on(\"dragstart\",this._onMarkerDragStart,this).on(\"drag\",this._onMarkerDrag,this).on(\"dragend\",this._onMarkerDragEnd,this).on(\"touchstart\",this._onTouchStart,this).on(\"touchmove\",this._onTouchMove,this).on(\"MSPointerMove\",this._onTouchMove,this).on(\"touchend\",this._onTouchEnd,this).on(\"MSPointerUp\",this._onTouchEnd,this)},_unbindMarker:function(t){t.off(\"dragstart\",this._onMarkerDragStart,this).off(\"drag\",this._onMarkerDrag,this).off(\"dragend\",this._onMarkerDragEnd,this).off(\"touchstart\",this._onTouchStart,this).off(\"touchmove\",this._onTouchMove,this).off(\"MSPointerMove\",this._onTouchMove,this).off(\"touchend\",this._onTouchEnd,this).off(\"MSPointerUp\",this._onTouchEnd,this)},_onMarkerDragStart:function(t){t.target.setOpacity(0),this._shape.fire(\"editstart\")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire(\"edit\")},_onMarkerDrag:function(t){var e=t.target,i=e.getLatLng();e===this._moveMarker?this._move(i):this._resize(i),this._shape.redraw(),this._shape.fire(\"editdrag\")},_onMarkerDragEnd:function(t){t.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(t){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t),\"function\"==typeof this._getCorners){var e=this._getCorners(),i=t.target,o=i._cornerIndex;i.setOpacity(0),this._oppositeCorner=e[(o+2)%4],this._toggleCornerMarkers(0,o)}this._shape.fire(\"editstart\")},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),i=this._map.layerPointToLatLng(e);return t.target===this._moveMarker?this._move(i):this._resize(i),this._shape.redraw(),!1},_onTouchEnd:function(t){t.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getBounds(),e=t.getCenter();this._moveMarker=this._createMarker(e,this.options.moveIcon)},_createResizeMarker:function(){var t=this._getCorners();this._resizeMarkers=[];for(var e=0,i=t.length;e<i;e++)this._resizeMarkers.push(this._createMarker(t[e],this.options.resizeIcon)),this._resizeMarkers[e]._cornerIndex=e},_onMarkerDragStart:function(t){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t);var e=this._getCorners(),i=t.target,o=i._cornerIndex;this._oppositeCorner=e[(o+2)%4],this._toggleCornerMarkers(0,o)},_onMarkerDragEnd:function(t){var e,i,o=t.target;o===this._moveMarker&&(e=this._shape.getBounds(),i=e.getCenter(),o.setLatLng(i)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,t)},_move:function(t){for(var e,i=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),o=this._shape.getBounds(),a=o.getCenter(),n=[],s=0,r=i.length;s<r;s++)e=[i[s].lat-a.lat,i[s].lng-a.lng],n.push([t.lat+e[0],t.lng+e[1]]);this._shape.setLatLngs(n),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(t){var e;this._shape.setBounds(L.latLngBounds(t,this._oppositeCorner)),e=this._shape.getBounds(),this._moveMarker.setLatLng(e.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var t=this._shape.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]},_toggleCornerMarkers:function(t){for(var e=0,i=this._resizeMarkers.length;e<i;e++)this._resizeMarkers[e].setOpacity(t)},_repositionCornerMarkers:function(){for(var t=this._getCorners(),e=0,i=this._resizeMarkers.length;e<i;e++)this._resizeMarkers[e].setLatLng(t[e])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getLatLng();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(t){if(this._resizeMarkers.length){var e=this._getResizeMarkerPoint(t);this._resizeMarkers[0].setLatLng(e)}this._shape.setLatLng(t),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on(\"add\",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on(\"remove\",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var t=this._shape.getLatLng(),e=this._getResizeMarkerPoint(t);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(e,this.options.resizeIcon))},_getResizeMarkerPoint:function(t){var e=this._shape._radius*Math.cos(Math.PI/4),i=this._map.project(t);return this._map.unproject([i.x+e,i.y-e])},_resize:function(t){var e=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=e.distanceTo(t):radius=this._map.distance(e,t),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+\"<br />\"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+\": \"+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,\"touchstart\",this._onTouchStart,this),L.DomEvent.on(this._container,\"touchend\",this._onTouchEnd,this),L.DomEvent.on(this._container,\"touchmove\",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,\"MSPointerDown\",this._onTouchStart,this),L.DomEvent.on(this._container,\"MSPointerUp\",this._onTouchEnd,this),L.DomEvent.on(this._container,\"MSPointerMove\",this._onTouchMove,this),L.DomEvent.on(this._container,\"MSPointerCancel\",this._onTouchCancel,this)):(L.DomEvent.on(this._container,\"touchcancel\",this._onTouchCancel,this),L.DomEvent.on(this._container,\"touchleave\",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,\"touchstart\",this._onTouchStart,this),L.DomEvent.off(this._container,\"touchend\",this._onTouchEnd,this),L.DomEvent.off(this._container,\"touchmove\",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,\"MSPointerDown\",this._onTouchStart,this),L.DomEvent.off(this._container,\"MSPointerUp\",this._onTouchEnd,this),L.DomEvent.off(this._container,\"MSPointerMove\",this._onTouchMove,this),L.DomEvent.off(this._container,\"MSPointerCancel\",this._onTouchCancel,this)):(L.DomEvent.off(this._container,\"touchcancel\",this._onTouchCancel,this),L.DomEvent.off(this._container,\"touchleave\",this._onTouchLeave,this))},_touchEvent:function(t,e){var i={};if(void 0!==t.touches){if(!t.touches.length)return;i=t.touches[0]}else{if(\"touch\"!==t.pointerType)return;if(i=t,!this._filterClick(t))return}var o=this._map.mouseEventToContainerPoint(i),a=this._map.mouseEventToLayerPoint(i),n=this._map.layerPointToLatLng(a);this._map.fire(e,{latlng:n,layerPoint:a,containerPoint:o,pageX:i.pageX,pageY:i.pageY,originalEvent:t})},_filterClick:function(t){var e=t.timeStamp||t.originalEvent.timeStamp,i=L.DomEvent._lastClick&&e-L.DomEvent._lastClick;return i&&i>100&&i<500||t.target._simulatedClick&&!t._simulated?(L.DomEvent.stop(t),!1):(L.DomEvent._lastClick=e,!0)},_onTouchStart:function(t){if(this._map._loaded){this._touchEvent(t,\"touchstart\")}},_onTouchEnd:function(t){if(this._map._loaded){this._touchEvent(t,\"touchend\")}},_onTouchCancel:function(t){if(this._map._loaded){var e=\"touchcancel\";this._detectIE()&&(e=\"pointercancel\"),this._touchEvent(t,e)}},_onTouchLeave:function(t){if(this._map._loaded){this._touchEvent(t,\"touchleave\")}},_onTouchMove:function(t){if(this._map._loaded){this._touchEvent(t,\"touchmove\")}},_detectIE:function(){var e=t.navigator.userAgent,i=e.indexOf(\"MSIE \");if(i>0)return parseInt(e.substring(i+5,e.indexOf(\".\",i)),10);if(e.indexOf(\"Trident/\")>0){var o=e.indexOf(\"rv:\");return parseInt(e.substring(o+3,e.indexOf(\".\",o)),10)}var a=e.indexOf(\"Edge/\");return a>0&&parseInt(e.substring(a+5,e.indexOf(\".\",a)),10)}}),L.Map.addInitHook(\"addHandler\",\"touchExtend\",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var t=this._icon,e=[\"dblclick\",\"mousedown\",\"mouseover\",\"mouseout\",\"contextmenu\",\"touchstart\",\"touchend\",\"touchmove\"];this._detectIE?e.concat([\"MSPointerDown\",\"MSPointerUp\",\"MSPointerMove\",\"MSPointerCancel\"]):e.concat([\"touchcancel\"]),L.DomUtil.addClass(t,\"leaflet-clickable\"),L.DomEvent.on(t,\"click\",this._onMouseClick,this),L.DomEvent.on(t,\"keypress\",this._onKeyPress,this);for(var i=0;i<e.length;i++)L.DomEvent.on(t,e[i],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var e=t.navigator.userAgent,i=e.indexOf(\"MSIE \");if(i>0)return parseInt(e.substring(i+5,e.indexOf(\".\",i)),10);if(e.indexOf(\"Trident/\")>0){var o=e.indexOf(\"rv:\");return parseInt(e.substring(o+3,e.indexOf(\".\",o)),10)}var a=e.indexOf(\"Edge/\");return a>0&&parseInt(e.substring(a+5,e.indexOf(\".\",a)),10)}}),L.LatLngUtil={cloneLatLngs:function(t){for(var e=[],i=0,o=t.length;i<o;i++)Array.isArray(t[i])?e.push(L.LatLngUtil.cloneLatLngs(t[i])):e.push(this.cloneLatLng(t[i]));return e},cloneLatLng:function(t){return L.latLng(t.lat,t.lng)}},function(){var t={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(t){var e,i,o=t.length,a=0,n=Math.PI/180;if(o>2){for(var s=0;s<o;s++)e=t[s],i=t[(s+1)%o],a+=(i.lng-e.lng)*n*(2+Math.sin(e.lat*n)+Math.sin(i.lat*n));a=6378137*a*6378137/2}return Math.abs(a)},formattedNumber:function(t,e){var i=parseFloat(t).toFixed(e),o=L.drawLocal.format&&L.drawLocal.format.numeric,a=o&&o.delimiters,n=a&&a.thousands,s=a&&a.decimal;if(n||s){var r=i.split(\".\");i=n?r[0].replace(/(\\d)(?=(\\d{3})+(?!\\d))/g,\"$1\"+n):r[0],s=s||\".\",r.length>1&&(i=i+s+r[1])}return i},readableArea:function(e,i,o){var a,n,o=L.Util.extend({},t,o);return i?(n=[\"ha\",\"m\"],type=typeof i,\"string\"===type?n=[i]:\"boolean\"!==type&&(n=i),a=e>=1e6&&-1!==n.indexOf(\"km\")?L.GeometryUtil.formattedNumber(1e-6*e,o.km)+\" km\":e>=1e4&&-1!==n.indexOf(\"ha\")?L.GeometryUtil.formattedNumber(1e-4*e,o.ha)+\" ha\":L.GeometryUtil.formattedNumber(e,o.m)+\" m\"):(e/=.836127,a=e>=3097600?L.GeometryUtil.formattedNumber(e/3097600,o.mi)+\" mi\":e>=4840?L.GeometryUtil.formattedNumber(e/4840,o.ac)+\" acres\":L.GeometryUtil.formattedNumber(e,o.yd)+\" yd\"),a},readableDistance:function(e,i,o,a,n){var s,n=L.Util.extend({},t,n);switch(i?\"string\"==typeof i?i:\"metric\":o?\"feet\":a?\"nauticalMile\":\"yards\"){case\"metric\":s=e>1e3?L.GeometryUtil.formattedNumber(e/1e3,n.km)+\" km\":L.GeometryUtil.formattedNumber(e,n.m)+\" m\";break;case\"feet\":e*=3.28083,s=L.GeometryUtil.formattedNumber(e,n.ft)+\" ft\";break;case\"nauticalMile\":e*=.53996,s=L.GeometryUtil.formattedNumber(e/1e3,n.nm)+\" nm\";break;case\"yards\":default:e*=1.09361,s=e>1760?L.GeometryUtil.formattedNumber(e/1760,n.mi)+\" miles\":L.GeometryUtil.formattedNumber(e,n.yd)+\" yd\"}return s},isVersion07x:function(){var t=L.version.split(\".\");return 0===parseInt(t[0],10)&&7===parseInt(t[1],10)}})}(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(t,e,i,o){return this._checkCounterclockwise(t,i,o)!==this._checkCounterclockwise(e,i,o)&&this._checkCounterclockwise(t,e,i)!==this._checkCounterclockwise(t,e,o)},_checkCounterclockwise:function(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}}),L.Polyline.include({intersects:function(){var t,e,i,o=this._getProjectedPoints(),a=o?o.length:0;if(this._tooFewPointsForIntersection())return!1;for(t=a-1;t>=3;t--)if(e=o[t-1],i=o[t],this._lineSegmentsIntersectsRange(e,i,t-2))return!0;return!1},newLatLngIntersects:function(t,e){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(t),e)},newPointIntersects:function(t,e){var i=this._getProjectedPoints(),o=i?i.length:0,a=i?i[o-1]:null,n=o-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(a,t,n,e?1:0)},_tooFewPointsForIntersection:function(t){var e=this._getProjectedPoints(),i=e?e.length:0;return i+=t||0,!e||i<=3},_lineSegmentsIntersectsRange:function(t,e,i,o){var a,n,s=this._getProjectedPoints();o=o||0;for(var r=i;r>o;r--)if(a=s[r-1],n=s[r],L.LineUtil.segmentsIntersect(t,e,a,n))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var t=[],e=this._defaultShape(),i=0;i<e.length;i++)t.push(this._map.latLngToLayerPoint(e[i]));return t}}),L.Polygon.include({intersects:function(){var t,e,i,o,a=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(t=a.length,e=a[0],i=a[t-1],o=t-2,this._lineSegmentsIntersectsRange(i,e,o,1)))}}),L.Control.Draw=L.Control.extend({options:{position:\"topleft\",draw:{},edit:!1},initialize:function(t){if(L.version<\"0.7\")throw new Error(\"Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/\");L.Control.prototype.initialize.call(this,t);var e;this._toolbars={},L.DrawToolbar&&this.options.draw&&(e=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=e,this._toolbars[L.DrawToolbar.TYPE].on(\"enable\",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(e=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=e,this._toolbars[L.EditToolbar.TYPE].on(\"enable\",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(t){var e,i=L.DomUtil.create(\"div\",\"leaflet-draw\"),o=!1;for(var a in this._toolbars)this._toolbars.hasOwnProperty(a)&&(e=this._toolbars[a].addToolbar(t))&&(o||(L.DomUtil.hasClass(e,\"leaflet-draw-toolbar-top\")||L.DomUtil.addClass(e.childNodes[0],\"leaflet-draw-toolbar-top\"),o=!0),i.appendChild(e));return i},onRemove:function(){for(var t in this._toolbars)this._toolbars.hasOwnProperty(t)&&this._toolbars[t].removeToolbar()},setDrawingOptions:function(t){for(var e in this._toolbars)this._toolbars[e]instanceof L.DrawToolbar&&this._toolbars[e].setOptions(t)},_toolbarEnabled:function(t){var e=t.target;for(var i in this._toolbars)this._toolbars[i]!==e&&this._toolbars[i].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(t){L.setOptions(this,t),this._modes={},this._actionButtons=[],this._activeMode=null;var e=L.version.split(\".\");1===parseInt(e[0],10)&&parseInt(e[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(t){var e,i=L.DomUtil.create(\"div\",\"leaflet-draw-section\"),o=0,a=this._toolbarClass||\"\",n=this.getModeHandlers(t);for(this._toolbarContainer=L.DomUtil.create(\"div\",\"leaflet-draw-toolbar leaflet-bar\"),this._map=t,e=0;e<n.length;e++)n[e].enabled&&this._initModeHandler(n[e].handler,this._toolbarContainer,o++,a,n[e].title);if(o)return this._lastButtonIndex=--o,this._actionsContainer=L.DomUtil.create(\"ul\",\"leaflet-draw-actions\"),i.appendChild(this._toolbarContainer),i.appendChild(this._actionsContainer),i},removeToolbar:function(){for(var t in this._modes)this._modes.hasOwnProperty(t)&&(this._disposeButton(this._modes[t].button,this._modes[t].handler.enable,this._modes[t].handler),this._modes[t].handler.disable(),this._modes[t].handler.off(\"enabled\",this._handlerActivated,this).off(\"disabled\",this._handlerDeactivated,this));this._modes={};for(var e=0,i=this._actionButtons.length;e<i;e++)this._disposeButton(this._actionButtons[e].button,this._actionButtons[e].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(t,e,i,o,a){var n=t.type;this._modes[n]={},this._modes[n].handler=t,this._modes[n].button=this._createButton({type:n,title:a,className:o+\"-\"+n,container:e,callback:this._modes[n].handler.enable,context:this._modes[n].handler}),this._modes[n].buttonIndex=i,this._modes[n].handler.on(\"enabled\",this._handlerActivated,this).on(\"disabled\",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!t.MSStream},_createButton:function(t){var e=L.DomUtil.create(\"a\",t.className||\"\",t.container),i=L.DomUtil.create(\"span\",\"sr-only\",t.container);e.href=\"#\",e.appendChild(i),t.title&&(e.title=t.title,i.innerHTML=t.title),t.text&&(e.innerHTML=t.text,i.innerHTML=t.text);var o=this._detectIOS()?\"touchstart\":\"click\";return L.DomEvent.on(e,\"click\",L.DomEvent.stopPropagation).on(e,\"mousedown\",L.DomEvent.stopPropagation).on(e,\"dblclick\",L.DomEvent.stopPropagation).on(e,\"touchstart\",L.DomEvent.stopPropagation).on(e,\"click\",L.DomEvent.preventDefault).on(e,o,t.callback,t.context),e},_disposeButton:function(t,e){var i=this._detectIOS()?\"touchstart\":\"click\";L.DomEvent.off(t,\"click\",L.DomEvent.stopPropagation).off(t,\"mousedown\",L.DomEvent.stopPropagation).off(t,\"dblclick\",L.DomEvent.stopPropagation).off(t,\"touchstart\",L.DomEvent.stopPropagation).off(t,\"click\",L.DomEvent.preventDefault).off(t,i,e)},_handlerActivated:function(t){this.disable(),this._activeMode=this._modes[t.handler],L.DomUtil.addClass(this._activeMode.button,\"leaflet-draw-toolbar-button-enabled\"),this._showActionsToolbar(),this.fire(\"enable\")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,\"leaflet-draw-toolbar-button-enabled\"),this._activeMode=null,this.fire(\"disable\")},_createActions:function(t){var e,i,o,a,n=this._actionsContainer,s=this.getActions(t),r=s.length;for(i=0,o=this._actionButtons.length;i<o;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback);for(this._actionButtons=[];n.firstChild;)n.removeChild(n.firstChild);for(var l=0;l<r;l++)\"enabled\"in s[l]&&!s[l].enabled||(e=L.DomUtil.create(\"li\",\"\",n),a=this._createButton({title:s[l].title,text:s[l].text,container:e,callback:s[l].callback,context:s[l].context}),this._actionButtons.push({button:a,callback:s[l].callback}))},_showActionsToolbar:function(){var t=this._activeMode.buttonIndex,e=this._lastButtonIndex,i=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=i+\"px\",0===t&&(L.DomUtil.addClass(this._toolbarContainer,\"leaflet-draw-toolbar-notop\"),L.DomUtil.addClass(this._actionsContainer,\"leaflet-draw-actions-top\")),t===e&&(L.DomUtil.addClass(this._toolbarContainer,\"leaflet-draw-toolbar-nobottom\"),L.DomUtil.addClass(this._actionsContainer,\"leaflet-draw-actions-bottom\")),this._actionsContainer.style.display=\"block\",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display=\"none\",L.DomUtil.removeClass(this._toolbarContainer,\"leaflet-draw-toolbar-notop\"),L.DomUtil.removeClass(this._toolbarContainer,\"leaflet-draw-toolbar-nobottom\"),L.DomUtil.removeClass(this._actionsContainer,\"leaflet-draw-actions-top\"),L.DomUtil.removeClass(this._actionsContainer,\"leaflet-draw-actions-bottom\"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(t){this._map=t,this._popupPane=t._panes.popupPane,this._visible=!1,this._container=t.options.drawControlTooltips?L.DomUtil.create(\"div\",\"leaflet-draw-tooltip\",this._popupPane):null,this._singleLineLabel=!1,this._map.on(\"mouseout\",this._onMouseOut,this)},dispose:function(){this._map.off(\"mouseout\",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(t){return this._container?(t.subtext=t.subtext||\"\",0!==t.subtext.length||this._singleLineLabel?t.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,\"leaflet-draw-tooltip-single\"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,\"leaflet-draw-tooltip-single\"),this._singleLineLabel=!0),this._container.innerHTML=(t.subtext.length>0?'<span class=\"leaflet-draw-tooltip-subtext\">'+t.subtext+\"</span><br />\":\"\")+\"<span>\"+t.text+\"</span>\",t.text||t.subtext?(this._visible=!0,this._container.style.visibility=\"inherit\"):(this._visible=!1,this._container.style.visibility=\"hidden\"),this):this},updatePosition:function(t){var e=this._map.latLngToLayerPoint(t),i=this._container;return this._container&&(this._visible&&(i.style.visibility=\"inherit\"),L.DomUtil.setPosition(i,e)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,\"leaflet-error-draw-tooltip\"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,\"leaflet-error-draw-tooltip\"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility=\"hidden\")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:\"draw\"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(t){for(var e in this.options)this.options.hasOwnProperty(e)&&t[e]&&(t[e]=L.extend({},this.options[e],t[e]));this._toolbarClass=\"leaflet-draw-draw\",L.Toolbar.prototype.initialize.call(this,t)},getModeHandlers:function(t){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(t,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(t,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(t,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(t,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(t,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(t,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(t){return[{enabled:t.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:t.completeShape,context:t},{enabled:t.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:t.deleteLastVertex,context:t},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(t){L.setOptions(this,t);for(var e in this._modes)this._modes.hasOwnProperty(e)&&t.hasOwnProperty(e)&&this._modes[e].handler.setOptions(t[e])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:\"edit\"},options:{edit:{selectedPathOptions:{dashArray:\"10, 10\",fill:!0,fillColor:\"#fe57a1\",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(t){t.edit&&(void 0===t.edit.selectedPathOptions&&(t.edit.selectedPathOptions=this.options.edit.selectedPathOptions),t.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,t.edit.selectedPathOptions)),t.remove&&(t.remove=L.extend({},this.options.remove,t.remove)),t.poly&&(t.poly=L.extend({},this.options.poly,t.poly)),this._toolbarClass=\"leaflet-draw-edit\",L.Toolbar.prototype.initialize.call(this,t),this._selectedFeatureCount=0},getModeHandlers:function(t){var e=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(t,{featureGroup:e,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(t,{featureGroup:e}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(t){var e=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return t.removeAllLayers&&e.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),e},addToolbar:function(t){var e=L.Toolbar.prototype.addToolbar.call(this,t);return this._checkDisabled(),this.options.featureGroup.on(\"layeradd layerremove\",this._checkDisabled,this),e},removeToolbar:function(){this.options.featureGroup.off(\"layeradd layerremove\",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var t,e=this.options.featureGroup,i=0!==e.getLayers().length;this.options.edit&&(t=this._modes[L.EditToolbar.Edit.TYPE].button,i?L.DomUtil.removeClass(t,\"leaflet-disabled\"):L.DomUtil.addClass(t,\"leaflet-disabled\"),t.setAttribute(\"title\",i?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(t=this._modes[L.EditToolbar.Delete.TYPE].button,i?L.DomUtil.removeClass(t,\"leaflet-disabled\"):L.DomUtil.addClass(t,\"leaflet-disabled\"),t.setAttribute(\"title\",i?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:\"edit\"},initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.setOptions(this,e),this._featureGroup=e.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error(\"options.featureGroup must be a L.FeatureGroup\");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var i=L.version.split(\".\");1===parseInt(i[0],10)&&parseInt(i[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire(\"enabled\",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on(\"layeradd\",this._enableLayerEdit,this).on(\"layerremove\",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off(\"layeradd\",this._enableLayerEdit,this).off(\"layerremove\",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire(\"disabled\",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),t._editTooltip=this._tooltip,this._updateTooltip(),this._map.on(\"mousemove\",this._onMouseMove,this).on(\"touchmove\",this._onMouseMove,this).on(\"MSPointerMove\",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off(\"mousemove\",this._onMouseMove,this).off(\"touchmove\",this._onMouseMove,this).off(\"MSPointerMove\",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(t){this._revertLayer(t)},this)},save:function(){var t=new L.LayerGroup;this._featureGroup.eachLayer(function(e){e.edited&&(t.addLayer(e),e.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:t})},_backupLayer:function(t){var e=L.Util.stamp(t);this._uneditedLayerProps[e]||(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?this._uneditedLayerProps[e]={latlngs:L.LatLngUtil.cloneLatLngs(t.getLatLngs())}:t instanceof L.Circle?this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng()),radius:t.getRadius()}:(t instanceof L.Marker||t instanceof L.CircleMarker)&&(this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(t){var e=L.Util.stamp(t);t.edited=!1,this._uneditedLayerProps.hasOwnProperty(e)&&(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?t.setLatLngs(this._uneditedLayerProps[e].latlngs):t instanceof L.Circle?(t.setLatLng(this._uneditedLayerProps[e].latlng),t.setRadius(this._uneditedLayerProps[e].radius)):(t instanceof L.Marker||t instanceof L.CircleMarker)&&t.setLatLng(this._uneditedLayerProps[e].latlng),t.fire(\"revert-edited\",{layer:t}))},_enableLayerEdit:function(t){var e,i,o=t.layer||t.target||t;this._backupLayer(o),this.options.poly&&(i=L.Util.extend({},this.options.poly),o.options.poly=i),this.options.selectedPathOptions&&(e=L.Util.extend({},this.options.selectedPathOptions),e.maintainColor&&(e.color=o.options.color,e.fillColor=o.options.fillColor),o.options.original=L.extend({},o.options),o.options.editing=e),o instanceof L.Marker?(o.editing&&o.editing.enable(),o.dragging.enable(),o.on(\"dragend\",this._onMarkerDragEnd).on(\"touchmove\",this._onTouchMove,this).on(\"MSPointerMove\",this._onTouchMove,this).on(\"touchend\",this._onMarkerDragEnd,this).on(\"MSPointerUp\",this._onMarkerDragEnd,this)):o.editing.enable()},_disableLayerEdit:function(t){var e=t.layer||t.target||t;e.edited=!1,e.editing&&e.editing.disable(),delete e.options.editing,delete e.options.original,\nthis._selectedPathOptions&&(e instanceof L.Marker?this._toggleMarkerHighlight(e):(e.setStyle(e.options.previousOptions),delete e.options.previousOptions)),e instanceof L.Marker?(e.dragging.disable(),e.off(\"dragend\",this._onMarkerDragEnd,this).off(\"touchmove\",this._onTouchMove,this).off(\"MSPointerMove\",this._onTouchMove,this).off(\"touchend\",this._onMarkerDragEnd,this).off(\"MSPointerUp\",this._onMarkerDragEnd,this)):e.editing.disable()},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_onMarkerDragEnd:function(t){var e=t.target;e.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:e})},_onTouchMove:function(t){var e=t.originalEvent.changedTouches[0],i=this._map.mouseEventToLayerPoint(e),o=this._map.layerPointToLatLng(i);t.target.setLatLng(o)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:\"remove\"},initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.Util.setOptions(this,e),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error(\"options.featureGroup must be a L.FeatureGroup\");this.type=L.EditToolbar.Delete.TYPE;var i=L.version.split(\".\");1===parseInt(i[0],10)&&parseInt(i[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire(\"enabled\",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on(\"layeradd\",this._enableLayerDelete,this).on(\"layerremove\",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off(\"layeradd\",this._enableLayerDelete,this).off(\"layerremove\",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire(\"disabled\",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on(\"mousemove\",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off(\"mousemove\",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(t){this._deletableLayers.addLayer(t),t.fire(\"revert-deleted\",{layer:t})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(t){this._removeLayer({layer:t})},this),this.save()},_enableLayerDelete:function(t){(t.layer||t.target||t).on(\"click\",this._removeLayer,this)},_disableLayerDelete:function(t){var e=t.layer||t.target||t;e.off(\"click\",this._removeLayer,this),this._deletedLayers.removeLayer(e)},_removeLayer:function(t){var e=t.layer||t.target||t;this._deletableLayers.removeLayer(e),this._deletedLayers.addLayer(e),e.fire(\"deleted\")},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}})}(window,document);"],"sourceRoot":""}